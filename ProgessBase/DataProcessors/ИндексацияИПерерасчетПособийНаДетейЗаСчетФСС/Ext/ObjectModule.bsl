Перем МассивПособий Экспорт;

Процедура ОбработатьПростойДокумент(ВыборкаРегистраторов, Исправление, СтрокиКУдалению, ИмяТЧ = "Начисления")

	СтруктураПоискаВПолучателях = Новый Структура("Регистратор,Физлицо");
	СоответствиеФизлиц = Новый Соответствие;
	
	Исправление.Дата = ОбщегоНазначенияЗК.ПолучитьРабочуюДату();
	ЗаполнениеДокументовПереопределяемый.ЗаполнитьШапкуДокумента(Исправление, глЗначениеПеременной("глТекущийПользователь"));
	ЗаполнитьЗначенияСвойств(Исправление,ВыборкаРегистраторов,"ПерерассчитываемыйДокумент, Организация"); 
	Исправление.ПериодРегистрации = ПериодРегистрации;
	
	ОбработатьФизлицТабличнойЧасти(ВыборкаРегистраторов, Исправление[ИмяТЧ], СтрокиКУдалению, СтруктураПоискаВПолучателях, СоответствиеФизлиц);
	
	ДокументЗаписан = Ложь;
	Попытка
		Исправление.Записать(РежимЗаписиДокумента.Запись);
		ДокументЗаписан = Истина;
	Исключение
	КонецПопытки;
	Если ДокументЗаписан Тогда
		СтрокаТЧ = Исправления.Добавить();
		СтрокаТЧ.ДокументИсправление = Исправление.Ссылка;
		Попытка
			Исправление.Записать(РежимЗаписиДокумента.Проведение);
		Исключение
		КонецПопытки;
		ЗаполнитьЗначенияСвойств(СтрокаТЧ,Исправление);
	КонецЕсли;
	
КонецПроцедуры

Процедура ОбработатьСложныйДокумент(ВыборкаРегистраторов, Исправление, СтрокиКУдалению)
	
	СтруктураПоискаВПолучателях = Новый Структура("Регистратор,Физлицо");
	СоответствиеФизлиц = Новый Соответствие;
	
	Исправление.Дата = ОбщегоНазначенияЗК.ПолучитьРабочуюДату();
	ЗаполнениеДокументовПереопределяемый.ЗаполнитьШапкуДокумента(Исправление, глЗначениеПеременной("глТекущийПользователь"));
	Исправление.ПериодРегистрации = ПериодРегистрации;
	Исправление.ПериодНачисления  = Перечисления.ПериодНачисленияЗарплаты.ПрошлыйПериод;
	ЗаполнитьЗначенияСвойств(Исправление,ВыборкаРегистраторов.ПерерассчитываемыйДокумент,,
					"Проведен, Номер, Дата, ПометкаУдаления, ПериодРегистрации, ПериодНачисления, Комментарий, Ответственный"); // кроме указанных
	Исправление.ПерерассчитываемыйДокумент = ВыборкаРегистраторов.ПерерассчитываемыйДокумент;
	Пока ВыборкаРегистраторов.СледующийПоЗначениюПоля("ИмяТабличнойЧасти") Цикл
		ОбработатьФизлицТабличнойЧасти(ВыборкаРегистраторов, Исправление[ВыборкаРегистраторов.ИмяТабличнойЧасти], СтрокиКУдалению, СтруктураПоискаВПолучателях, СоответствиеФизлиц);
	КонецЦикла;
	
	ДокументЗаписан = Ложь;
	Попытка
		Исправление.Записать(РежимЗаписиДокумента.Запись);
		ДокументЗаписан = Истина;
	Исключение
	КонецПопытки;
	Если ДокументЗаписан Тогда
		ИндексацияИПерерасчетПособийНаДетейПереопределяемый.ДозаполнитьДокумент(Исправление);
		СтрокаТЧ = Исправления.Добавить();
		СтрокаТЧ.ДокументИсправление = Исправление.Ссылка;
		Попытка
			Исправление.Записать(РежимЗаписиДокумента.Проведение);
		Исключение
		КонецПопытки;
		ЗаполнитьЗначенияСвойств(СтрокаТЧ,Исправление);
	КонецЕсли;
	
КонецПроцедуры

Процедура ОбработатьФизлицТабличнойЧасти(ВыборкаРегистраторов, ТабличнаяЧасть, СтрокиКУдалению, СтруктураПоискаВПолучателях, СоответствиеФизлиц)

	Пока ВыборкаРегистраторов.Следующий() Цикл
		ЗаполнитьЗначенияСвойств(ТабличнаяЧасть.Добавить(),ВыборкаРегистраторов);
		Если СоответствиеФизлиц[ВыборкаРегистраторов.Физлицо] = Неопределено Тогда
			СтруктураПоискаВПолучателях.Регистратор = ВыборкаРегистраторов.ПерерассчитываемыйДокумент;
			СтруктураПоискаВПолучателях.Физлицо = ВыборкаРегистраторов.Физлицо;
			ПеренестиИзМассиваВМассив(ПолучателиПособий.НайтиСтроки(СтруктураПоискаВПолучателях), СтрокиКУдалению);
			СоответствиеФизлиц.Вставить(ВыборкаРегистраторов.Физлицо, Истина);
		КонецЕсли;
	КонецЦикла;

КонецПроцедуры

Процедура ПеренестиИзМассиваВМассив(Источник, Приемник)
	
	Для Каждого Значение Из Источник Цикл
		Приемник.Добавить(Значение)
	КонецЦикла;
	
КонецПроцедуры

Процедура УдалитьОбработанныеСтроки(СтрокиКУдалению)

	// удалим обработанные строки
	Для каждого СтрокаТЧ Из СтрокиКУдалению Цикл
		ПолучателиПособий.Удалить(СтрокаТЧ)
	КонецЦикла;

КонецПроцедуры // УдалитьОбработанныеСтроки()

Функция ПолучитьТекстЗапросаПоНачислениеЕдиновременныхПособийЗаСчетФСС()

	ЗапросТекст =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ВЫРАЗИТЬ(ПособияКРегистрации.Регистратор КАК Документ.НачислениеЕдиновременныхПособийЗаСчетФСС) КАК Регистратор,
	|	ПособияКРегистрации.Физлицо КАК Физлицо
	|ПОМЕСТИТЬ ВТЕдиновременныеПособия
	|ИЗ
	|	ВТПособияКРегистрации КАК ПособияКРегистрации
	|ГДЕ
	|	ПособияКРегистрации.Регистратор ССЫЛКА Документ.НачислениеЕдиновременныхПособийЗаСчетФСС
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Регистратор,
	|	Физлицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	НЕОПРЕДЕЛЕНО КАК ДополнительныеПоля,
	|	ПособияЗаСчетФСС.Ссылка КАК Ссылка,
	|	ПособияЗаСчетФСС.Физлицо КАК Физлицо,
	|	ПособияЗаСчетФСС.Результат,
	|	ПособияЗаСчетФСС.НомерСтроки,
	|	ПособияЗаСчетФСС.ВидПособия КАК ВидПособия,
	|	ПособияЗаСчетФСС.ДатаСобытия КАК ДатаСобытия
	|ПОМЕСТИТЬ ВТСтрокиЕдиновременныхПособий
	|ИЗ
	|	ВТЕдиновременныеПособия КАК ПособияКРегистрации
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.НачислениеЕдиновременныхПособийЗаСчетФСС.Начисления КАК ПособияЗаСчетФСС
	|		ПО ПособияКРегистрации.Регистратор = ПособияЗаСчетФСС.Ссылка
	|			И ПособияКРегистрации.Физлицо = ПособияЗаСчетФСС.Физлицо
	|ГДЕ
	|	(НЕ ПособияЗаСчетФСС.Сторно)
	|	И ПособияЗаСчетФСС.Ссылка.Проведен
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка,
	|	Физлицо,
	|	ВидПособия,
	|	ДатаСобытия
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СтрокиДополнительныеНачисления.ДополнительныеПоля,
	|	СтрокиДополнительныеНачисления.Ссылка КАК ПерерассчитываемыйДокумент,
	|	СтрокиДополнительныеНачисления.Физлицо,
	|	СтрокиДополнительныеНачисления.Результат + ЕСТЬNULL(ПособияКРегистрации.СуммаКДоначислению, 0) КАК Результат,
	|	ЛОЖЬ КАК Сторно,
	|	НЕОПРЕДЕЛЕНО КАК СторнируемыйДокумент,
	|	СтрокиДополнительныеНачисления.НомерСтроки КАК НомерСтроки,
	|	СтрокиДополнительныеНачисления.ВидПособия,
	|	СтрокиДополнительныеНачисления.ДатаСобытия,
	|	СтрокиДополнительныеНачисления.Ссылка.Организация КАК Организация
	|ИЗ
	|	ВТСтрокиЕдиновременныхПособий КАК СтрокиДополнительныеНачисления
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТПособияКРегистрации КАК ПособияКРегистрации
	|		ПО СтрокиДополнительныеНачисления.Ссылка = ПособияКРегистрации.Регистратор
	|			И СтрокиДополнительныеНачисления.Физлицо = ПособияКРегистрации.Физлицо
	|			И СтрокиДополнительныеНачисления.ДатаСобытия = ПособияКРегистрации.ДатаНачала
	|			И (СтрокиДополнительныеНачисления.ВидПособия = ВЫБОР
	|				КОГДА ПособияКРегистрации.ВидПособия = ЗНАЧЕНИЕ(Перечисление.ВидыПособийСоциальногоСтрахования.ПриРожденииРебенка)
	|					ТОГДА ЗНАЧЕНИЕ(Перечисление.РазмерыГосударственныхПособий.ПриРожденииРебенка)
	|				КОГДА ПособияКРегистрации.ВидПособия = ЗНАЧЕНИЕ(Перечисление.ВидыПособийСоциальногоСтрахования.ПриПостановкеНаУчетВРанниеСрокиБеременности)
	|					ТОГДА ЗНАЧЕНИЕ(Перечисление.РазмерыГосударственныхПособий.ПриПостановкеНаУчетВРанниеСрокиБеременности)
	|				ИНАЧЕ НЕОПРЕДЕЛЕНО
	|			КОНЕЦ)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтрокиДополнительныеНачисления.ДополнительныеПоля,
	|	СтрокиДополнительныеНачисления.Ссылка,
	|	СтрокиДополнительныеНачисления.Физлицо,
	|	-СтрокиДополнительныеНачисления.Результат,
	|	ИСТИНА,
	|	СтрокиДополнительныеНачисления.Ссылка,
	|	СтрокиДополнительныеНачисления.НомерСтроки,
	|	СтрокиДополнительныеНачисления.ВидПособия,
	|	СтрокиДополнительныеНачисления.ДатаСобытия,
	|	СтрокиДополнительныеНачисления.Ссылка.Организация
	|ИЗ
	|	ВТСтрокиЕдиновременныхПособий КАК СтрокиДополнительныеНачисления
	|
	|УПОРЯДОЧИТЬ ПО
	|	ПерерассчитываемыйДокумент,
	|	Сторно УБЫВ,
	|	НомерСтроки";
	
	Возврат ИндексацияИПерерасчетПособийНаДетейПереопределяемый.ДописатьПоляВТаблицыНачислениеЕдиновременныхПособийЗаСчетФСС(ЗапросТекст)

КонецФункции // ПолучитьТекстЗапросаПоНачислениеЕдиновременныхПособийЗаСчетФСС()

Функция ПолучитьТекстЗапросаПоНачислениеЗарплатыРаботникамОрганизаций()

	ЗапросТекст =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ВЫРАЗИТЬ(ПособияКРегистрации.Регистратор КАК Документ.НачислениеЗарплатыРаботникамОрганизаций) КАК Регистратор,
	|	ПособияКРегистрации.Физлицо
	|ПОМЕСТИТЬ ВТНачисленияЗарплаты
	|ИЗ
	|	ВТПособияКРегистрации КАК ПособияКРегистрации
	|ГДЕ
	|	ПособияКРегистрации.Регистратор ССЫЛКА Документ.НачислениеЗарплатыРаботникамОрганизаций
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Регистратор
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ОсновныеНачисления.Ссылка КАК Регистратор,
	|	ОсновныеНачисления.Сотрудник КАК Сотрудник,
	|	ОсновныеНачисления.ВидРасчета КАК ВидРасчета,
	|	МИНИМУМ(ОсновныеНачисления.ДатаНачала) КАК ДатаНачала,
	|	ОсновныеНачисления.Ссылка.ПериодРегистрации КАК ПериодРегистрации,
	|	МАКСИМУМ(ОсновныеНачисления.ДатаОкончания) КАК ДатаОкончания
	|ПОМЕСТИТЬ ВТСотрудникиНачисленияЗарплаты
	|ИЗ
	|	ВТНачисленияЗарплаты КАК ПособияКРегистрации
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК ОсновныеНачисления
	|		ПО ПособияКРегистрации.Регистратор = ОсновныеНачисления.Ссылка
	|			И ПособияКРегистрации.Физлицо = ОсновныеНачисления.Физлицо
	|ГДЕ
	|	(НЕ ОсновныеНачисления.Сторно)
	|	И ОсновныеНачисления.Ссылка.Проведен
	|
	|СГРУППИРОВАТЬ ПО
	|	ОсновныеНачисления.Ссылка,
	|	ОсновныеНачисления.Сотрудник,
	|	ОсновныеНачисления.Ссылка.ПериодРегистрации,
	|	ОсновныеНачисления.ВидРасчета
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Сотрудник,
	|	ВидРасчета
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Сотрудники.Регистратор КАК Регистратор,
	|	Сотрудники.Сотрудник КАК Сотрудник,
	|	Сотрудники.ВидРасчета КАК ВидРасчета,
	|	СторноНачисления.ПериодДействияНачало,
	|	СторноНачисления.ПериодДействияКонец,
	|	СторноНачисления.Результат,
	|	СторноНачисления.ОтработаноДней,
	|	СторноНачисления.ОтработаноЧасов,
	|	СторноНачисления.ОтработаноДнейПоПятидневке,
	|	СторноНачисления.НормаДней,
	|	СторноНачисления.НормаЧасов,
	|	СторноНачисления.НормаДнейПоПятидневке,
	|	СторноНачисления.ОплаченоДнейЧасов,
	|	СторноНачисления.ОтработаноЧасовПоПятидневке,
	|	СторноНачисления.НормаЧасовПоПятидневке
	|ПОМЕСТИТЬ ВТСторноНачисленияЗарплаты
	|ИЗ
	|	ВТСотрудникиНачисленияЗарплаты КАК Сотрудники
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК СторноНачисления
	|		ПО Сотрудники.Сотрудник = СторноНачисления.Сотрудник
	|			И Сотрудники.ВидРасчета = СторноНачисления.ВидРасчета
	|			И (СторноНачисления.ПериодДействия МЕЖДУ Сотрудники.ДатаНачала И Сотрудники.ДатаОкончания)
	|			И (СторноНачисления.ПериодРегистрации > Сотрудники.ПериодРегистрации)
	|			И (СторноНачисления.ПериодРегистрации <= &ПериодРегистрации)
	|			И (СторноНачисления.СторнируемыйДокумент = Сотрудники.Регистратор)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Регистратор,
	|	Сотрудник,
	|	ВидРасчета
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ПособияКРегистрации.Регистратор КАК Ссылка,
	|	ПособияКРегистрации.Сотрудник,
	|	ПособияКРегистрации.ВидРасчета,
	|	ОсновныеНачисления.Физлицо,
	|	ОсновныеНачисления.ДатаНачала,
	|	ОсновныеНачисления.ДатаОкончания,
	|	ОсновныеНачисления.Показатель1,
	|	ОсновныеНачисления.Показатель2,
	|	ОсновныеНачисления.Показатель3,
	|	ОсновныеНачисления.Показатель4,
	|	ОсновныеНачисления.Показатель5,
	|	ОсновныеНачисления.Показатель6,
	|	ОсновныеНачисления.ПодразделениеОрганизации,
	|	ОсновныеНачисления.Результат + ЕСТЬNULL(СУММА(СторноНачисления.Результат), 0) КАК Результат,
	|	ОсновныеНачисления.ОтработаноДней + ЕСТЬNULL(СУММА(СторноНачисления.ОтработаноДней), 0) КАК ОтработаноДней,
	|	ОсновныеНачисления.ОтработаноЧасов + ЕСТЬNULL(СУММА(СторноНачисления.ОтработаноЧасов), 0) КАК ОтработаноЧасов,
	|	ОсновныеНачисления.ОтработаноДнейПоПятидневке + ЕСТЬNULL(СУММА(СторноНачисления.ОтработаноДнейПоПятидневке), 0) КАК ОтработаноДнейПоПятидневке,
	|	ОсновныеНачисления.НормаДней + ЕСТЬNULL(СУММА(СторноНачисления.НормаДней), 0) КАК НормаДней,
	|	ОсновныеНачисления.НормаЧасов + ЕСТЬNULL(СУММА(СторноНачисления.НормаЧасов), 0) КАК НормаЧасов,
	|	ОсновныеНачисления.НормаДнейПоПятидневке + ЕСТЬNULL(СУММА(СторноНачисления.НормаДнейПоПятидневке), 0) КАК НормаДнейПоПятидневке,
	|	ОсновныеНачисления.ОплаченоДнейЧасов + ЕСТЬNULL(СУММА(СторноНачисления.ОплаченоДнейЧасов), 0) КАК ОплаченоДнейЧасов,
	|	ОсновныеНачисления.ОтработаноЧасовПоПятидневке + ЕСТЬNULL(СУММА(СторноНачисления.ОтработаноЧасовПоПятидневке), 0) КАК ОтработаноЧасовПоПятидневке,
	|	ОсновныеНачисления.НормаЧасовПоПятидневке + ЕСТЬNULL(СУММА(СторноНачисления.НормаЧасовПоПятидневке), 0) КАК НормаЧасовПоПятидневке,
	|	ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаНачало,
	|	ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	ОсновныеНачисления.ДатаНачалаСобытия,
	|	ОсновныеНачисления.ОплачиватьЧасов,
	|	ОсновныеНачисления.НомерСтроки
	|ПОМЕСТИТЬ ВТСтрокиНачисления
	|ИЗ
	|	ВТСотрудникиНачисленияЗарплаты КАК ПособияКРегистрации
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК ОсновныеНачисления
	|			ЛЕВОЕ СОЕДИНЕНИЕ ВТСторноНачисленияЗарплаты КАК СторноНачисления
	|			ПО ОсновныеНачисления.Сотрудник = СторноНачисления.Сотрудник
	|				И ОсновныеНачисления.ВидРасчета = СторноНачисления.ВидРасчета
	|				И ОсновныеНачисления.Ссылка = СторноНачисления.Регистратор
	|				И (СторноНачисления.ПериодДействияНачало МЕЖДУ ОсновныеНачисления.ДатаНачала И ОсновныеНачисления.ДатаОкончания)
	|				И (СторноНачисления.ПериодДействияКонец МЕЖДУ ОсновныеНачисления.ДатаНачала И ОсновныеНачисления.ДатаОкончания)
	|		ПО ПособияКРегистрации.Регистратор = ОсновныеНачисления.Ссылка
	|			И ПособияКРегистрации.Сотрудник = ОсновныеНачисления.Сотрудник
	|			И ПособияКРегистрации.ВидРасчета = ОсновныеНачисления.ВидРасчета
	|ГДЕ
	|	(НЕ ОсновныеНачисления.Сторно)
	|
	|СГРУППИРОВАТЬ ПО
	|	ПособияКРегистрации.Регистратор,
	|	ПособияКРегистрации.Сотрудник,
	|	ОсновныеНачисления.Физлицо,
	|	ПособияКРегистрации.ВидРасчета,
	|	ОсновныеНачисления.ДатаНачала,
	|	ОсновныеНачисления.ДатаОкончания,
	|	ОсновныеНачисления.Показатель1,
	|	ОсновныеНачисления.Показатель2,
	|	ОсновныеНачисления.Показатель3,
	|	ОсновныеНачисления.Показатель4,
	|	ОсновныеНачисления.Показатель5,
	|	ОсновныеНачисления.Показатель6,
	|	ОсновныеНачисления.ПодразделениеОрганизации,
	|	ОсновныеНачисления.Результат,
	|	ОсновныеНачисления.ОтработаноДней,
	|	ОсновныеНачисления.ОтработаноЧасов,
	|	ОсновныеНачисления.ОтработаноДнейПоПятидневке,
	|	ОсновныеНачисления.НормаДней,
	|	ОсновныеНачисления.НормаЧасов,
	|	ОсновныеНачисления.НормаДнейПоПятидневке,
	|	ОсновныеНачисления.ОплаченоДнейЧасов,
	|	ОсновныеНачисления.ОтработаноЧасовПоПятидневке,
	|	ОсновныеНачисления.НормаЧасовПоПятидневке,
	|	ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаНачало,
	|	ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	ОсновныеНачисления.ДатаНачалаСобытия,
	|	ОсновныеНачисления.ОплачиватьЧасов,
	|	ОсновныеНачисления.НомерСтроки
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ДополнительныеНачисления.Ссылка,
	|	ДополнительныеНачисления.Сотрудник,
	|	ДополнительныеНачисления.Физлицо,
	|	ДополнительныеНачисления.ВидРасчета,
	|	ДополнительныеНачисления.ДатаНачала,
	|	ДополнительныеНачисления.ДатаОкончания,
	|	ДополнительныеНачисления.Показатель1,
	|	ДополнительныеНачисления.Показатель2,
	|	ДополнительныеНачисления.Показатель3,
	|	ДополнительныеНачисления.Показатель4,
	|	ДополнительныеНачисления.Показатель5,
	|	ДополнительныеНачисления.Показатель6,
	|	ДополнительныеНачисления.ПодразделениеОрганизации,
	|	ДополнительныеНачисления.ПериодРасчетаСреднегоЗаработкаНачало,
	|	ДополнительныеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	ДополнительныеНачисления.ДатаНачалаСобытия,
	|	ДополнительныеНачисления.Результат,
	|	ДополнительныеНачисления.КодВычета,
	|	ДополнительныеНачисления.СуммаВычета,
	|	ДополнительныеНачисления.ОплаченоДнейЧасов,
	|	ДополнительныеНачисления.НомерСтроки
	|ПОМЕСТИТЬ ВТСтрокиДополнительныеНачисления
	|ИЗ
	|	ВТНачисленияЗарплаты КАК ПособияКРегистрации
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.НачислениеЗарплатыРаботникамОрганизаций.ДополнительныеНачисления КАК ДополнительныеНачисления
	|		ПО ПособияКРегистрации.Регистратор = ДополнительныеНачисления.Ссылка
	|			И ПособияКРегистрации.Физлицо = ДополнительныеНачисления.Физлицо
	|ГДЕ
	|	(НЕ ДополнительныеНачисления.Сторно)
	|	И ДополнительныеНачисления.Ссылка.Проведен
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Удержания.Ссылка КАК Ссылка,
	|	Удержания.ФизЛицо,
	|	Удержания.ВидРасчета,
	|	Удержания.ДатаНачала,
	|	Удержания.ДатаОкончания,
	|	Удержания.Результат,
	|	Удержания.НомерСтроки,
	|	Удержания.ДокументОснование,
	|	Удержания.Показатель1,
	|	Удержания.Показатель2,
	|	Удержания.Показатель3,
	|	Удержания.Показатель4,
	|	Удержания.Показатель5,
	|	Удержания.Показатель6,
	|	Удержания.ПериодРасчетаСреднегоЗаработкаНачало,
	|	Удержания.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	Удержания.ДатаНачалаСобытия
	|ПОМЕСТИТЬ ВТСтрокиУдержаний
	|ИЗ
	|	ВТНачисленияЗарплаты КАК ПособияКРегистрации
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.НачислениеЗарплатыРаботникамОрганизаций.Удержания КАК Удержания
	|		ПО ПособияКРегистрации.Регистратор = Удержания.Ссылка
	|			И ПособияКРегистрации.Физлицо = Удержания.ФизЛицо
	|ГДЕ
	|	(НЕ Удержания.Сторно)
	|	И Удержания.Ссылка.Проведен
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка
	|;
	|" +
	ИндексацияИПерерасчетПособийНаДетейПереопределяемый.ДописатьТаблицыНачисленияЗарплатыВоВременныеТаблицы() + "
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СтрокиНачисления.Ссылка КАК ПерерассчитываемыйДокумент,
	|	""Начисления"" КАК ИмяТабличнойЧасти,
	|	СтрокиНачисления.Сотрудник,
	|	СтрокиНачисления.Физлицо,
	|	СтрокиНачисления.ВидРасчета,
	|	СтрокиНачисления.ДатаНачала,
	|	СтрокиНачисления.ДатаОкончания,
	|	СтрокиНачисления.Показатель1,
	|	СтрокиНачисления.Показатель2,
	|	СтрокиНачисления.Показатель3,
	|	СтрокиНачисления.Показатель4,
	|	СтрокиНачисления.Показатель5,
	|	СтрокиНачисления.Показатель6,
	|	СтрокиНачисления.ПодразделениеОрганизации,
	|	СтрокиНачисления.Результат + ЕСТЬNULL(ПособияКРегистрации.СуммаКДоначислению, 0) КАК Результат,
	|	СтрокиНачисления.ОтработаноДней,
	|	СтрокиНачисления.ОтработаноЧасов,
	|	СтрокиНачисления.ОтработаноДнейПоПятидневке,
	|	СтрокиНачисления.НормаДней,
	|	СтрокиНачисления.НормаЧасов,
	|	СтрокиНачисления.НормаДнейПоПятидневке,
	|	СтрокиНачисления.ОплаченоДнейЧасов,
	|	СтрокиНачисления.ОтработаноЧасовПоПятидневке,
	|	СтрокиНачисления.НормаЧасовПоПятидневке,
	|	СтрокиНачисления.ПериодРасчетаСреднегоЗаработкаНачало,
	|	СтрокиНачисления.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	СтрокиНачисления.ДатаНачалаСобытия,
	|	СтрокиНачисления.ОплачиватьЧасов,
	|	ЛОЖЬ КАК Сторно,
	|	НЕОПРЕДЕЛЕНО КАК СторнируемыйДокумент,
	|	СтрокиНачисления.НомерСтроки КАК НомерСтроки,
	|	НЕОПРЕДЕЛЕНО КАК КодВычета,
	|	0 КАК СуммаВычета,
	|	0 КАК Размер,
	|	НЕОПРЕДЕЛЕНО КАК ДокументОснование,
	|	НЕОПРЕДЕЛЕНО КАК ДополнительныеПоля,
	|	ИСТИНА КАК Авторасчет
	|ИЗ
	|	ВТСтрокиНачисления КАК СтрокиНачисления
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТПособияКРегистрации КАК ПособияКРегистрации
	|		ПО СтрокиНачисления.Ссылка = ПособияКРегистрации.Регистратор
	|			И СтрокиНачисления.Сотрудник = ПособияКРегистрации.Сотрудник
	|			И СтрокиНачисления.ДатаНачала = ПособияКРегистрации.ДатаНачала
	|			И СтрокиНачисления.ВидРасчета = ПособияКРегистрации.ВидРасчета
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтрокиНачисления.Ссылка,
	|	""Начисления"",
	|	СтрокиНачисления.Сотрудник,
	|	СтрокиНачисления.Физлицо,
	|	СтрокиНачисления.ВидРасчета,
	|	СтрокиНачисления.ДатаНачала,
	|	СтрокиНачисления.ДатаОкончания,
	|	СтрокиНачисления.Показатель1,
	|	СтрокиНачисления.Показатель2,
	|	СтрокиНачисления.Показатель3,
	|	СтрокиНачисления.Показатель4,
	|	СтрокиНачисления.Показатель5,
	|	СтрокиНачисления.Показатель6,
	|	СтрокиНачисления.ПодразделениеОрганизации,
	|	-СтрокиНачисления.Результат,
	|	-СтрокиНачисления.ОтработаноДней,
	|	-СтрокиНачисления.ОтработаноЧасов,
	|	-СтрокиНачисления.ОтработаноДнейПоПятидневке,
	|	-СтрокиНачисления.НормаДней,
	|	-СтрокиНачисления.НормаЧасов,
	|	-СтрокиНачисления.НормаДнейПоПятидневке,
	|	-СтрокиНачисления.ОплаченоДнейЧасов,
	|	-СтрокиНачисления.ОтработаноЧасовПоПятидневке,
	|	-СтрокиНачисления.НормаЧасовПоПятидневке,
	|	СтрокиНачисления.ПериодРасчетаСреднегоЗаработкаНачало,
	|	СтрокиНачисления.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	СтрокиНачисления.ДатаНачалаСобытия,
	|	СтрокиНачисления.ОплачиватьЧасов,
	|	ИСТИНА,
	|	СтрокиНачисления.Ссылка,
	|	СтрокиНачисления.НомерСтроки,
	|	НЕОПРЕДЕЛЕНО,
	|	0,
	|	0,
	|	НЕОПРЕДЕЛЕНО,
	|	НЕОПРЕДЕЛЕНО КАК ДополнительныеПоля,
	|	ЛОЖЬ
	|ИЗ
	|	ВТСтрокиНачисления КАК СтрокиНачисления
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтрокиДополнительныеНачисления.Ссылка,
	|	""ДополнительныеНачисления"",
	|	СтрокиДополнительныеНачисления.Сотрудник,
	|	СтрокиДополнительныеНачисления.Физлицо,
	|	СтрокиДополнительныеНачисления.ВидРасчета,
	|	СтрокиДополнительныеНачисления.ДатаНачала,
	|	СтрокиДополнительныеНачисления.ДатаОкончания,
	|	СтрокиДополнительныеНачисления.Показатель1,
	|	СтрокиДополнительныеНачисления.Показатель2,
	|	СтрокиДополнительныеНачисления.Показатель3,
	|	СтрокиДополнительныеНачисления.Показатель4,
	|	СтрокиДополнительныеНачисления.Показатель5,
	|	СтрокиДополнительныеНачисления.Показатель6,
	|	СтрокиДополнительныеНачисления.ПодразделениеОрганизации,
	|	СтрокиДополнительныеНачисления.Результат + ЕСТЬNULL(ПособияКРегистрации.СуммаКДоначислению, 0),
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	СтрокиДополнительныеНачисления.ОплаченоДнейЧасов,
	|	0,
	|	0,
	|	СтрокиДополнительныеНачисления.ПериодРасчетаСреднегоЗаработкаНачало,
	|	СтрокиДополнительныеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	СтрокиДополнительныеНачисления.ДатаНачалаСобытия,
	|	0,
	|	ЛОЖЬ,
	|	НЕОПРЕДЕЛЕНО,
	|	СтрокиДополнительныеНачисления.НомерСтроки,
	|	СтрокиДополнительныеНачисления.КодВычета,
	|	СтрокиДополнительныеНачисления.СуммаВычета,
	|	0,
	|	НЕОПРЕДЕЛЕНО,
	|	НЕОПРЕДЕЛЕНО КАК ДополнительныеПоля,
	|	ИСТИНА
	|ИЗ
	|	ВТСтрокиДополнительныеНачисления КАК СтрокиДополнительныеНачисления
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТПособияКРегистрации КАК ПособияКРегистрации
	|		ПО СтрокиДополнительныеНачисления.Ссылка = ПособияКРегистрации.Регистратор
	|			И СтрокиДополнительныеНачисления.Сотрудник = ПособияКРегистрации.Сотрудник
	|			И СтрокиДополнительныеНачисления.ДатаНачала = ПособияКРегистрации.ДатаНачала
	|			И СтрокиДополнительныеНачисления.ВидРасчета = ПособияКРегистрации.ВидРасчета
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтрокиДополнительныеНачисления.Ссылка,
	|	""ДополнительныеНачисления"",
	|	СтрокиДополнительныеНачисления.Сотрудник,
	|	СтрокиДополнительныеНачисления.Физлицо,
	|	СтрокиДополнительныеНачисления.ВидРасчета,
	|	СтрокиДополнительныеНачисления.ДатаНачала,
	|	СтрокиДополнительныеНачисления.ДатаОкончания,
	|	СтрокиДополнительныеНачисления.Показатель1,
	|	СтрокиДополнительныеНачисления.Показатель2,
	|	СтрокиДополнительныеНачисления.Показатель3,
	|	СтрокиДополнительныеНачисления.Показатель4,
	|	СтрокиДополнительныеНачисления.Показатель5,
	|	СтрокиДополнительныеНачисления.Показатель6,
	|	СтрокиДополнительныеНачисления.ПодразделениеОрганизации,
	|	-СтрокиДополнительныеНачисления.Результат,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	-СтрокиДополнительныеНачисления.ОплаченоДнейЧасов,
	|	0,
	|	0,
	|	СтрокиДополнительныеНачисления.ПериодРасчетаСреднегоЗаработкаНачало,
	|	СтрокиДополнительныеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	СтрокиДополнительныеНачисления.ДатаНачалаСобытия,
	|	0,
	|	ИСТИНА,
	|	СтрокиДополнительныеНачисления.Ссылка,
	|	СтрокиДополнительныеНачисления.НомерСтроки,
	|	СтрокиДополнительныеНачисления.КодВычета,
	|	-СтрокиДополнительныеНачисления.СуммаВычета,
	|	0,
	|	НЕОПРЕДЕЛЕНО,
	|	НЕОПРЕДЕЛЕНО КАК ДополнительныеПоля,
	|	ЛОЖЬ
	|ИЗ
	|	ВТСтрокиДополнительныеНачисления КАК СтрокиДополнительныеНачисления
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтрокиУдержаний.Ссылка,
	|	""Удержания"",
	|	НЕОПРЕДЕЛЕНО,
	|	СтрокиУдержаний.ФизЛицо,
	|	СтрокиУдержаний.ВидРасчета,
	|	СтрокиУдержаний.ДатаНачала,
	|	СтрокиУдержаний.ДатаОкончания,
	|	СтрокиУдержаний.Показатель1,
	|	СтрокиУдержаний.Показатель2,
	|	СтрокиУдержаний.Показатель3,
	|	СтрокиУдержаний.Показатель4,
	|	СтрокиУдержаний.Показатель5,
	|	СтрокиУдержаний.Показатель6,
	|	НЕОПРЕДЕЛЕНО,
	|	СтрокиУдержаний.Результат,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	СтрокиУдержаний.ПериодРасчетаСреднегоЗаработкаНачало,
	|	СтрокиУдержаний.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	СтрокиУдержаний.ДатаНачалаСобытия,
	|	0,
	|	ЛОЖЬ,
	|	НЕОПРЕДЕЛЕНО,
	|	СтрокиУдержаний.НомерСтроки,
	|	НЕОПРЕДЕЛЕНО,
	|	0,
	|	0,
	|	СтрокиУдержаний.ДокументОснование,
	|	НЕОПРЕДЕЛЕНО КАК ДополнительныеПоля,
	|	ИСТИНА
	|ИЗ
	|	ВТСтрокиУдержаний КАК СтрокиУдержаний
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтрокиУдержаний.Ссылка,
	|	""Удержания"",
	|	НЕОПРЕДЕЛЕНО,
	|	СтрокиУдержаний.ФизЛицо,
	|	СтрокиУдержаний.ВидРасчета,
	|	СтрокиУдержаний.ДатаНачала,
	|	СтрокиУдержаний.ДатаОкончания,
	|	СтрокиУдержаний.Показатель1,
	|	СтрокиУдержаний.Показатель2,
	|	СтрокиУдержаний.Показатель3,
	|	СтрокиУдержаний.Показатель4,
	|	СтрокиУдержаний.Показатель5,
	|	СтрокиУдержаний.Показатель6,
	|	НЕОПРЕДЕЛЕНО,
	|	-СтрокиУдержаний.Результат,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	СтрокиУдержаний.ПериодРасчетаСреднегоЗаработкаНачало,
	|	СтрокиУдержаний.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	СтрокиУдержаний.ДатаНачалаСобытия,
	|	0,
	|	ИСТИНА,
	|	СтрокиУдержаний.Ссылка,
	|	СтрокиУдержаний.НомерСтроки,
	|	НЕОПРЕДЕЛЕНО,
	|	0,
	|	0,
	|	СтрокиУдержаний.ДокументОснование,
	|	НЕОПРЕДЕЛЕНО КАК ДополнительныеПоля,
	|	ЛОЖЬ
	|ИЗ
	|	ВТСтрокиУдержаний КАК СтрокиУдержаний
	|
	|" +
	ИндексацияИПерерасчетПособийНаДетейПереопределяемый.ДописатьТаблицыНачисленияЗарплатыВОсновнойЗапрос() + "
	|УПОРЯДОЧИТЬ ПО
	|	ПерерассчитываемыйДокумент,
	|	ИмяТабличнойЧасти,
	|	Сторно УБЫВ,
	|	НомерСтроки";
	
	Возврат ИндексацияИПерерасчетПособийНаДетейПереопределяемый.ДописатьПоляВТаблицыНачисленияЗарплаты(ЗапросТекст)

КонецФункции // ПолучитьТекстЗапросаПоНачислениеЗарплатыРаботникамОрганизаций()

Функция ПолучитьТекстЗапросаПоПереносДанных()

	ЗапросТекст =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ВЫРАЗИТЬ(ПособияКРегистрации.Регистратор КАК Документ.ПереносДанных) КАК Регистратор,
	|	ПособияКРегистрации.Физлицо
	|ПОМЕСТИТЬ ВТРегистрацияПереносаДанных
	|ИЗ
	|	ВТПособияКРегистрации КАК ПособияКРегистрации
	|ГДЕ
	|	ПособияКРегистрации.Регистратор ССЫЛКА Документ.ПереносДанных
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Регистратор
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ПособияКРегистрации.Регистратор КАК Регистратор,
	|	ОсновныеНачисления.Организация,
	|	ПособияКРегистрации.Физлицо,
	|	ОсновныеНачисления.ПериодРегистрации КАК ПериодРегистрации,
	|	ОсновныеНачисления.ВидРасчета КАК ВидРасчета,
	|	ОсновныеНачисления.Сотрудник КАК Сотрудник,
	|	МИНИМУМ(ОсновныеНачисления.ПериодДействияНачало) КАК ДатаНачала,
	|	МАКСИМУМ(ОсновныеНачисления.ПериодДействияКонец) КАК ДатаОкончания
	|ПОМЕСТИТЬ ВТСотрудникиПереносаДанных
	|ИЗ
	|	ВТРегистрацияПереносаДанных КАК ПособияКРегистрации
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
	|		ПО ПособияКРегистрации.Регистратор = ОсновныеНачисления.Регистратор
	|			И ПособияКРегистрации.Физлицо = ОсновныеНачисления.ФизЛицо
	|ГДЕ
	|	(НЕ ОсновныеНачисления.Сторно)
	|
	|СГРУППИРОВАТЬ ПО
	|	ОсновныеНачисления.Сотрудник,
	|	ОсновныеНачисления.ВидРасчета,
	|	ПособияКРегистрации.Регистратор,
	|	ОсновныеНачисления.ПериодРегистрации,
	|	ПособияКРегистрации.Физлицо,
	|	ОсновныеНачисления.Организация
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Сотрудник,
	|	ВидРасчета
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Сотрудники.Регистратор КАК Регистратор,
	|	Сотрудники.Организация,
	|	Сотрудники.Сотрудник КАК Сотрудник,
	|	Сотрудники.ВидРасчета КАК ВидРасчета,
	|	СторноНачисления.ПериодДействияНачало,
	|	СторноНачисления.ПериодДействияКонец,
	|	СторноНачисления.Результат,
	|	СторноНачисления.ОтработаноДней,
	|	СторноНачисления.ОтработаноЧасов,
	|	СторноНачисления.ОтработаноДнейПоПятидневке,
	|	СторноНачисления.НормаДней,
	|	СторноНачисления.НормаЧасов,
	|	СторноНачисления.НормаДнейПоПятидневке,
	|	СторноНачисления.ОплаченоДнейЧасов,
	|	СторноНачисления.ОтработаноЧасовПоПятидневке,
	|	СторноНачисления.НормаЧасовПоПятидневке
	|ПОМЕСТИТЬ ВТСторноПереносаДанных
	|ИЗ
	|	ВТСотрудникиПереносаДанных КАК Сотрудники
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК СторноНачисления
	|		ПО Сотрудники.Сотрудник = СторноНачисления.Сотрудник
	|			И Сотрудники.ВидРасчета = СторноНачисления.ВидРасчета
	|			И (СторноНачисления.ПериодДействия МЕЖДУ Сотрудники.ДатаНачала И Сотрудники.ДатаОкончания)
	|			И (СторноНачисления.ПериодРегистрации > Сотрудники.ПериодРегистрации)
	|			И (СторноНачисления.ПериодРегистрации <= &ПериодРегистрации)
	|			И (СторноНачисления.СторнируемыйДокумент = Сотрудники.Регистратор)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Регистратор,
	|	Сотрудник,
	|	ВидРасчета
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ПособияКРегистрации.Регистратор КАК Регистратор,
	|	ПособияКРегистрации.Организация,
	|	ПособияКРегистрации.Сотрудник КАК Сотрудник,
	|	ПособияКРегистрации.ВидРасчета КАК ВидРасчета,
	|	ОсновныеНачисления.ФизЛицо,
	|	ОсновныеНачисления.ПериодДействияНачало КАК ПериодДействияНачало,
	|	ОсновныеНачисления.ПериодДействияКонец,
	|	ОсновныеНачисления.БазовыйПериодНачало,
	|	ОсновныеНачисления.БазовыйПериодКонец,
	|	ОсновныеНачисления.Показатель1,
	|	ОсновныеНачисления.Показатель2,
	|	ОсновныеНачисления.Показатель3,
	|	ОсновныеНачисления.Показатель4,
	|	ОсновныеНачисления.Показатель5,
	|	ОсновныеНачисления.Показатель6,
	|	ОсновныеНачисления.ПодразделениеОрганизации,
	|	ОсновныеНачисления.ОбособленноеПодразделение,
	|	ОсновныеНачисления.Результат + ЕСТЬNULL(СУММА(СторноНачисления.Результат), 0) КАК Результат,
	|	ОсновныеНачисления.ОтработаноДней + ЕСТЬNULL(СУММА(СторноНачисления.ОтработаноДней), 0) КАК ОтработаноДней,
	|	ОсновныеНачисления.ОтработаноЧасов + ЕСТЬNULL(СУММА(СторноНачисления.ОтработаноЧасов), 0) КАК ОтработаноЧасов,
	|	ОсновныеНачисления.ОтработаноДнейПоПятидневке + ЕСТЬNULL(СУММА(СторноНачисления.ОтработаноДнейПоПятидневке), 0) КАК ОтработаноДнейПоПятидневке,
	|	ОсновныеНачисления.НормаДней + ЕСТЬNULL(СУММА(СторноНачисления.НормаДней), 0) КАК НормаДней,
	|	ОсновныеНачисления.НормаЧасов + ЕСТЬNULL(СУММА(СторноНачисления.НормаЧасов), 0) КАК НормаЧасов,
	|	ОсновныеНачисления.НормаДнейПоПятидневке + ЕСТЬNULL(СУММА(СторноНачисления.НормаДнейПоПятидневке), 0) КАК НормаДнейПоПятидневке,
	|	ОсновныеНачисления.ОплаченоДнейЧасов + ЕСТЬNULL(СУММА(СторноНачисления.ОплаченоДнейЧасов), 0) КАК ОплаченоДнейЧасов,
	|	ОсновныеНачисления.ОтработаноЧасовПоПятидневке + ЕСТЬNULL(СУММА(СторноНачисления.ОтработаноЧасовПоПятидневке), 0) КАК ОтработаноЧасовПоПятидневке,
	|	ОсновныеНачисления.НормаЧасовПоПятидневке + ЕСТЬNULL(СУММА(СторноНачисления.НормаЧасовПоПятидневке), 0) КАК НормаЧасовПоПятидневке,
	|	ОсновныеНачисления.ДатаНачалаСобытия,
	|	ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаНачало,
	|	ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	ОсновныеНачисления.НомерСтроки,
	|	ОсновныеНачисления.ПериодРегистрации
	|ПОМЕСТИТЬ ВТСтрокиПереносаДанных
	|ИЗ
	|	ВТСотрудникиПереносаДанных КАК ПособияКРегистрации
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисления
	|			ЛЕВОЕ СОЕДИНЕНИЕ ВТСторноПереносаДанных КАК СторноНачисления
	|			ПО ОсновныеНачисления.Сотрудник = СторноНачисления.Сотрудник
	|				И ОсновныеНачисления.ВидРасчета = СторноНачисления.ВидРасчета
	|				И ОсновныеНачисления.Регистратор = СторноНачисления.Регистратор
	|				И (СторноНачисления.ПериодДействияНачало МЕЖДУ ОсновныеНачисления.ПериодДействияНачало И ОсновныеНачисления.ПериодДействияКонец)
	|				И (СторноНачисления.ПериодДействияКонец МЕЖДУ ОсновныеНачисления.ПериодДействияНачало И ОсновныеНачисления.ПериодДействияКонец)
	|		ПО ПособияКРегистрации.Регистратор = ОсновныеНачисления.Регистратор
	|			И ПособияКРегистрации.Сотрудник = ОсновныеНачисления.Сотрудник
	|			И ПособияКРегистрации.ВидРасчета = ОсновныеНачисления.ВидРасчета
	|			И ПособияКРегистрации.ДатаНачала = ОсновныеНачисления.ПериодДействияНачало
	|			И ПособияКРегистрации.ДатаОкончания = ОсновныеНачисления.ПериодДействияКонец
	|ГДЕ
	|	(НЕ ОсновныеНачисления.Сторно)
	|
	|СГРУППИРОВАТЬ ПО
	|	ПособияКРегистрации.Регистратор,
	|	ПособияКРегистрации.Сотрудник,
	|	ОсновныеНачисления.ФизЛицо,
	|	ПособияКРегистрации.ВидРасчета,
	|	ОсновныеНачисления.ПериодДействияНачало,
	|	ОсновныеНачисления.ПериодДействияКонец,
	|	ОсновныеНачисления.Показатель1,
	|	ОсновныеНачисления.Показатель2,
	|	ОсновныеНачисления.Показатель3,
	|	ОсновныеНачисления.Показатель4,
	|	ОсновныеНачисления.Показатель5,
	|	ОсновныеНачисления.Показатель6,
	|	ОсновныеНачисления.ПодразделениеОрганизации,
	|	ОсновныеНачисления.Результат,
	|	ОсновныеНачисления.ОтработаноДней,
	|	ОсновныеНачисления.ОтработаноЧасов,
	|	ОсновныеНачисления.ОтработаноДнейПоПятидневке,
	|	ОсновныеНачисления.НормаДней,
	|	ОсновныеНачисления.НормаЧасов,
	|	ОсновныеНачисления.НормаДнейПоПятидневке,
	|	ОсновныеНачисления.ОтработаноЧасовПоПятидневке,
	|	ОсновныеНачисления.НормаЧасовПоПятидневке,
	|	ОсновныеНачисления.ДатаНачалаСобытия,
	|	ПособияКРегистрации.Организация,
	|	ОсновныеНачисления.БазовыйПериодНачало,
	|	ОсновныеНачисления.БазовыйПериодКонец,
	|	ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаНачало,
	|	ОсновныеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	ОсновныеНачисления.ОбособленноеПодразделение,
	|	ОсновныеНачисления.ОплаченоДнейЧасов,
	|	ОсновныеНачисления.НомерСтроки,
	|	ОсновныеНачисления.ПериодРегистрации
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Регистратор,
	|	Сотрудник,
	|	ВидРасчета,
	|	ПериодДействияНачало
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ДополнительныеНачисления.Регистратор КАК Регистратор,
	|	ДополнительныеНачисления.Организация,
	|	ДополнительныеНачисления.Сотрудник КАК Сотрудник,
	|	ДополнительныеНачисления.ФизЛицо,
	|	ДополнительныеНачисления.ВидРасчета КАК ВидРасчета,
	|	ДополнительныеНачисления.БазовыйПериодНачало КАК БазовыйПериодНачало,
	|	ДополнительныеНачисления.БазовыйПериодКонец,
	|	ДополнительныеНачисления.Показатель1,
	|	ДополнительныеНачисления.Показатель2,
	|	ДополнительныеНачисления.Показатель3,
	|	ДополнительныеНачисления.Показатель4,
	|	ДополнительныеНачисления.Показатель5,
	|	ДополнительныеНачисления.Показатель6,
	|	ДополнительныеНачисления.ПодразделениеОрганизации,
	|	ДополнительныеНачисления.ОбособленноеПодразделение,
	|	ДополнительныеНачисления.Результат,
	|	ДополнительныеНачисления.ОплаченоДнейЧасов,
	|	ВЫБОР
	|		КОГДА ДополнительныеНачисления.ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
	|			ТОГДА СоответствиеДоходовИВычетов.КодВычета
	|		ИНАЧЕ ДополнительныеНачисления.ДокументОснование.КодВычета
	|	КОНЕЦ КАК КодВычета,
	|	ДополнительныеНачисления.СкидкаПриНалогообложении,
	|	ДополнительныеНачисления.ЧислоМесяцев,
	|	ДополнительныеНачисления.ПериодРасчетаСреднегоЗаработкаНачало,
	|	ДополнительныеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	ДополнительныеНачисления.ДатаНачалаСобытия,
	|	ДополнительныеНачисления.ГрафикРаботы,
	|	ДополнительныеНачисления.ДокументОснование,
	|	ДополнительныеНачисления.ВидУчетаВремени,
	|	ДополнительныеНачисления.НомерСтроки,
	|	НАЧАЛОПЕРИОДА(ДополнительныеНачисления.ПериодРегистрации, МЕСЯЦ) КАК ПериодРегистрации
	|ПОМЕСТИТЬ ВТСтрокиПереносаДанныхДополнительныхНачислений
	|ИЗ
	|	ВТРегистрацияПереносаДанных КАК ПособияКРегистрации
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисления
	|			ЛЕВОЕ СОЕДИНЕНИЕ ВТСоответствиеДоходовИВычетов КАК СоответствиеДоходовИВычетов
	|			ПО ДополнительныеНачисления.ВидРасчета.КодДоходаНДФЛ = СоответствиеДоходовИВычетов.КодДохода
	|		ПО ПособияКРегистрации.Регистратор = ДополнительныеНачисления.Регистратор
	|			И ПособияКРегистрации.Физлицо = ДополнительныеНачисления.ФизЛицо
	|ГДЕ
	|	(НЕ ДополнительныеНачисления.Сторно)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Регистратор,
	|	Сотрудник,
	|	БазовыйПериодНачало,
	|	ВидРасчета
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	УдержанияРаботниковОрганизаций.Регистратор КАК Регистратор,
	|	УдержанияРаботниковОрганизаций.Организация,
	|	УдержанияРаботниковОрганизаций.Сотрудник КАК Сотрудник,
	|	УдержанияРаботниковОрганизаций.ФизЛицо,
	|	УдержанияРаботниковОрганизаций.ВидРасчета КАК ВидРасчета,
	|	УдержанияРаботниковОрганизаций.БазовыйПериодНачало КАК БазовыйПериодНачало,
	|	УдержанияРаботниковОрганизаций.БазовыйПериодКонец,
	|	УдержанияРаботниковОрганизаций.Показатель1,
	|	УдержанияРаботниковОрганизаций.Показатель2,
	|	УдержанияРаботниковОрганизаций.Показатель3,
	|	УдержанияРаботниковОрганизаций.Показатель4,
	|	УдержанияРаботниковОрганизаций.Показатель5,
	|	УдержанияРаботниковОрганизаций.Показатель6,
	|	УдержанияРаботниковОрганизаций.Результат,
	|	УдержанияРаботниковОрганизаций.ПериодРасчетаСреднегоЗаработкаНачало,
	|	УдержанияРаботниковОрганизаций.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	УдержанияРаботниковОрганизаций.ДатаНачалаСобытия,
	|	УдержанияРаботниковОрганизаций.ДокументОснование,
	|	УдержанияРаботниковОрганизаций.ВидУчетаВремени,
	|	УдержанияРаботниковОрганизаций.НомерСтроки,
	|	УдержанияРаботниковОрганизаций.ПериодРегистрации КАК ПериодРегистрации
	|ПОМЕСТИТЬ ВТСтрокиПереносаДанныхУдержания
	|ИЗ
	|	ВТРегистрацияПереносаДанных КАК ПособияКРегистрации
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрРасчета.УдержанияРаботниковОрганизаций КАК УдержанияРаботниковОрганизаций
	|		ПО ПособияКРегистрации.Регистратор = УдержанияРаботниковОрганизаций.Регистратор
	|			И ПособияКРегистрации.Физлицо = УдержанияРаботниковОрганизаций.ФизЛицо
	|ГДЕ
	|	(НЕ УдержанияРаботниковОрганизаций.Сторно)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Регистратор,
	|	Сотрудник,
	|	БазовыйПериодНачало,
	|	ВидРасчета
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СтрокиНачисления.Регистратор КАК ПерерассчитываемыйДокумент,
	|	""Начисления"" КАК ИмяТабличнойЧасти,
	|	СтрокиНачисления.Сотрудник,
	|	СтрокиНачисления.ФизЛицо,
	|	СтрокиНачисления.ВидРасчета,
	|	СтрокиНачисления.ПериодРегистрации,
	|	СтрокиНачисления.ПериодДействияНачало КАК ДатаНачала,
	|	СтрокиНачисления.ПериодДействияКонец КАК ДатаОкончания,
	|	СтрокиНачисления.Показатель1,
	|	СтрокиНачисления.Показатель2,
	|	СтрокиНачисления.Показатель3,
	|	СтрокиНачисления.Показатель4,
	|	СтрокиНачисления.Показатель5,
	|	СтрокиНачисления.Показатель6,
	|	СтрокиНачисления.ПодразделениеОрганизации,
	|	СтрокиНачисления.Результат + ЕСТЬNULL(ПособияКРегистрации.СуммаКДоначислению, 0) КАК Результат,
	|	ВЫБОР
	|		КОГДА СтрокиНачисления.ВидРасчета.ВидВремени В (ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ЧасовоеОтработанноеВПределахНормы), ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ЧасовоеНеотработанное))
	|			ТОГДА СтрокиНачисления.ОтработаноЧасов
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ОплачиватьЧасов,
	|	СтрокиНачисления.ОтработаноДней,
	|	СтрокиНачисления.ОтработаноЧасов,
	|	СтрокиНачисления.ОтработаноДнейПоПятидневке,
	|	СтрокиНачисления.НормаДней,
	|	СтрокиНачисления.НормаЧасов,
	|	СтрокиНачисления.НормаДнейПоПятидневке,
	|	СтрокиНачисления.ОплаченоДнейЧасов,
	|	СтрокиНачисления.ОтработаноЧасовПоПятидневке,
	|	СтрокиНачисления.НормаЧасовПоПятидневке,
	|	СтрокиНачисления.ДатаНачалаСобытия,
	|	СтрокиНачисления.ПериодРасчетаСреднегоЗаработкаНачало,
	|	СтрокиНачисления.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	ЛОЖЬ КАК Сторно,
	|	НЕОПРЕДЕЛЕНО КАК СторнируемыйДокумент,
	|	НЕОПРЕДЕЛЕНО КАК КодВычета,
	|	0 КАК СуммаВычета,
	|	СтрокиНачисления.НомерСтроки КАК НомерСтроки,
	|	ИСТИНА КАК Авторасчет,
	|	ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка) КАК ДокументОснование
	|ИЗ
	|	ВТСтрокиПереносаДанных КАК СтрокиНачисления
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТПособияКРегистрации КАК ПособияКРегистрации
	|		ПО СтрокиНачисления.Регистратор = ПособияКРегистрации.Регистратор
	|			И СтрокиНачисления.Сотрудник = ПособияКРегистрации.Сотрудник
	|			И СтрокиНачисления.ПериодДействияНачало = ПособияКРегистрации.ДатаНачала
	|			И СтрокиНачисления.ВидРасчета = ПособияКРегистрации.ВидРасчета
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтрокиНачисления.Регистратор,
	|	""Начисления"",
	|	СтрокиНачисления.Сотрудник,
	|	СтрокиНачисления.ФизЛицо,
	|	СтрокиНачисления.ВидРасчета,
	|	СтрокиНачисления.ПериодРегистрации,
	|	СтрокиНачисления.ПериодДействияНачало,
	|	СтрокиНачисления.ПериодДействияКонец,
	|	СтрокиНачисления.Показатель1,
	|	СтрокиНачисления.Показатель2,
	|	СтрокиНачисления.Показатель3,
	|	СтрокиНачисления.Показатель4,
	|	СтрокиНачисления.Показатель5,
	|	СтрокиНачисления.Показатель6,
	|	СтрокиНачисления.ПодразделениеОрганизации,
	|	-СтрокиНачисления.Результат,
	|	ВЫБОР
	|		КОГДА СтрокиНачисления.ВидРасчета.ВидВремени В (ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ЧасовоеОтработанноеВПределахНормы), ЗНАЧЕНИЕ(Перечисление.ВидыВремени.ЧасовоеНеотработанное))
	|			ТОГДА СтрокиНачисления.ОтработаноЧасов
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	-СтрокиНачисления.ОтработаноДней,
	|	-СтрокиНачисления.ОтработаноЧасов,
	|	-СтрокиНачисления.ОтработаноДнейПоПятидневке,
	|	-СтрокиНачисления.НормаДней,
	|	-СтрокиНачисления.НормаЧасов,
	|	-СтрокиНачисления.НормаДнейПоПятидневке,
	|	-СтрокиНачисления.ОплаченоДнейЧасов,
	|	-СтрокиНачисления.ОтработаноЧасовПоПятидневке,
	|	-СтрокиНачисления.НормаЧасовПоПятидневке,
	|	СтрокиНачисления.ДатаНачалаСобытия,
	|	СтрокиНачисления.ПериодРасчетаСреднегоЗаработкаНачало,
	|	СтрокиНачисления.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	ИСТИНА,
	|	СтрокиНачисления.Регистратор,
	|	НЕОПРЕДЕЛЕНО,
	|	0,
	|	СтрокиНачисления.НомерСтроки,
	|	ЛОЖЬ,
	|	ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
	|ИЗ
	|	ВТСтрокиПереносаДанных КАК СтрокиНачисления
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтрокиДополнительныеНачисления.Регистратор,
	|	""ДополнительныеНачисления"",
	|	СтрокиДополнительныеНачисления.Сотрудник,
	|	СтрокиДополнительныеНачисления.ФизЛицо,
	|	СтрокиДополнительныеНачисления.ВидРасчета,
	|	СтрокиДополнительныеНачисления.ПериодРегистрации,
	|	СтрокиДополнительныеНачисления.БазовыйПериодНачало,
	|	СтрокиДополнительныеНачисления.БазовыйПериодКонец,
	|	СтрокиДополнительныеНачисления.Показатель1,
	|	СтрокиДополнительныеНачисления.Показатель2,
	|	СтрокиДополнительныеНачисления.Показатель3,
	|	СтрокиДополнительныеНачисления.Показатель4,
	|	СтрокиДополнительныеНачисления.Показатель5,
	|	СтрокиДополнительныеНачисления.Показатель6,
	|	СтрокиДополнительныеНачисления.ПодразделениеОрганизации,
	|	СтрокиДополнительныеНачисления.Результат + ЕСТЬNULL(ПособияКРегистрации.СуммаКДоначислению, 0),
	|	NULL,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	СтрокиДополнительныеНачисления.ОплаченоДнейЧасов,
	|	0,
	|	0,
	|	СтрокиДополнительныеНачисления.ДатаНачалаСобытия,
	|	СтрокиДополнительныеНачисления.ПериодРасчетаСреднегоЗаработкаНачало,
	|	СтрокиДополнительныеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	ЛОЖЬ,
	|	НЕОПРЕДЕЛЕНО,
	|	СтрокиДополнительныеНачисления.КодВычета,
	|	СтрокиДополнительныеНачисления.СкидкаПриНалогообложении,
	|	СтрокиДополнительныеНачисления.НомерСтроки,
	|	ИСТИНА,
	|	ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
	|ИЗ
	|	ВТСтрокиПереносаДанныхДополнительныхНачислений КАК СтрокиДополнительныеНачисления
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТПособияКРегистрации КАК ПособияКРегистрации
	|		ПО СтрокиДополнительныеНачисления.Регистратор = ПособияКРегистрации.Регистратор
	|			И СтрокиДополнительныеНачисления.Сотрудник = ПособияКРегистрации.Сотрудник
	|			И СтрокиДополнительныеНачисления.БазовыйПериодНачало = ПособияКРегистрации.ДатаНачала
	|			И СтрокиДополнительныеНачисления.ВидРасчета = ПособияКРегистрации.ВидРасчета
	|ГДЕ
	|	СтрокиДополнительныеНачисления.ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтрокиДополнительныеНачисления.Регистратор,
	|	""ДополнительныеНачисления"",
	|	СтрокиДополнительныеНачисления.Сотрудник,
	|	СтрокиДополнительныеНачисления.ФизЛицо,
	|	СтрокиДополнительныеНачисления.ВидРасчета,
	|	СтрокиДополнительныеНачисления.ПериодРегистрации,
	|	СтрокиДополнительныеНачисления.БазовыйПериодНачало,
	|	СтрокиДополнительныеНачисления.БазовыйПериодКонец,
	|	СтрокиДополнительныеНачисления.Показатель1,
	|	СтрокиДополнительныеНачисления.Показатель2,
	|	СтрокиДополнительныеНачисления.Показатель3,
	|	СтрокиДополнительныеНачисления.Показатель4,
	|	СтрокиДополнительныеНачисления.Показатель5,
	|	СтрокиДополнительныеНачисления.Показатель6,
	|	СтрокиДополнительныеНачисления.ПодразделениеОрганизации,
	|	-СтрокиДополнительныеНачисления.Результат,
	|	NULL,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	-СтрокиДополнительныеНачисления.ОплаченоДнейЧасов,
	|	0,
	|	0,
	|	СтрокиДополнительныеНачисления.ДатаНачалаСобытия,
	|	СтрокиДополнительныеНачисления.ПериодРасчетаСреднегоЗаработкаНачало,
	|	СтрокиДополнительныеНачисления.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	ИСТИНА,
	|	СтрокиДополнительныеНачисления.Регистратор,
	|	СтрокиДополнительныеНачисления.КодВычета,
	|	-СтрокиДополнительныеНачисления.СкидкаПриНалогообложении,
	|	СтрокиДополнительныеНачисления.НомерСтроки,
	|	ЛОЖЬ,
	|	ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
	|ИЗ
	|	ВТСтрокиПереносаДанныхДополнительныхНачислений КАК СтрокиДополнительныеНачисления
	|ГДЕ
	|	СтрокиДополнительныеНачисления.ДокументОснование = ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтрокиДополнительныеНачисления.Регистратор,
	|	""ДоговорыНаВыполнениеРабот"",
	|	СтрокиДополнительныеНачисления.Сотрудник,
	|	СтрокиДополнительныеНачисления.ФизЛицо,
	|	СтрокиДополнительныеНачисления.ВидРасчета,
	|	СтрокиДополнительныеНачисления.ПериодРегистрации,
	|	СтрокиДополнительныеНачисления.БазовыйПериодНачало,
	|	СтрокиДополнительныеНачисления.БазовыйПериодКонец,
	|	СтрокиДополнительныеНачисления.Показатель1,
	|	СтрокиДополнительныеНачисления.Показатель2,
	|	СтрокиДополнительныеНачисления.Показатель3,
	|	СтрокиДополнительныеНачисления.Показатель4,
	|	СтрокиДополнительныеНачисления.Показатель5,
	|	СтрокиДополнительныеНачисления.Показатель6,
	|	СтрокиДополнительныеНачисления.ПодразделениеОрганизации,
	|	СтрокиДополнительныеНачисления.Результат,
	|	NULL,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	NULL,
	|	NULL,
	|	NULL,
	|	ЛОЖЬ,
	|	НЕОПРЕДЕЛЕНО,
	|	СтрокиДополнительныеНачисления.КодВычета,
	|	СтрокиДополнительныеНачисления.СкидкаПриНалогообложении,
	|	СтрокиДополнительныеНачисления.НомерСтроки,
	|	ИСТИНА,
	|	СтрокиДополнительныеНачисления.ДокументОснование
	|ИЗ
	|	ВТСтрокиПереносаДанныхДополнительныхНачислений КАК СтрокиДополнительныеНачисления
	|ГДЕ
	|	СтрокиДополнительныеНачисления.ДокументОснование <> ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтрокиДополнительныеНачисления.Регистратор,
	|	""ДоговорыНаВыполнениеРабот"",
	|	СтрокиДополнительныеНачисления.Сотрудник,
	|	СтрокиДополнительныеНачисления.ФизЛицо,
	|	СтрокиДополнительныеНачисления.ВидРасчета,
	|	СтрокиДополнительныеНачисления.ПериодРегистрации,
	|	СтрокиДополнительныеНачисления.БазовыйПериодНачало,
	|	СтрокиДополнительныеНачисления.БазовыйПериодКонец,
	|	СтрокиДополнительныеНачисления.Показатель1,
	|	СтрокиДополнительныеНачисления.Показатель2,
	|	СтрокиДополнительныеНачисления.Показатель3,
	|	СтрокиДополнительныеНачисления.Показатель4,
	|	СтрокиДополнительныеНачисления.Показатель5,
	|	СтрокиДополнительныеНачисления.Показатель6,
	|	СтрокиДополнительныеНачисления.ПодразделениеОрганизации,
	|	-СтрокиДополнительныеНачисления.Результат,
	|	NULL,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	NULL,
	|	NULL,
	|	NULL,
	|	ИСТИНА,
	|	СтрокиДополнительныеНачисления.Регистратор,
	|	СтрокиДополнительныеНачисления.КодВычета,
	|	-СтрокиДополнительныеНачисления.СкидкаПриНалогообложении,
	|	СтрокиДополнительныеНачисления.НомерСтроки,
	|	ЛОЖЬ,
	|	СтрокиДополнительныеНачисления.ДокументОснование
	|ИЗ
	|	ВТСтрокиПереносаДанныхДополнительныхНачислений КАК СтрокиДополнительныеНачисления
	|ГДЕ
	|	СтрокиДополнительныеНачисления.ДокументОснование <> ЗНАЧЕНИЕ(Документ.ДоговорНаВыполнениеРаботСФизЛицом.ПустаяСсылка)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Удержания.Регистратор,
	|	""Удержания"",
	|	Удержания.Сотрудник,
	|	Удержания.ФизЛицо,
	|	Удержания.ВидРасчета,
	|	Удержания.ПериодРегистрации,
	|	Удержания.БазовыйПериодНачало,
	|	Удержания.БазовыйПериодКонец,
	|	Удержания.Показатель1,
	|	Удержания.Показатель2,
	|	Удержания.Показатель3,
	|	Удержания.Показатель4,
	|	Удержания.Показатель5,
	|	Удержания.Показатель6,
	|	NULL,
	|	Удержания.Результат,
	|	NULL,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	Удержания.ДатаНачалаСобытия,
	|	Удержания.ПериодРасчетаСреднегоЗаработкаНачало,
	|	Удержания.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	ЛОЖЬ,
	|	НЕОПРЕДЕЛЕНО,
	|	НЕОПРЕДЕЛЕНО,
	|	0,
	|	Удержания.НомерСтроки,
	|	ИСТИНА,
	|	Удержания.ДокументОснование
	|ИЗ
	|	ВТСтрокиПереносаДанныхУдержания КАК Удержания
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Удержания.Регистратор,
	|	""Удержания"",
	|	Удержания.Сотрудник,
	|	Удержания.ФизЛицо,
	|	Удержания.ВидРасчета,
	|	Удержания.ПериодРегистрации,
	|	Удержания.БазовыйПериодНачало,
	|	Удержания.БазовыйПериодКонец,
	|	Удержания.Показатель1,
	|	Удержания.Показатель2,
	|	Удержания.Показатель3,
	|	Удержания.Показатель4,
	|	Удержания.Показатель5,
	|	Удержания.Показатель6,
	|	NULL,
	|	-Удержания.Результат,
	|	NULL,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	Удержания.ДатаНачалаСобытия,
	|	Удержания.ПериодРасчетаСреднегоЗаработкаНачало,
	|	Удержания.ПериодРасчетаСреднегоЗаработкаОкончание,
	|	ИСТИНА,
	|	Удержания.Регистратор,
	|	НЕОПРЕДЕЛЕНО,
	|	0,
	|	Удержания.НомерСтроки,
	|	ЛОЖЬ,
	|	Удержания.ДокументОснование
	|ИЗ
	|	ВТСтрокиПереносаДанныхУдержания КАК Удержания
	|
	|УПОРЯДОЧИТЬ ПО
	|	ПерерассчитываемыйДокумент,
	|	ИмяТабличнойЧасти,
	|	Сторно УБЫВ,
	|	НомерСтроки";
	
	Возврат ЗапросТекст

КонецФункции // ПолучитьТекстЗапросаПоПереносДанных()

Функция ПолучитьТекстЗапросаПоРегистрацияРазовыхНачисленийРаботниковОрганизаций()

	ЗапросТекст =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ВЫРАЗИТЬ(ПособияКРегистрации.Регистратор КАК Документ.РегистрацияРазовыхНачисленийРаботниковОрганизаций) КАК Регистратор,
	|	ПособияКРегистрации.Физлицо
	|ПОМЕСТИТЬ ВТРегистрацияРазовыхНачислений
	|ИЗ
	|	ВТПособияКРегистрации КАК ПособияКРегистрации
	|ГДЕ
	|	ПособияКРегистрации.Регистратор ССЫЛКА Документ.РегистрацияРазовыхНачисленийРаботниковОрганизаций
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Регистратор
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ОсновныеНачисления.Ссылка КАК Регистратор,
	|	ОсновныеНачисления.Физлицо,
	|	ОсновныеНачисления.Ссылка.ПериодРегистрации КАК ПериодРегистрации,
	|	ОсновныеНачисления.ВидРасчета КАК ВидРасчета,
	|	ОсновныеНачисления.Сотрудник КАК Сотрудник,
	|	МИНИМУМ(ОсновныеНачисления.ДатаНачала) КАК ДатаНачала,
	|	МАКСИМУМ(ОсновныеНачисления.ДатаОкончания) КАК ДатаОкончания
	|ПОМЕСТИТЬ ВТСотрудникиРазовыхНачислений
	|ИЗ
	|	ВТРегистрацияРазовыхНачислений КАК ПособияКРегистрации
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.РегистрацияРазовыхНачисленийРаботниковОрганизаций.ОсновныеНачисления КАК ОсновныеНачисления
	|		ПО ПособияКРегистрации.Регистратор = ОсновныеНачисления.Ссылка
	|			И ПособияКРегистрации.Физлицо = ОсновныеНачисления.Физлицо
	|ГДЕ
	|	(НЕ ОсновныеНачисления.Сторно)
	|	И ОсновныеНачисления.Ссылка.Проведен
	|
	|СГРУППИРОВАТЬ ПО
	|	ОсновныеНачисления.Сотрудник,
	|	ОсновныеНачисления.ВидРасчета,
	|	ОсновныеНачисления.Ссылка,
	|	ОсновныеНачисления.Ссылка.ПериодРегистрации,
	|	ОсновныеНачисления.Физлицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Сотрудник,
	|	ВидРасчета
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Сотрудники.Регистратор КАК Регистратор,
	|	Сотрудники.Сотрудник КАК Сотрудник,
	|	Сотрудники.ВидРасчета КАК ВидРасчета,
	|	СторноНачисления.ПериодДействияНачало,
	|	СторноНачисления.ПериодДействияКонец,
	|	СторноНачисления.Результат,
	|	СторноНачисления.ОтработаноДней,
	|	СторноНачисления.ОтработаноЧасов,
	|	СторноНачисления.ОтработаноДнейПоПятидневке,
	|	СторноНачисления.НормаДней,
	|	СторноНачисления.НормаЧасов,
	|	СторноНачисления.НормаДнейПоПятидневке,
	|	СторноНачисления.ОплаченоДнейЧасов,
	|	СторноНачисления.ОтработаноЧасовПоПятидневке,
	|	СторноНачисления.НормаЧасовПоПятидневке
	|ПОМЕСТИТЬ ВТСторноРазовыхНачислений
	|ИЗ
	|	ВТСотрудникиРазовыхНачислений КАК Сотрудники
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК СторноНачисления
	|		ПО Сотрудники.Сотрудник = СторноНачисления.Сотрудник
	|			И Сотрудники.ВидРасчета = СторноНачисления.ВидРасчета
	|			И (СторноНачисления.ПериодДействия МЕЖДУ Сотрудники.ДатаНачала И Сотрудники.ДатаОкончания)
	|			И (СторноНачисления.ПериодРегистрации > Сотрудники.ПериодРегистрации)
	|			И (СторноНачисления.ПериодРегистрации <= &ПериодРегистрации)
	|			И (СторноНачисления.СторнируемыйДокумент = Сотрудники.Регистратор)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Регистратор,
	|	Сотрудник,
	|	ВидРасчета
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ПособияКРегистрации.Регистратор КАК Ссылка,
	|	ПособияКРегистрации.Сотрудник,
	|	ПособияКРегистрации.ВидРасчета,
	|	ОсновныеНачисления.Физлицо,
	|	ОсновныеНачисления.ДатаНачала,
	|	ОсновныеНачисления.ДатаОкончания,
	|	ОсновныеНачисления.Показатель1,
	|	ОсновныеНачисления.Показатель2,
	|	ОсновныеНачисления.Показатель3,
	|	ОсновныеНачисления.Показатель4,
	|	ОсновныеНачисления.Показатель5,
	|	ОсновныеНачисления.Показатель6,
	|	ОсновныеНачисления.ПодразделениеОрганизации,
	|	ОсновныеНачисления.Результат + ЕСТЬNULL(СУММА(СторноНачисления.Результат), 0) КАК Результат,
	|	ОсновныеНачисления.ОтработаноДней + ЕСТЬNULL(СУММА(СторноНачисления.ОтработаноДней), 0) КАК ОтработаноДней,
	|	ОсновныеНачисления.ОтработаноЧасов + ЕСТЬNULL(СУММА(СторноНачисления.ОтработаноЧасов), 0) КАК ОтработаноЧасов,
	|	ОсновныеНачисления.ОтработаноДнейПоПятидневке + ЕСТЬNULL(СУММА(СторноНачисления.ОтработаноДнейПоПятидневке), 0) КАК ОтработаноДнейПоПятидневке,
	|	ОсновныеНачисления.НормаДней + ЕСТЬNULL(СУММА(СторноНачисления.НормаДней), 0) КАК НормаДней,
	|	ОсновныеНачисления.НормаЧасов + ЕСТЬNULL(СУММА(СторноНачисления.НормаЧасов), 0) КАК НормаЧасов,
	|	ОсновныеНачисления.НормаДнейПоПятидневке + ЕСТЬNULL(СУММА(СторноНачисления.НормаДнейПоПятидневке), 0) КАК НормаДнейПоПятидневке,
	|	ОсновныеНачисления.ОплаченоДнейЧасов + ЕСТЬNULL(СУММА(СторноНачисления.ОплаченоДнейЧасов), 0) КАК ОплаченоДнейЧасов,
	|	ОсновныеНачисления.ОтработаноЧасовПоПятидневке + ЕСТЬNULL(СУММА(СторноНачисления.ОтработаноЧасовПоПятидневке), 0) КАК ОтработаноЧасовПоПятидневке,
	|	ОсновныеНачисления.НормаЧасовПоПятидневке + ЕСТЬNULL(СУММА(СторноНачисления.НормаЧасовПоПятидневке), 0) КАК НормаЧасовПоПятидневке,
	|	ОсновныеНачисления.ДатаНачалаСобытия,
	|	ОсновныеНачисления.ОплачиватьЧасов,
	|	ОсновныеНачисления.НомерСтроки
	|ПОМЕСТИТЬ ВТСтрокиРазовыхНачислений
	|ИЗ
	|	ВТСотрудникиРазовыхНачислений КАК ПособияКРегистрации
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.РегистрацияРазовыхНачисленийРаботниковОрганизаций.ОсновныеНачисления КАК ОсновныеНачисления
	|			ЛЕВОЕ СОЕДИНЕНИЕ ВТСторноРазовыхНачислений КАК СторноНачисления
	|			ПО ОсновныеНачисления.Сотрудник = СторноНачисления.Сотрудник
	|				И ОсновныеНачисления.ВидРасчета = СторноНачисления.ВидРасчета
	|				И ОсновныеНачисления.Ссылка = СторноНачисления.Регистратор
	|				И (СторноНачисления.ПериодДействияНачало МЕЖДУ ОсновныеНачисления.ДатаНачала И ОсновныеНачисления.ДатаОкончания)
	|				И (СторноНачисления.ПериодДействияКонец МЕЖДУ ОсновныеНачисления.ДатаНачала И ОсновныеНачисления.ДатаОкончания)
	|		ПО ПособияКРегистрации.Регистратор = ОсновныеНачисления.Ссылка
	|			И ПособияКРегистрации.Сотрудник = ОсновныеНачисления.Сотрудник
	|			И ПособияКРегистрации.ВидРасчета = ОсновныеНачисления.ВидРасчета
	|ГДЕ
	|	(НЕ ОсновныеНачисления.Сторно)
	|
	|СГРУППИРОВАТЬ ПО
	|	ПособияКРегистрации.Регистратор,
	|	ПособияКРегистрации.Сотрудник,
	|	ОсновныеНачисления.Физлицо,
	|	ПособияКРегистрации.ВидРасчета,
	|	ОсновныеНачисления.ДатаНачала,
	|	ОсновныеНачисления.ДатаОкончания,
	|	ОсновныеНачисления.Показатель1,
	|	ОсновныеНачисления.Показатель2,
	|	ОсновныеНачисления.Показатель3,
	|	ОсновныеНачисления.Показатель4,
	|	ОсновныеНачисления.Показатель5,
	|	ОсновныеНачисления.Показатель6,
	|	ОсновныеНачисления.ПодразделениеОрганизации,
	|	ОсновныеНачисления.Результат,
	|	ОсновныеНачисления.ОтработаноДней,
	|	ОсновныеНачисления.ОтработаноЧасов,
	|	ОсновныеНачисления.ОтработаноДнейПоПятидневке,
	|	ОсновныеНачисления.НормаДней,
	|	ОсновныеНачисления.НормаЧасов,
	|	ОсновныеНачисления.НормаДнейПоПятидневке,
	|	ОсновныеНачисления.ОплаченоДнейЧасов,
	|	ОсновныеНачисления.ОтработаноЧасовПоПятидневке,
	|	ОсновныеНачисления.НормаЧасовПоПятидневке,
	|	ОсновныеНачисления.ДатаНачалаСобытия,
	|	ОсновныеНачисления.ОплачиватьЧасов,
	|	ОсновныеНачисления.НомерСтроки
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ДополнительныеНачисления.Ссылка,
	|	ДополнительныеНачисления.Сотрудник,
	|	ДополнительныеНачисления.Физлицо,
	|	ДополнительныеНачисления.ВидРасчета,
	|	ДополнительныеНачисления.ДатаНачала,
	|	ДополнительныеНачисления.ДатаОкончания,
	|	ДополнительныеНачисления.Показатель1,
	|	ДополнительныеНачисления.Показатель2,
	|	ДополнительныеНачисления.Показатель3,
	|	ДополнительныеНачисления.Показатель4,
	|	ДополнительныеНачисления.Показатель5,
	|	ДополнительныеНачисления.Показатель6,
	|	ДополнительныеНачисления.ПодразделениеОрганизации,
	|	ДополнительныеНачисления.Результат,
	|	ДополнительныеНачисления.КодВычета,
	|	ДополнительныеНачисления.СуммаВычета,
	|	ДополнительныеНачисления.ОплаченоДнейЧасов,
	|	ДополнительныеНачисления.НомерСтроки
	|ПОМЕСТИТЬ ВТСтрокиРазовыхДополнительныхНачислений
	|ИЗ
	|	ВТРегистрацияРазовыхНачислений КАК ПособияКРегистрации
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.РегистрацияРазовыхНачисленийРаботниковОрганизаций.ДополнительныеНачисления КАК ДополнительныеНачисления
	|		ПО ПособияКРегистрации.Регистратор = ДополнительныеНачисления.Ссылка
	|			И ПособияКРегистрации.Физлицо = ДополнительныеНачисления.Физлицо
	|ГДЕ
	|	(НЕ ДополнительныеНачисления.Сторно)
	|	И ДополнительныеНачисления.Ссылка.Проведен
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СтрокиНачисления.Ссылка КАК ПерерассчитываемыйДокумент,
	|	""ОсновныеНачисления"" КАК ИмяТабличнойЧасти,
	|	СтрокиНачисления.Сотрудник,
	|	СтрокиНачисления.Физлицо,
	|	СтрокиНачисления.ВидРасчета,
	|	СтрокиНачисления.ДатаНачала,
	|	СтрокиНачисления.ДатаОкончания,
	|	СтрокиНачисления.Показатель1,
	|	СтрокиНачисления.Показатель2,
	|	СтрокиНачисления.Показатель3,
	|	СтрокиНачисления.Показатель4,
	|	СтрокиНачисления.Показатель5,
	|	СтрокиНачисления.Показатель6,
	|	СтрокиНачисления.ПодразделениеОрганизации,
	|	СтрокиНачисления.Результат + ЕСТЬNULL(ПособияКРегистрации.СуммаКДоначислению, 0) КАК Результат,
	|	СтрокиНачисления.ОтработаноДней,
	|	СтрокиНачисления.ОтработаноЧасов,
	|	СтрокиНачисления.ОтработаноДнейПоПятидневке,
	|	СтрокиНачисления.НормаДней,
	|	СтрокиНачисления.НормаЧасов,
	|	СтрокиНачисления.НормаДнейПоПятидневке,
	|	СтрокиНачисления.ОплаченоДнейЧасов,
	|	СтрокиНачисления.ОтработаноЧасовПоПятидневке,
	|	СтрокиНачисления.НормаЧасовПоПятидневке,
	|	СтрокиНачисления.ДатаНачалаСобытия,
	|	СтрокиНачисления.ОплачиватьЧасов,
	|	ЛОЖЬ КАК Сторно,
	|	НЕОПРЕДЕЛЕНО КАК СторнируемыйДокумент,
	|	СтрокиНачисления.НомерСтроки КАК НомерСтроки,
	|	НЕОПРЕДЕЛЕНО КАК КодВычета,
	|	0 КАК СуммаВычета,
	|	ИСТИНА КАК Авторасчет
	|ИЗ
	|	ВТСтрокиРазовыхНачислений КАК СтрокиНачисления
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТПособияКРегистрации КАК ПособияКРегистрации
	|		ПО СтрокиНачисления.Ссылка = ПособияКРегистрации.Регистратор
	|			И СтрокиНачисления.Сотрудник = ПособияКРегистрации.Сотрудник
	|			И СтрокиНачисления.ДатаНачала = ПособияКРегистрации.ДатаНачала
	|			И СтрокиНачисления.ВидРасчета = ПособияКРегистрации.ВидРасчета
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтрокиНачисления.Ссылка,
	|	""ОсновныеНачисления"",
	|	СтрокиНачисления.Сотрудник,
	|	СтрокиНачисления.Физлицо,
	|	СтрокиНачисления.ВидРасчета,
	|	СтрокиНачисления.ДатаНачала,
	|	СтрокиНачисления.ДатаОкончания,
	|	СтрокиНачисления.Показатель1,
	|	СтрокиНачисления.Показатель2,
	|	СтрокиНачисления.Показатель3,
	|	СтрокиНачисления.Показатель4,
	|	СтрокиНачисления.Показатель5,
	|	СтрокиНачисления.Показатель6,
	|	СтрокиНачисления.ПодразделениеОрганизации,
	|	-СтрокиНачисления.Результат,
	|	-СтрокиНачисления.ОтработаноДней,
	|	-СтрокиНачисления.ОтработаноЧасов,
	|	-СтрокиНачисления.ОтработаноДнейПоПятидневке,
	|	-СтрокиНачисления.НормаДней,
	|	-СтрокиНачисления.НормаЧасов,
	|	-СтрокиНачисления.НормаДнейПоПятидневке,
	|	-СтрокиНачисления.ОплаченоДнейЧасов,
	|	-СтрокиНачисления.ОтработаноЧасовПоПятидневке,
	|	-СтрокиНачисления.НормаЧасовПоПятидневке,
	|	СтрокиНачисления.ДатаНачалаСобытия,
	|	СтрокиНачисления.ОплачиватьЧасов,
	|	ИСТИНА,
	|	СтрокиНачисления.Ссылка,
	|	СтрокиНачисления.НомерСтроки,
	|	НЕОПРЕДЕЛЕНО,
	|	0,
	|	ЛОЖЬ
	|ИЗ
	|	ВТСтрокиРазовыхНачислений КАК СтрокиНачисления
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтрокиДополнительныеНачисления.Ссылка,
	|	""ДополнительныеНачисления"",
	|	СтрокиДополнительныеНачисления.Сотрудник,
	|	СтрокиДополнительныеНачисления.Физлицо,
	|	СтрокиДополнительныеНачисления.ВидРасчета,
	|	СтрокиДополнительныеНачисления.ДатаНачала,
	|	СтрокиДополнительныеНачисления.ДатаОкончания,
	|	СтрокиДополнительныеНачисления.Показатель1,
	|	СтрокиДополнительныеНачисления.Показатель2,
	|	СтрокиДополнительныеНачисления.Показатель3,
	|	СтрокиДополнительныеНачисления.Показатель4,
	|	СтрокиДополнительныеНачисления.Показатель5,
	|	СтрокиДополнительныеНачисления.Показатель6,
	|	СтрокиДополнительныеНачисления.ПодразделениеОрганизации,
	|	СтрокиДополнительныеНачисления.Результат + ЕСТЬNULL(ПособияКРегистрации.СуммаКДоначислению, 0),
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	СтрокиДополнительныеНачисления.ОплаченоДнейЧасов,
	|	0,
	|	0,
	|	НЕОПРЕДЕЛЕНО,
	|	0,
	|	ЛОЖЬ,
	|	НЕОПРЕДЕЛЕНО,
	|	СтрокиДополнительныеНачисления.НомерСтроки,
	|	СтрокиДополнительныеНачисления.КодВычета,
	|	СтрокиДополнительныеНачисления.СуммаВычета,
	|	ИСТИНА
	|ИЗ
	|	ВТСтрокиРазовыхДополнительныхНачислений КАК СтрокиДополнительныеНачисления
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТПособияКРегистрации КАК ПособияКРегистрации
	|		ПО СтрокиДополнительныеНачисления.Ссылка = ПособияКРегистрации.Регистратор
	|			И СтрокиДополнительныеНачисления.Сотрудник = ПособияКРегистрации.Сотрудник
	|			И СтрокиДополнительныеНачисления.ДатаНачала = ПособияКРегистрации.ДатаНачала
	|			И СтрокиДополнительныеНачисления.ВидРасчета = ПособияКРегистрации.ВидРасчета
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СтрокиДополнительныеНачисления.Ссылка,
	|	""ДополнительныеНачисления"",
	|	СтрокиДополнительныеНачисления.Сотрудник,
	|	СтрокиДополнительныеНачисления.Физлицо,
	|	СтрокиДополнительныеНачисления.ВидРасчета,
	|	СтрокиДополнительныеНачисления.ДатаНачала,
	|	СтрокиДополнительныеНачисления.ДатаОкончания,
	|	СтрокиДополнительныеНачисления.Показатель1,
	|	СтрокиДополнительныеНачисления.Показатель2,
	|	СтрокиДополнительныеНачисления.Показатель3,
	|	СтрокиДополнительныеНачисления.Показатель4,
	|	СтрокиДополнительныеНачисления.Показатель5,
	|	СтрокиДополнительныеНачисления.Показатель6,
	|	СтрокиДополнительныеНачисления.ПодразделениеОрганизации,
	|	-СтрокиДополнительныеНачисления.Результат,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	-СтрокиДополнительныеНачисления.ОплаченоДнейЧасов,
	|	0,
	|	0,
	|	НЕОПРЕДЕЛЕНО,
	|	0,
	|	ИСТИНА,
	|	СтрокиДополнительныеНачисления.Ссылка,
	|	СтрокиДополнительныеНачисления.НомерСтроки,
	|	СтрокиДополнительныеНачисления.КодВычета,
	|	-СтрокиДополнительныеНачисления.СуммаВычета,
	|	ЛОЖЬ
	|ИЗ
	|	ВТСтрокиРазовыхДополнительныхНачислений КАК СтрокиДополнительныеНачисления
	|
	|УПОРЯДОЧИТЬ ПО
	|	ПерерассчитываемыйДокумент,
	|	ИмяТабличнойЧасти,
	|	Сторно УБЫВ,
	|	НомерСтроки";
	
	Возврат ЗапросТекст

КонецФункции // ПолучитьТекстЗапросаПоРегистрацияРазовыхНачисленийРаботниковОрганизаций()

////////////////////////////////////////////////////////////////////////////////
// ЭКСПОРТНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ ОБРАБОТКИ

Процедура ЗаписатьРезультатыПерерасчетов() Экспорт 
	
	СтрокиКОбработке = ПолучателиПособий.Выгрузить(Новый Структура("Отметка",Истина),"НомерСтроки, Регистратор, ОбособленноеПодразделение, Сотрудник, Физлицо, ВидРасчета, ВидПособия, ДатаНачала, СуммаКДоначислению");
	КоличествоСтрокПособий = СтрокиКОбработке.Количество();
	
	Если КоличествоСтрокПособий = 0 Тогда
		Возврат 
	КонецЕсли;
	
	СтрокиКУдалению = Новый Массив();
	
	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	Запрос.УстановитьПараметр("НовыеРезультаты",СтрокиКОбработке);
	Запрос.УстановитьПараметр("ПериодРегистрации",ПериодРегистрации);
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	НовыеРезультаты.Регистратор КАК Регистратор,
	|	НовыеРезультаты.ОбособленноеПодразделение,
	|	НовыеРезультаты.Физлицо,
	|	НовыеРезультаты.Сотрудник КАК Сотрудник,
	|	НовыеРезультаты.ВидРасчета,
	|	НовыеРезультаты.ВидПособия,
	|	НовыеРезультаты.ДатаНачала,
	|	НовыеРезультаты.СуммаКДоначислению
	|ПОМЕСТИТЬ ВТПособияКРегистрации
	|ИЗ
	|	&НовыеРезультаты КАК НовыеРезультаты";
	Запрос.Выполнить();
	
	Запрос.Текст = ПолучитьТекстЗапросаПоНачислениеЕдиновременныхПособийЗаСчетФСС();
	
	ВыборкаРегистраторов = Запрос.Выполнить().Выбрать();
	Пока ВыборкаРегистраторов.СледующийПоЗначениюПоля("ПерерассчитываемыйДокумент") Цикл
		ОбработатьПростойДокумент(ВыборкаРегистраторов, Документы.НачислениеЕдиновременныхПособийЗаСчетФСС.СоздатьДокумент(), СтрокиКУдалению)
	КонецЦикла;
	
	Если СтрокиКУдалению.Количество() = КоличествоСтрокПособий Тогда
		УдалитьОбработанныеСтроки(СтрокиКУдалению);
		Возврат
	КонецЕсли;
	
	Запрос.Текст = ПолучитьТекстЗапросаПоНачислениеЗарплатыРаботникамОрганизаций();
	
	ВыборкаРегистраторов = Запрос.Выполнить().Выбрать();
	Пока ВыборкаРегистраторов.СледующийПоЗначениюПоля("ПерерассчитываемыйДокумент") Цикл
		ОбработатьСложныйДокумент(ВыборкаРегистраторов, Документы.НачислениеЗарплатыРаботникамОрганизаций.СоздатьДокумент(), СтрокиКУдалению)
	КонецЦикла;
			
	Если СтрокиКУдалению.Количество() = КоличествоСтрокПособий Тогда
		УдалитьОбработанныеСтроки(СтрокиКУдалению);
		Возврат
	КонецЕсли;
	
	Запрос.Текст = ПолучитьТекстЗапросаПоРегистрацияРазовыхНачисленийРаботниковОрганизаций();
	
	ВыборкаРегистраторов = Запрос.Выполнить().Выбрать();
	Пока ВыборкаРегистраторов.СледующийПоЗначениюПоля("ПерерассчитываемыйДокумент") Цикл
		ОбработатьСложныйДокумент(ВыборкаРегистраторов, Документы.РегистрацияРазовыхНачисленийРаботниковОрганизаций.СоздатьДокумент(), СтрокиКУдалению)
	КонецЦикла;
	
	Если СтрокиКУдалению.Количество() = КоличествоСтрокПособий Тогда
		УдалитьОбработанныеСтроки(СтрокиКУдалению);
		Возврат
	КонецЕсли;
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	Соответствие.КодВычета,
	|	Соответствие.КодДохода
	|ПОМЕСТИТЬ ВТСоответствиеДоходовИВычетов
	|ИЗ
	|	&ТаблицаСоответствияДоходовИВычетов КАК Соответствие";
	Запрос.УстановитьПараметр("ТаблицаСоответствияДоходовИВычетов",ПроведениеРасчетов.ПолучитьТаблицуСоответствияДоходовИВычетов());
	Запрос.Выполнить();
	
	Запрос.Текст = ПолучитьТекстЗапросаПоПереносДанных();
	
	ВыборкаРегистраторов = Запрос.Выполнить().Выбрать();
	Пока ВыборкаРегистраторов.СледующийПоЗначениюПоля("ПерерассчитываемыйДокумент") Цикл
		НовыйДокумент = Документы.НачислениеЗарплатыРаботникамОрганизаций.СоздатьДокумент();
		НовыйДокумент.ВидОперации = Перечисления.ВидыОперацийНачислениеЗарплатыРаботникамОрганизаций.ПолныйРасчет;
		НовыйДокумент.ПериодНачисления = Перечисления.ПериодНачисленияЗарплаты.ПрошлыйПериод;
		НовыйДокумент.ПериодНачисленияДатаНачала = ВыборкаРегистраторов.ПериодРегистрации;
		НовыйДокумент.ПериодНачисленияДатаОкончания = КонецМесяца(ВыборкаРегистраторов.ПериодРегистрации);
		ОбработатьСложныйДокумент(ВыборкаРегистраторов, НовыйДокумент, СтрокиКУдалению);
	КонецЦикла;
	
	// удалим обработанные строки
	Для каждого СтрокаТЧ Из СтрокиКУдалению Цикл
		ПолучателиПособий.Удалить(СтрокаТЧ)
	КонецЦикла;
			
КонецПроцедуры // ЗаписатьРезультатыПерерасчетов()
	
Процедура ОбновитьРазмерыПособий(ДатаНачалаИзменений) Экспорт

    Даты = Новый Массив;
	Для каждого СтрокаТЧ Из Индексации Цикл
		Если СтрокаТЧ.Период >= ДатаНачалаИзменений Тогда
			Даты.Добавить(СтрокаТЧ.Период)
		КонецЕсли;
	КонецЦикла;
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("МассивПособий", МассивПособий);
	Запрос.УстановитьПараметр("ДатаНачалаИндексации", '20080101');
	Запрос.УстановитьПараметр("НовыеРазмеры", РазмерыПособий.Выгрузить());
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	ГосударственныеПособия.ВидПособия КАК ВидПособия,
	|	ГосударственныеПособия.Период КАК Период
	|ПОМЕСТИТЬ ВТНовыеРазмеры
	|ИЗ
	|	&НовыеРазмеры КАК ГосударственныеПособия
	|ГДЕ
	|	ГосударственныеПособия.Период >= &ДатаНачалаИндексации
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Период,
	|	ВидПособия
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	СтарыеРазмеры.Период КАК Период
	|ИЗ
	|	РегистрСведений.ГосударственныеПособия КАК СтарыеРазмеры
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТНовыеРазмеры КАК ОбщиеДанные
	|		ПО СтарыеРазмеры.ВидПособия = ОбщиеДанные.ВидПособия
	|			И СтарыеРазмеры.Период = ОбщиеДанные.Период
	|ГДЕ
	|	СтарыеРазмеры.ВидПособия В(&МассивПособий)
	|	И СтарыеРазмеры.Период >= &ДатаНачалаИндексации
	|	И ОбщиеДанные.Период ЕСТЬ NULL ";
	
	Выборка = Запрос.Выполнить().Выбрать();
	Пока Выборка.Следующий() Цикл
		Даты.Добавить(Выборка.Период)
	КонецЦикла;
	
	НаборЗаписей = РегистрыСведений.ГосударственныеПособия.СоздатьНаборЗаписей();
	НаборЗаписей.ОбменДанными.Загрузка = Истина;
	НаборЗаписей.Отбор.Период.Использование = Истина;
	НаборЗаписей.Отбор.ВидПособия.Использование = Истина;
	
	СтруктураПоиска = Новый Структура("ВидПособия, Период");
	Для каждого ДатаИзменений Из Даты Цикл
		
		СтруктураПоиска.Период = ДатаИзменений;
		НаборЗаписей.Отбор.Период.Значение = ДатаИзменений;
		
		Для каждого ЭлементМассива Из МассивПособий Цикл
			
			СтруктураПоиска.ВидПособия = ЭлементМассива;
			НаборЗаписей.Отбор.ВидПособия.Значение = ЭлементМассива;
			
			СтрокаТЗ = РазмерыПособий.НайтиСтроки(СтруктураПоиска);
			Если СтрокаТЗ.Количество() > 0 Тогда
				ЗаполнитьЗначенияСвойств(НаборЗаписей.Добавить(),СтрокаТЗ[0]);
			КонецЕсли;
			
			НаборЗаписей.Записать();
			НаборЗаписей.Очистить();
			
		КонецЦикла;
		
	КонецЦикла;
	
КонецПроцедуры // ОбновитьРазмерыПособий()

Процедура ПолучитьДанныеДляИндексирования() Экспорт

	Запрос = Новый Запрос;
	Запрос.Текст =
	"ВЫБРАТЬ
	|	ГосударственныеПособия.ВидПособия КАК ВидПособия,
	|	ГосударственныеПособия.Период КАК Период,
	|	ГосударственныеПособия.Размер
	|ИЗ
	|	РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|ГДЕ
	|	ГосударственныеПособия.ВидПособия В(&МассивПособий)
	|
	|УПОРЯДОЧИТЬ ПО
	|	ВидПособия,
	|	Период";
	Запрос.УстановитьПараметр("МассивПособий", МассивПособий);
	ТаблицаИсторииГосударственныеПособия = Запрос.Выполнить().Выгрузить();
	
	// построим таблицу индексации по пособию ПриРожденииРебенка
	Отбор = Новый Структура("ВидПособия", Перечисления.РазмерыГосударственныхПособий.ПриРожденииРебенка);
	МассивСтрок = ТаблицаИсторииГосударственныеПособия.НайтиСтроки(Отбор);
	
	НетДанныхПоПособиям = МассивСтрок.Количество() = 0;
	Если НетДанныхПоПособиям Тогда
		// нет данных по пособиям, нечего индексировать
		Возврат;
	КонецЕсли;	
		
	ДатаНачалаИндексации = '20080101';
	ТаблицаИндексации = ТаблицаИсторииГосударственныеПособия.Скопировать(МассивСтрок, "Размер, Период");
	ТаблицаИндексации.Сортировать("Период");
	ПредыдущийРазмер = 0;
	Для каждого СтрокаТЗ Из ТаблицаИндексации Цикл
		Если СтрокаТЗ.Период >= ДатаНачалаИндексации Тогда
			НоваяСтрока = Индексации.Добавить();
			НоваяСтрока.Период = СтрокаТЗ.Период;
			НоваяСтрока.Процент = Окр((СтрокаТЗ.Размер - ПредыдущийРазмер)/ПредыдущийРазмер * 100,3);
		КонецЕсли;
		ПредыдущийРазмер = СтрокаТЗ.Размер;
	КонецЦикла;
	
	РазмерыПособий.Загрузить(ТаблицаИсторииГосударственныеПособия);
	
КонецПроцедуры

Процедура ПолучитьДанныеПоНачисленнымПособиям() Экспорт

	Запрос = Новый Запрос;
    Запрос.УстановитьПараметр("ДатаНачала",ДатаНачала);
    Запрос.УстановитьПараметр("ДатаОкончания",КонецМесяца(ДатаОкончания));
    Запрос.УстановитьПараметр("ТекущийПериод",ПериодРегистрации);
	ПособияНаДетей = Новый Массив;
	ПособияНаДетей.Добавить(Перечисления.ВидыПособийСоциальногоСтрахования.ПоУходуЗаРебенкомДоПолутораЛет);
	ПособияНаДетей.Добавить(Перечисления.ВидыПособийСоциальногоСтрахования.ПриПостановкеНаУчетВРанниеСрокиБеременности);
	ПособияНаДетей.Добавить(Перечисления.ВидыПособийСоциальногоСтрахования.ПриРожденииРебенка);
	Запрос.УстановитьПараметр("ПособияНаДетей",ПособияНаДетей);
	
    Запрос.Текст =
	"ВЫБРАТЬ
	|	ОсновныеНачисленияОрганизаций.Ссылка КАК Ссылка
	|ПОМЕСТИТЬ ВТВидыРасчета
	|ИЗ
	|	ПланВидовРасчета.ОсновныеНачисленияОрганизаций КАК ОсновныеНачисленияОрганизаций
	|ГДЕ
	|	ОсновныеНачисленияОрганизаций.ВидПособияСоциальногоСтрахования В(&ПособияНаДетей)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ДополнительныеНачисленияОрганизаций.Ссылка
	|ИЗ
	|	ПланВидовРасчета.ДополнительныеНачисленияОрганизаций КАК ДополнительныеНачисленияОрганизаций
	|ГДЕ
	|	ДополнительныеНачисленияОрганизаций.ВидПособияСоциальногоСтрахования В(&ПособияНаДетей)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	|	ОсновныеНачисленияРаботниковОрганизаций.Регистратор КАК Регистратор,
	|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник,
	|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияНачало КАК НачалоПериода,
	|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействияКонец КАК КонецПериода,
	|	ОсновныеНачисленияРаботниковОрганизаций.ОбособленноеПодразделение,
	|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета,
	|	ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета.ВидПособияСоциальногоСтрахования КАК ВидПособия,
	|	ВЫРАЗИТЬ(ОсновныеНачисленияРаботниковОрганизаций.Показатель1 * ВЫБОР
	|			КОГДА 40 * ОсновныеНачисленияРаботниковОрганизаций.Показатель2 < 100
	|				ТОГДА 40 * ОсновныеНачисленияРаботниковОрганизаций.Показатель2
	|			ИНАЧЕ 100
	|		КОНЕЦ / 100 * ВЫБОР
	|			КОГДА ГОД(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействия) >= 2010
	|				ТОГДА 30.4
	|			ИНАЧЕ ВЫРАЗИТЬ(ДЕНЬГОДА(КОНЕЦПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодДействия, ГОД)) / 12 КАК ЧИСЛО(15, 1))
	|		КОНЕЦ КАК ЧИСЛО(15, 2)) КАК МесячноеПособие,
	|	ОсновныеНачисленияРаботниковОрганизаций.Показатель2 КАК КоличествоДетейВсего,
	|	ОсновныеНачисленияРаботниковОрганизаций.Показатель3 КАК КоличествоПервыхДетей,
	|	ОсновныеНачисленияРаботниковОрганизаций.Результат КАК СуммаНачисленная,
	|	ВЫБОР
	|		КОГДА ОсновныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации.КодПоОКАТО <> """"""""
	|				И ОсновныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации.РайонныйКоэффициентРФ > 1
	|			ТОГДА ОсновныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации.РайонныйКоэффициентРФ
	|		КОГДА ОсновныеНачисленияРаботниковОрганизаций.ОбособленноеПодразделение.РайонныйКоэффициентРФ > 1
	|			ТОГДА ОсновныеНачисленияРаботниковОрганизаций.ОбособленноеПодразделение.РайонныйКоэффициентРФ
	|		ИНАЧЕ 1
	|	КОНЕЦ КАК РайонныйКоэффициентРФОрганизации,
	|	ОсновныеНачисленияРаботниковОрганизаций.НомерСтроки КАК НомерСтроки,
	|	ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации
	|ПОМЕСТИТЬ ВТНачисленныеПособия
	|ИЗ
	|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
	|ГДЕ
	|	ОсновныеНачисленияРаботниковОрганизаций.ПериодДействия МЕЖДУ &ДатаНачала И &ДатаОкончания
	|	И ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации < &ТекущийПериод
	|	И (НЕ ОсновныеНачисленияРаботниковОрганизаций.Сторно)
	|	И ОсновныеНачисленияРаботниковОрганизаций.ВидРасчета В
	|			(ВЫБРАТЬ
	|				ВидыРасчета.Ссылка
	|			ИЗ
	|				ВТВидыРасчета КАК ВидыРасчета)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ДополнительныеНачисленияРаботниковОрганизаций.Регистратор,
	|	ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
	|	ДополнительныеНачисленияРаботниковОрганизаций.ДатаНачалаСобытия,
	|	ДополнительныеНачисленияРаботниковОрганизаций.ДатаНачалаСобытия,
	|	ДополнительныеНачисленияРаботниковОрганизаций.ОбособленноеПодразделение,
	|	ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета,
	|	ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета.ВидПособияСоциальногоСтрахования,
	|	NULL,
	|	NULL,
	|	NULL,
	|	ДополнительныеНачисленияРаботниковОрганизаций.Результат,
	|	ВЫБОР
	|		КОГДА ДополнительныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации.КодПоОКАТО <> """"""""
	|				И ДополнительныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации.РайонныйКоэффициентРФ > 1
	|			ТОГДА ДополнительныеНачисленияРаботниковОрганизаций.ПодразделениеОрганизации.РайонныйКоэффициентРФ
	|		КОГДА ДополнительныеНачисленияРаботниковОрганизаций.ОбособленноеПодразделение.РайонныйКоэффициентРФ > 1
	|			ТОГДА ДополнительныеНачисленияРаботниковОрганизаций.ОбособленноеПодразделение.РайонныйКоэффициентРФ
	|		ИНАЧЕ 1
	|	КОНЕЦ,
	|	ДополнительныеНачисленияРаботниковОрганизаций.НомерСтроки,
	|	НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ)
	|ИЗ
	|	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
	|ГДЕ
	|	ДополнительныеНачисленияРаботниковОрганизаций.ДатаНачалаСобытия МЕЖДУ &ДатаНачала И &ДатаОкончания
	|	И ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации < &ТекущийПериод
	|	И (НЕ ДополнительныеНачисленияРаботниковОрганизаций.Сторно)
	|	И ДополнительныеНачисленияРаботниковОрганизаций.ВидРасчета В
	|			(ВЫБРАТЬ
	|				ВидыРасчета.Ссылка
	|			ИЗ
	|				ВТВидыРасчета КАК ВидыРасчета)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Регистратор,
	|	НомерСтроки
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	НачислениеЗарплатыРаботникамОрганизаций.Ссылка КАК Документ,
	|	НачислениеЗарплатыРаботникамОрганизаций.ПерерассчитываемыйДокумент КАК ИсходныйДокумент
	|ПОМЕСТИТЬ ВТДокументыИсправления
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций КАК НачислениеЗарплатыРаботникамОрганизаций
	|ГДЕ
	|	НачислениеЗарплатыРаботникамОрганизаций.ПерерассчитываемыйДокумент В
	|			(ВЫБРАТЬ
	|				ДокументыКПерерасчету.Регистратор
	|			ИЗ
	|				ВТНачисленныеПособия КАК ДокументыКПерерасчету)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	РегистрацияРазовыхНачисленийРаботниковОрганизаций.Ссылка,
	|	РегистрацияРазовыхНачисленийРаботниковОрганизаций.ПерерассчитываемыйДокумент
	|ИЗ
	|	Документ.РегистрацияРазовыхНачисленийРаботниковОрганизаций КАК РегистрацияРазовыхНачисленийРаботниковОрганизаций
	|ГДЕ
	|	РегистрацияРазовыхНачисленийРаботниковОрганизаций.ПерерассчитываемыйДокумент В
	|			(ВЫБРАТЬ
	|				ДокументыКПерерасчету.Регистратор
	|			ИЗ
	|				ВТНачисленныеПособия КАК ДокументыКПерерасчету)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Сторнирование.Ссылка,
	|	Сторнирование.СторнируемыйДокумент
	|ИЗ
	|	Документ.Сторнирование КАК Сторнирование
	|ГДЕ
	|	Сторнирование.СторнируемыйДокумент В
	|			(ВЫБРАТЬ
	|				ДокументыКПерерасчету.Регистратор
	|			ИЗ
	|				ВТНачисленныеПособия КАК ДокументыКПерерасчету)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	НачислениеЕдиновременныхПособийЗаСчетФСС.Ссылка,
	|	НачислениеЕдиновременныхПособийЗаСчетФСС.ПерерассчитываемыйДокумент
	|ИЗ
	|	Документ.НачислениеЕдиновременныхПособийЗаСчетФСС КАК НачислениеЕдиновременныхПособийЗаСчетФСС
	|ГДЕ
	|	НачислениеЕдиновременныхПособийЗаСчетФСС.ПерерассчитываемыйДокумент В
	|			(ВЫБРАТЬ
	|				ДокументыКПерерасчету.Регистратор
	|			ИЗ
	|				ВТНачисленныеПособия КАК ДокументыКПерерасчету)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Документ
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ДокументыКПерерасчету.Регистратор,
	|	ПереносДанных.Ссылка КАК ВозможноеИсправление
	|ПОМЕСТИТЬ ВТПереносыИз77
	|ИЗ
	|	ВТНачисленныеПособия КАК ДокументыКПерерасчету
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПереносДанных КАК ПереносДанных
	|		ПО ДокументыКПерерасчету.ОбособленноеПодразделение = ПереносДанных.Организация
	|			И ДокументыКПерерасчету.ПериодРегистрации < ПереносДанных.ПериодРегистрации
	|ГДЕ
	|	ДокументыКПерерасчету.Регистратор ССЫЛКА Документ.ПереносДанных
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ВозможноеИсправление
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ДокументыИсправления.ИсходныйДокумент КАК Регистратор,
	|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник КАК Сотрудник
	|ПОМЕСТИТЬ ВТИсправленныеСтроки
	|ИЗ
	|	ВТДокументыИсправления КАК ДокументыИсправления
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
	|		ПО ДокументыИсправления.Документ = ОсновныеНачисленияРаботниковОрганизаций.Регистратор
	|ГДЕ
	|	ОсновныеНачисленияРаботниковОрганизаций.Сторно
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ДокументыИсправления.ИсходныйДокумент,
	|	ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник
	|ИЗ
	|	ВТДокументыИсправления КАК ДокументыИсправления
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
	|		ПО ДокументыИсправления.Документ = ДополнительныеНачисленияРаботниковОрганизаций.Регистратор
	|ГДЕ
	|	ДополнительныеНачисленияРаботниковОрганизаций.Сторно
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ДокументыКПерерасчету.Регистратор,
	|	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник
	|ИЗ
	|	ВТПереносыИз77 КАК ДокументыКПерерасчету
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
	|		ПО ДокументыКПерерасчету.Регистратор = ОсновныеНачисленияРаботниковОрганизаций.СторнируемыйДокумент
	|			И ДокументыКПерерасчету.ВозможноеИсправление = ОсновныеНачисленияРаботниковОрганизаций.Регистратор
	|ГДЕ
	|	ОсновныеНачисленияРаботниковОрганизаций.Сторно
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ДокументыКПерерасчету.Регистратор,
	|	ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник
	|ИЗ
	|	ВТПереносыИз77 КАК ДокументыКПерерасчету
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
	|		ПО ДокументыКПерерасчету.Регистратор = ДополнительныеНачисленияРаботниковОрганизаций.СторнируемыйДокумент
	|			И ДокументыКПерерасчету.ВозможноеИсправление = ДополнительныеНачисленияРаботниковОрганизаций.Регистратор
	|ГДЕ
	|	ДополнительныеНачисленияРаботниковОрганизаций.Сторно
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Регистратор,
	|	Сотрудник
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	НачисленныеПособия.Регистратор,
	|	НачисленныеПособия.НомерСтроки,
	|	НачисленныеПособия.Сотрудник,
	|	НачисленныеПособия.НачалоПериода КАК НачалоПериода,
	|	НачисленныеПособия.КонецПериода,
	|	НачисленныеПособия.ОбособленноеПодразделение,
	|	НачисленныеПособия.ВидРасчета,
	|	НачисленныеПособия.ВидПособия КАК ВидПособия,
	|	НачисленныеПособия.МесячноеПособие,
	|	НачисленныеПособия.КоличествоДетейВсего,
	|	НачисленныеПособия.КоличествоПервыхДетей,
	|	НачисленныеПособия.СуммаНачисленная,
	|	НачисленныеПособия.РайонныйКоэффициентРФОрганизации,
	|	НачисленныеПособия.ПериодРегистрации
	|ПОМЕСТИТЬ ВТПособияКПерерасчету
	|ИЗ
	|	ВТНачисленныеПособия КАК НачисленныеПособия
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТИсправленныеСтроки КАК ИсправленныеСтроки
	|		ПО НачисленныеПособия.Регистратор = ИсправленныеСтроки.Регистратор
	|			И НачисленныеПособия.Сотрудник = ИсправленныеСтроки.Сотрудник
	|ГДЕ
	|	ИсправленныеСтроки.Регистратор ЕСТЬ NULL 
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ВидПособия,
	|	НачалоПериода
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Пособия.Регистратор КАК Регистратор,
	|	Пособия.НомерСтроки КАК НомерСтроки,
	|	Пособия.Сотрудник,
	|	Пособия.НачалоПериода КАК НачалоПериода,
	|	Пособия.КонецПериода,
	|	Пособия.ОбособленноеПодразделение,
	|	Пособия.ВидРасчета,
	|	Пособия.ВидПособия,
	|	Пособия.МесячноеПособие,
	|	Пособия.КоличествоДетейВсего,
	|	Пособия.КоличествоПервыхДетей,
	|	Пособия.СуммаНачисленная,
	|	Пособия.РайонныйКоэффициентРФОрганизации,
	|	Пособия.ПериодРегистрации
	|ПОМЕСТИТЬ ВТПособияПоУходу
	|ИЗ
	|	ВТПособияКПерерасчету КАК Пособия
	|ГДЕ
	|	Пособия.ВидПособия = ЗНАЧЕНИЕ(Перечисление.ВидыПособийСоциальногоСтрахования.ПоУходуЗаРебенкомДоПолутораЛет)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Регистратор,
	|	НомерСтроки
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Пособия.Регистратор,
	|	Пособия.Сотрудник,
	|	Пособия.НачалоПериода КАК НачалоПериода,
	|	Пособия.КонецПериода,
	|	Пособия.ОбособленноеПодразделение,
	|	Пособия.ВидРасчета,
	|	Пособия.ВидПособия,
	|	ВЫБОР
	|		КОГДА Пособия.ВидПособия = ЗНАЧЕНИЕ(Перечисление.ВидыПособийСоциальногоСтрахования.ПриРожденииРебенка)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.РазмерыГосударственныхПособий.ПриРожденииРебенка)
	|		КОГДА Пособия.ВидПособия = ЗНАЧЕНИЕ(Перечисление.ВидыПособийСоциальногоСтрахования.ПриПостановкеНаУчетВРанниеСрокиБеременности)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.РазмерыГосударственныхПособий.ПриПостановкеНаУчетВРанниеСрокиБеременности)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ВидПособияДляРегистра,
	|	Пособия.СуммаНачисленная,
	|	Пособия.РайонныйКоэффициентРФОрганизации,
	|	Пособия.ПериодРегистрации
	|ПОМЕСТИТЬ ВТЕдиновременныеПособия
	|ИЗ
	|	ВТПособияКПерерасчету КАК Пособия
	|ГДЕ
	|	Пособия.ВидПособия <> ЗНАЧЕНИЕ(Перечисление.ВидыПособийСоциальногоСтрахования.ПоУходуЗаРебенкомДоПолутораЛет)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НачалоПериода,
	|	ВидПособияДляРегистра
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ДатыРегистра.НачалоПериода КАК НачалоПериода,
	|	ДатыРегистра.ВидПособияДляРегистра КАК ВидПособияДляРегистра,
	|	ГосударственныеПособия.Размер
	|ПОМЕСТИТЬ ВТРазмерыЕдиновременныхПособий
	|ИЗ
	|	(ВЫБРАТЬ
	|		ЕдиновременныеПособия.НачалоПериода КАК НачалоПериода,
	|		МАКСИМУМ(ГосударственныеПособия.Период) КАК Период,
	|		ЕдиновременныеПособия.ВидПособияДляРегистра КАК ВидПособияДляРегистра
	|	ИЗ
	|		ВТЕдиновременныеПособия КАК ЕдиновременныеПособия
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|			ПО ЕдиновременныеПособия.НачалоПериода >= ГосударственныеПособия.Период
	|				И ЕдиновременныеПособия.ВидПособияДляРегистра = ГосударственныеПособия.ВидПособия
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ЕдиновременныеПособия.НачалоПериода,
	|		ЕдиновременныеПособия.ВидПособияДляРегистра) КАК ДатыРегистра
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|		ПО ДатыРегистра.Период = ГосударственныеПособия.Период
	|			И ДатыРегистра.ВидПособияДляРегистра = ГосударственныеПособия.ВидПособия
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НачалоПериода,
	|	ВидПособияДляРегистра
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ДатыРегистра.НачалоПериода КАК НачалоПериода,
	|	ДатыРегистра.ВидПособияДляРегистра КАК ВидПособияДляРегистра,
	|	ГосударственныеПособия.Размер
	|ПОМЕСТИТЬ ВТРазмерыПособийПоУходу
	|ИЗ
	|	(ВЫБРАТЬ
	|		Пособия.НачалоПериода КАК НачалоПериода,
	|		МАКСИМУМ(ГосударственныеПособия.Период) КАК Период,
	|		ГосударственныеПособия.ВидПособия КАК ВидПособияДляРегистра
	|	ИЗ
	|		ВТПособияПоУходу КАК Пособия
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|			ПО Пособия.НачалоПериода >= ГосударственныеПособия.Период
	|				И (ГосударственныеПособия.ВидПособия В (ЗНАЧЕНИЕ(Перечисление.РазмерыГосударственныхПособий.МинимумПособияПоУходуЗаПервымРебенкомДоПолутораЛет), ЗНАЧЕНИЕ(Перечисление.РазмерыГосударственныхПособий.МинимумПособияПоУходуЗаПоследующимРебенкомДоПолутораЛет), ЗНАЧЕНИЕ(Перечисление.РазмерыГосударственныхПособий.МаксимумПособияПоУходуЗаРебенкомДоПолутораЛет)))
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Пособия.НачалоПериода,
	|		ГосударственныеПособия.ВидПособия) КАК ДатыРегистра
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|		ПО ДатыРегистра.Период = ГосударственныеПособия.Период
	|			И ДатыРегистра.ВидПособияДляРегистра = ГосударственныеПособия.ВидПособия
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НачалоПериода,
	|	ВидПособияДляРегистра
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ФактическийПериодДействия.НомерСтроки КАК НомерСтроки,
	|	ФактическийПериодДействия.Регистратор КАК Регистратор,
	|	СУММА(РАЗНОСТЬДАТ(ФактическийПериодДействия.ПериодДействияНачало, ДОБАВИТЬКДАТЕ(ФактическийПериодДействия.ПериодДействияКонец, СЕКУНДА, 1), ДЕНЬ)) КАК ОплачиватьДнейПособия
	|ПОМЕСТИТЬ ВТКалендарныеДниПособия
	|ИЗ
	|	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций.ФактическийПериодДействия(
	|			ВидРасчета В
	|					(ВЫБРАТЬ
	|						ВидыРасчета.Ссылка
	|					ИЗ
	|						ВТВидыРасчета КАК ВидыРасчета)
	|				И Регистратор В
	|					(ВЫБРАТЬ
	|						ДокументыКПерерасчету.Регистратор
	|					ИЗ
	|						ВТПособияПоУходу КАК ДокументыКПерерасчету)) КАК ФактическийПериодДействия
	|
	|СГРУППИРОВАТЬ ПО
	|	ФактическийПериодДействия.НомерСтроки,
	|	ФактическийПериодДействия.Регистратор
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Регистратор,
	|	НомерСтроки
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ИСТИНА КАК Отметка,
	|	ПособияПоУходу.ОбособленноеПодразделение КАК ОбособленноеПодразделение,
	|	ПособияПоУходу.Сотрудник КАК Сотрудник,
	|	ПособияПоУходу.ВидПособия КАК ВидПособия,
	|	ПособияПоУходу.НачалоПериода КАК ДатаНачала,
	|	ПособияПоУходу.КонецПериода КАК ДатаОкончания,
	|	ПособияПоУходу.СуммаНачисленная,
	|	ВЫБОР
	|		КОГДА ПособияПоУходу.КоличествоДетейВсего = 0
	|			ТОГДА 0
	|		КОГДА ГОД(ПособияПоУходу.НачалоПериода) >= 2010
	|			ТОГДА (ВЫРАЗИТЬ(ВЫБОР
	|						КОГДА ПособияПоУходу.МесячноеПособие < (МинимумЗаПервымРебенком.Размер * ПособияПоУходу.КоличествоПервыхДетей + МинимумЗаПоследующимРебенком.Размер * (ПособияПоУходу.КоличествоДетейВсего - ПособияПоУходу.КоличествоПервыхДетей)) * ПособияПоУходу.РайонныйКоэффициентРФОрганизации
	|							ТОГДА (МинимумЗаПервымРебенком.Размер * ПособияПоУходу.КоличествоПервыхДетей + МинимумЗаПоследующимРебенком.Размер * (ПособияПоУходу.КоличествоДетейВсего - ПособияПоУходу.КоличествоПервыхДетей)) * ПособияПоУходу.РайонныйКоэффициентРФОрганизации
	|						ИНАЧЕ ПособияПоУходу.МесячноеПособие
	|					КОНЕЦ * ВЫБОР
	|						КОГДА КалендарныеДниПособия.ОплачиватьДнейПособия = ДЕНЬ(КОНЕЦПЕРИОДА(ПособияПоУходу.КонецПериода, МЕСЯЦ))
	|							ТОГДА 1
	|						ИНАЧЕ КалендарныеДниПособия.ОплачиватьДнейПособия / ДЕНЬ(КОНЕЦПЕРИОДА(ПособияПоУходу.КонецПериода, МЕСЯЦ))
	|					КОНЕЦ КАК ЧИСЛО(15, 2))) - ПособияПоУходу.СуммаНачисленная
	|		ИНАЧЕ (ВЫРАЗИТЬ(ВЫБОР
	|					КОГДА ПособияПоУходу.МесячноеПособие > МаксимумПособия.Размер * ПособияПоУходу.КоличествоДетейВсего * ПособияПоУходу.РайонныйКоэффициентРФОрганизации
	|						ТОГДА МаксимумПособия.Размер * ПособияПоУходу.КоличествоДетейВсего * ПособияПоУходу.РайонныйКоэффициентРФОрганизации
	|					КОГДА ПособияПоУходу.МесячноеПособие < (МинимумЗаПервымРебенком.Размер * ПособияПоУходу.КоличествоПервыхДетей + МинимумЗаПоследующимРебенком.Размер * (ПособияПоУходу.КоличествоДетейВсего - ПособияПоУходу.КоличествоПервыхДетей)) * ПособияПоУходу.РайонныйКоэффициентРФОрганизации
	|						ТОГДА (МинимумЗаПервымРебенком.Размер * ПособияПоУходу.КоличествоПервыхДетей + МинимумЗаПоследующимРебенком.Размер * (ПособияПоУходу.КоличествоДетейВсего - ПособияПоУходу.КоличествоПервыхДетей)) * ПособияПоУходу.РайонныйКоэффициентРФОрганизации
	|					ИНАЧЕ ПособияПоУходу.МесячноеПособие
	|				КОНЕЦ * ВЫБОР
	|					КОГДА КалендарныеДниПособия.ОплачиватьДнейПособия = ДЕНЬ(КОНЕЦПЕРИОДА(ПособияПоУходу.КонецПериода, МЕСЯЦ))
	|						ТОГДА 1
	|					ИНАЧЕ КалендарныеДниПособия.ОплачиватьДнейПособия / ДЕНЬ(КОНЕЦПЕРИОДА(ПособияПоУходу.КонецПериода, МЕСЯЦ))
	|				КОНЕЦ КАК ЧИСЛО(15, 2))) - ПособияПоУходу.СуммаНачисленная
	|	КОНЕЦ КАК СуммаКДоначислению,
	|	ПособияПоУходу.Сотрудник.Физлицо КАК Физлицо,
	|	ПособияПоУходу.Регистратор,
	|	ПособияПоУходу.ОбособленноеПодразделение.Наименование КАК НаименованиеОбособленногоПодразделения,
	|	ПособияПоУходу.Сотрудник.Наименование КАК СотрудникНаименование,
	|	ПособияПоУходу.ВидРасчета,
	|	ПособияПоУходу.ПериодРегистрации
	|ИЗ
	|	ВТПособияПоУходу КАК ПособияПоУходу
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТРазмерыПособийПоУходу КАК МинимумЗаПервымРебенком
	|		ПО ПособияПоУходу.НачалоПериода = МинимумЗаПервымРебенком.НачалоПериода
	|			И (МинимумЗаПервымРебенком.ВидПособияДляРегистра = ЗНАЧЕНИЕ(Перечисление.РазмерыГосударственныхПособий.МинимумПособияПоУходуЗаПервымРебенкомДоПолутораЛет))
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТРазмерыПособийПоУходу КАК МинимумЗаПоследующимРебенком
	|		ПО ПособияПоУходу.НачалоПериода = МинимумЗаПоследующимРебенком.НачалоПериода
	|			И (МинимумЗаПоследующимРебенком.ВидПособияДляРегистра = ЗНАЧЕНИЕ(Перечисление.РазмерыГосударственныхПособий.МинимумПособияПоУходуЗаПоследующимРебенкомДоПолутораЛет))
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТРазмерыПособийПоУходу КАК МаксимумПособия
	|		ПО ПособияПоУходу.НачалоПериода = МаксимумПособия.НачалоПериода
	|			И (МаксимумПособия.ВидПособияДляРегистра = ЗНАЧЕНИЕ(Перечисление.РазмерыГосударственныхПособий.МаксимумПособияПоУходуЗаРебенкомДоПолутораЛет))
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТКалендарныеДниПособия КАК КалендарныеДниПособия
	|		ПО ПособияПоУходу.Регистратор = КалендарныеДниПособия.Регистратор
	|			И ПособияПоУходу.НомерСтроки = КалендарныеДниПособия.НомерСтроки
	|ГДЕ
	|	ВЫБОР
	|			КОГДА ПособияПоУходу.КоличествоДетейВсего = 0
	|				ТОГДА 0
	|			ИНАЧЕ (ВЫРАЗИТЬ(ВЫБОР
	|						КОГДА ПособияПоУходу.МесячноеПособие > МаксимумПособия.Размер * ПособияПоУходу.КоличествоДетейВсего * ПособияПоУходу.РайонныйКоэффициентРФОрганизации
	|							ТОГДА МаксимумПособия.Размер * ПособияПоУходу.КоличествоДетейВсего * ПособияПоУходу.РайонныйКоэффициентРФОрганизации
	|						КОГДА ПособияПоУходу.МесячноеПособие < (МинимумЗаПервымРебенком.Размер * ПособияПоУходу.КоличествоПервыхДетей + МинимумЗаПоследующимРебенком.Размер * (ПособияПоУходу.КоличествоДетейВсего - ПособияПоУходу.КоличествоПервыхДетей)) * ПособияПоУходу.РайонныйКоэффициентРФОрганизации
	|							ТОГДА (МинимумЗаПервымРебенком.Размер * ПособияПоУходу.КоличествоПервыхДетей + МинимумЗаПоследующимРебенком.Размер * (ПособияПоУходу.КоличествоДетейВсего - ПособияПоУходу.КоличествоПервыхДетей)) * ПособияПоУходу.РайонныйКоэффициентРФОрганизации
	|						ИНАЧЕ ПособияПоУходу.МесячноеПособие
	|					КОНЕЦ * ВЫБОР
	|						КОГДА КалендарныеДниПособия.ОплачиватьДнейПособия = ДЕНЬ(КОНЕЦПЕРИОДА(ПособияПоУходу.КонецПериода, МЕСЯЦ))
	|							ТОГДА 1
	|						ИНАЧЕ КалендарныеДниПособия.ОплачиватьДнейПособия / ДЕНЬ(КОНЕЦПЕРИОДА(ПособияПоУходу.КонецПериода, МЕСЯЦ))
	|					КОНЕЦ КАК ЧИСЛО(15, 2))) - ПособияПоУходу.СуммаНачисленная
	|		КОНЕЦ <> 0
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ИСТИНА,
	|	ЕдиновременныеПособия.ОбособленноеПодразделение,
	|	ЕдиновременныеПособия.Сотрудник,
	|	ЕдиновременныеПособия.ВидПособия,
	|	ЕдиновременныеПособия.НачалоПериода,
	|	ЕдиновременныеПособия.КонецПериода,
	|	ЕдиновременныеПособия.СуммаНачисленная,
	|	РазмерыЕдиновременныхПособий.Размер * ЕдиновременныеПособия.РайонныйКоэффициентРФОрганизации - ЕдиновременныеПособия.СуммаНачисленная,
	|	ЕдиновременныеПособия.Сотрудник.Физлицо,
	|	ЕдиновременныеПособия.Регистратор,
	|	ЕдиновременныеПособия.ОбособленноеПодразделение.Наименование,
	|	ЕдиновременныеПособия.Сотрудник.Наименование,
	|	ЕдиновременныеПособия.ВидРасчета,
	|	ЕдиновременныеПособия.ПериодРегистрации
	|ИЗ
	|	ВТЕдиновременныеПособия КАК ЕдиновременныеПособия
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТРазмерыЕдиновременныхПособий КАК РазмерыЕдиновременныхПособий
	|		ПО ЕдиновременныеПособия.ВидПособияДляРегистра = РазмерыЕдиновременныхПособий.ВидПособияДляРегистра
	|			И ЕдиновременныеПособия.НачалоПериода = РазмерыЕдиновременныхПособий.НачалоПериода
	|ГДЕ
	|	РазмерыЕдиновременныхПособий.Размер * ЕдиновременныеПособия.РайонныйКоэффициентРФОрганизации - ЕдиновременныеПособия.СуммаНачисленная <> 0
	|
	|УПОРЯДОЧИТЬ ПО
	|	ОбособленноеПодразделение,
	|	СотрудникНаименование,
	|	Сотрудник,
	|	ВидПособия,
	|	ДатаНачала";
	
	ПолучателиПособий.Загрузить(Запрос.Выполнить().Выгрузить());
	
КонецПроцедуры

Функция ОпределитьНачальнуюДатуИндексации() Экспорт

	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("МассивПособий", МассивПособий);
	Запрос.УстановитьПараметр("ДатаНачалаИндексации", '20080101');
	Запрос.УстановитьПараметр("НовыеРазмеры", РазмерыПособий.Выгрузить());
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	ГосударственныеПособия.ВидПособия КАК ВидПособия,
	|	ГосударственныеПособия.Период КАК Период,
	|	ГосударственныеПособия.Размер
	|ПОМЕСТИТЬ ВТНовыеРазмеры
	|ИЗ
	|	&НовыеРазмеры КАК ГосударственныеПособия
	|ГДЕ
	|	ГосударственныеПособия.Период >= &ДатаНачалаИндексации
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Период,
	|	ВидПособия
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ГосударственныеПособия.ВидПособия КАК ВидПособия,
	|	ГосударственныеПособия.Период КАК Период,
	|	ГосударственныеПособия.Размер
	|ПОМЕСТИТЬ ВТСтарыеРазмеры
	|ИЗ
	|	РегистрСведений.ГосударственныеПособия КАК ГосударственныеПособия
	|ГДЕ
	|	ГосударственныеПособия.ВидПособия В(&МассивПособий)
	|	И ГосударственныеПособия.Период >= &ДатаНачалаИндексации
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Период,
	|	ВидПособия
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТСтарыеРазмеры.Период КАК Период,
	|	ВТСтарыеРазмеры.ВидПособия КАК ВидПособия,
	|	ВТНовыеРазмеры.Размер КАК НовыйРазмер,
	|	ВТСтарыеРазмеры.Размер КАК СтарыйРазмер
	|ПОМЕСТИТЬ ВТОбщиеДанные
	|ИЗ
	|	ВТСтарыеРазмеры КАК ВТСтарыеРазмеры
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТНовыеРазмеры КАК ВТНовыеРазмеры
	|		ПО ВТСтарыеРазмеры.ВидПособия = ВТНовыеРазмеры.ВидПособия
	|			И ВТСтарыеРазмеры.Период = ВТНовыеРазмеры.Период
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Период,
	|	ВидПособия
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ЕСТЬNULL(МИНИМУМ(ДатыРазличий.Период), ДАТАВРЕМЯ(1, 1, 1)) КАК НачальнаяДата
	|ИЗ
	|	(ВЫБРАТЬ
	|		ОбщиеДанные.Период КАК Период
	|	ИЗ
	|		ВТОбщиеДанные КАК ОбщиеДанные
	|	ГДЕ
	|		ОбщиеДанные.НовыйРазмер <> ОбщиеДанные.СтарыйРазмер
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		НовыеРазмеры.Период
	|	ИЗ
	|		ВТНовыеРазмеры КАК НовыеРазмеры
	|			ЛЕВОЕ СОЕДИНЕНИЕ ВТОбщиеДанные КАК ОбщиеДанные
	|			ПО НовыеРазмеры.ВидПособия = ОбщиеДанные.ВидПособия
	|				И НовыеРазмеры.Период = ОбщиеДанные.Период
	|	ГДЕ
	|		ОбщиеДанные.Период ЕСТЬ NULL 
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		СтарыеРазмеры.Период
	|	ИЗ
	|		ВТСтарыеРазмеры КАК СтарыеРазмеры
	|			ЛЕВОЕ СОЕДИНЕНИЕ ВТОбщиеДанные КАК ОбщиеДанные
	|			ПО СтарыеРазмеры.ВидПособия = ОбщиеДанные.ВидПособия
	|				И СтарыеРазмеры.Период = ОбщиеДанные.Период
	|	ГДЕ
	|		ОбщиеДанные.Период ЕСТЬ NULL ) КАК ДатыРазличий";
	
	НачальнаяДата = '00010101';
	Выборка = Запрос.Выполнить().Выбрать();
	Если Выборка.Следующий() Тогда
		НачальнаяДата = Выборка.НачальнаяДата
	КонецЕсли;
	
	Возврат НачальнаяДата

КонецФункции // ОбновитьРазмерыПособий()

////////////////////////////////////////////////////////////////////////////////
// ИНИЦИАЛИЗАЦИЯ ОБЪЕКТА 

МассивПособий = Новый Массив;
МассивПособий.Добавить(Перечисления.РазмерыГосударственныхПособий.МинимумПособияПоУходуЗаПервымРебенкомДоПолутораЛет);	
МассивПособий.Добавить(Перечисления.РазмерыГосударственныхПособий.МинимумПособияПоУходуЗаПоследующимРебенкомДоПолутораЛет);
МассивПособий.Добавить(Перечисления.РазмерыГосударственныхПособий.МаксимумПособияПоУходуЗаРебенкомДоПолутораЛет);
МассивПособий.Добавить(Перечисления.РазмерыГосударственныхПособий.ПриРожденииРебенка);
МассивПособий.Добавить(Перечисления.РазмерыГосударственныхПособий.ПриПостановкеНаУчетВРанниеСрокиБеременности);

