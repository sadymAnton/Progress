<?xml version="1.0" encoding="UTF-8"?>
<DataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema" xmlns:dcscom="http://v8.1c.ru/8.1/data-composition-system/common" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataSource>
		<name>ИсточникДанных1</name>
		<dataSourceType>Local</dataSourceType>
	</dataSource>
	<dataSet xsi:type="DataSetUnion">
		<name>Астор</name>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Резерв_РасходнаяНакладная_СчетФактура</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докРезерв.Ссылка КАК PORDERS,
	докРезерв.Ссылка КАК ORDERS,
	докРезерв.Ссылка КАК ORDRSP,
	докРасходнаяНакладная.Ссылка КАК DESADV,
	докРасходнаяНакладная.Ссылка КАК RECADV,
	докСчетФактураСостав.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактура.Состав КАК докСчетФактураСостав
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РасходнаяНакладная КАК докРасходнаяНакладная
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.Резерв КАК докРезерв
				ПО докРасходнаяНакладная.ДокОснование = докРезерв.Ссылка}
			ПО докСчетФактураСостав.Основание = докРасходнаяНакладная.Ссылка}
		ПО (ИСТИНА)}</query>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_</name>
					<item xsi:type="DataSetQuery">
						<name>Резерв</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query> ВЫБРАТЬ
	РезервСостав.Номенклатура,
	РезервСостав.Характеристика как ХарактеристикаНоменклатуры,
	РезервСостав.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РезервСостав.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	РезервСостав.Цена,
	РезервСостав.СтавкаНДС,
	РезервСостав.Количество КАК Количество,
	РезервСостав.Сумма КАК Сумма,
	РезервСостав.СуммаНДС КАК СуммаНДС
ИЗ
	Документ.Резерв.Состав КАК РезервСостав
ГДЕ
	РезервСостав.Ссылка в (&amp;Ссылка)</query>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_DESADV_</name>
					<item xsi:type="DataSetQuery">
						<name>РасходнаяНакладная</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РасходнаяНакладнаяСостав.НомерСтроки,
	РасходнаяНакладнаяСостав.Номенклатура,
	РасходнаяНакладнаяСостав.ХарактеристикаПартия КАК ХарактеристикаНоменклатуры,
	РасходнаяНакладнаяСостав.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РасходнаяНакладнаяСостав.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	РасходнаяНакладнаяСостав.Номенклатура.Наименование КАК Наименование,
	РасходнаяНакладнаяСостав.Номенклатура.НаименованиеДляПечати КАК НаименованиеПолное,
	РасходнаяНакладнаяСостав.Цена,
	РасходнаяНакладнаяСостав.СтавкаНДС,
	Неопределено КАК СерияНоменклатуры,
	РасходнаяНакладнаяСостав.Номенклатура.СтранаПроисхождения КАК Страна,
	Неопределено КАК НомерГТД,
	РасходнаяНакладнаяСостав.Количество КАК Количество,
	РасходнаяНакладнаяСостав.Сумма КАК Сумма,
	РасходнаяНакладнаяСостав.СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.РасходнаяНакладная.Состав КАК РасходнаяНакладнаяСостав
ГДЕ
	РасходнаяНакладнаяСостав.Ссылка в (&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратнаяНакладнаяСостав.Номенклатура,
	ВозвратнаяНакладнаяСостав.ХарактеристикаПартия,
	ВозвратнаяНакладнаяСостав.ЕдиницаИзмерения,
	ВозвратнаяНакладнаяСостав.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВозвратнаяНакладнаяСостав.Номенклатура.Наименование,
	ВозвратнаяНакладнаяСостав.Номенклатура.НаименованиеДляПечати,
	ВозвратнаяНакладнаяСостав.Цена,
	ВозвратнаяНакладнаяСостав.СтавкаНДС,
	Неопределено КАК СерияНоменклатуры, 
	ВозвратнаяНакладнаяСостав.Номенклатура.СтранаПроисхождения,
	Неопределено КАК НомерГТД,
	-ВозвратнаяНакладнаяСостав.Количество,
	-ВозвратнаяНакладнаяСостав.Сумма,
	-ВозвратнаяНакладнаяСостав.СуммаНДС,
	NULL
ИЗ
	Документ.ВозвратнаяНакладная.Состав КАК ВозвратнаяНакладнаяСостав
ГДЕ
	ВозвратнаяНакладнаяСостав.Ссылка В(&amp;Возвраты)</query>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>СчетФактура</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	СчетФактураСостав.НомерСтроки,
	СчетФактураСостав.Номенклатура,
	СчетФактураСостав.Характеристика КАК ХарактеристикаНоменклатуры,
	СчетФактураСостав.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	СчетФактураСостав.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	СчетФактураСостав.Номенклатура.Наименование КАК Наименование,
	СчетФактураСостав.Номенклатура.НаименованиеДляПечати КАК НаименованиеПолное,
	СчетФактураСостав.Цена,
	СчетФактураСостав.СтавкаНДС,
	Неопределено КАК СерияНоменклатуры,
	СчетФактураСостав.Страна КАК Страна,
	СчетФактураСостав.НомерГТД КАК НомерГТД,
	СчетФактураСостав.Количество КАК Количество,
	СчетФактураСостав.Всего КАК Сумма,
	СчетФактураСостав.СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.СчетФактура.Состав КАК СчетФактураСостав
ГДЕ
	СчетФактураСостав.Ссылка в (&amp;Ссылка)</query>
					</item>
				</item>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_ПриходнаяНакладная_РегистрацияСФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	Заказ.Ссылка КАК PORDERS,
	Заказ.Ссылка КАК ORDERS,
	Заказ.Ссылка КАК ORDRSP,
	ПриходнаяНакладная.Ссылка КАК DESADV,
	ПриходнаяНакладная.Ссылка КАК RECADV,
	РегистрацияСчетаФактурыСоставНДС.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РегистрацияСчетаФактуры.СоставНДС КАК РегистрацияСчетаФактурыСоставНДС
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ПриходнаяНакладная КАК ПриходнаяНакладная
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.Заказ КАК Заказ
				ПО (Заказ.Ссылка В
						(ВЫБРАТЬ
							РегистрСведений.ЗакрытиеЗаказов.ПоДокументу
						ИЗ
							РегистрСведений.ЗакрытиеЗаказов
						ГДЕ
							РегистрСведений.ЗакрытиеЗаказов.ДокументЗакрытия = ПриходнаяНакладная.Ссылка))}
			ПО РегистрацияСчетаФактурыСоставНДС.Основание = ПриходнаяНакладная.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_ORDERS_</name>
					<item xsi:type="DataSetQuery">
						<name>Заказ</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	Товары.Номенклатура
ПОМЕСТИТЬ Товары
ИЗ
	Документ.Заказ.Состав КАК Товары
ГДЕ
	Товары.Ссылка = &amp;Ссылка
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЗаказТовары.Номенклатура.Код КАК КодТовараПокупателя,
	ЗаказТовары.Номенклатура,
	ЗаказТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ЗаказТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ЗаказТовары.Номенклатура.Наименование КАК Наименование,
	ЗаказТовары.Цена,
	ЕСТЬNULL(СтавкаНДССрезПоследних.СтавкаНДС, ЗНАЧЕНИЕ(Справочник.СтавкиНДС.)) КАК СтавкаНДС,
	СУММА(ЗаказТовары.Количество) КАК Количество,
	СУММА(ЗаказТовары.Сумма) КАК Сумма,
	Неопределено КАК СуммаНДС
ИЗ
	Документ.Заказ.Состав КАК ЗаказТовары
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СтавкаНДС.СрезПоследних(
				,
				Номенклатура В
					(ВЫБРАТЬ
						Товары.Номенклатура
					ИЗ
						Товары)) КАК СтавкаНДССрезПоследних
		ПО ЗаказТовары.Номенклатура = СтавкаНДССрезПоследних.Номенклатура
ГДЕ
	ЗаказТовары.Ссылка = &amp;Ссылка

СГРУППИРОВАТЬ ПО
	ЗаказТовары.Номенклатура,
	ЗаказТовары.Характеристика,
	ЗаказТовары.ЕдиницаИзмерения,
	ЗаказТовары.Цена,
	ЗаказТовары.Номенклатура.Наименование,
	ЗаказТовары.Номенклатура.Код,
	ЕСТЬNULL(СтавкаНДССрезПоследних.СтавкаНДС, ЗНАЧЕНИЕ(Справочник.СтавкиНДС.))</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RECADV_</name>
					<item xsi:type="DataSetQuery">
						<name>ПриходнаяНакладная</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПриходнаяНакладнаяСостав.Номенклатура,
	ВЫРАЗИТЬ(ПриходнаяНакладнаяСостав.ХарактеристикаПартия КАК Справочник.ХарактеристикиНоменклатуры) КАК ХарактеристикаНоменклатуры,
	ПриходнаяНакладнаяСостав.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ПриходнаяНакладнаяСостав.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ПриходнаяНакладнаяСостав.Номенклатура.Наименование КАК Наименование,
	ПриходнаяНакладнаяСостав.Количество КАК Количество,
	ПриходнаяНакладнаяСостав.Цена,
	ПриходнаяНакладнаяСостав.СтавкаНДС,
	ПриходнаяНакладнаяСостав.Сумма,
	ПриходнаяНакладнаяСостав.СуммаНДС
ИЗ
	Документ.ПриходнаяНакладная.Состав КАК ПриходнаяНакладнаяСостав
ГДЕ
	ПриходнаяНакладнаяСостав.Ссылка = &amp;Ссылка</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТоварыEDIВ1С</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ТабТоваров.GTIN КАК GTIN,
	ТабТоваров.КодТовараСторонний КАК КодТовараСторонний,
	ТабТоваров.КодТовараСвой КАК КодТовараСвой,
	ТабСоответствий_КонтурEDI.Номенклатура КАК Номенклатура,
	ТабСоответствий_КонтурEDI.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ТабСоответствий_КонтурEDI.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	3 КАК Приоритет
ПОМЕСТИТЬ ВТ_НайденныеСоответствия
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТабСоответствий_КонтурEDI КАК ТабСоответствий_КонтурEDI
		ПО ТабТоваров.GTIN = ТабСоответствий_КонтурEDI.GTIN
			И ТабТоваров.КодТовараСторонний = ТабСоответствий_КонтурEDI.КодТовараСторонний
			И ТабТоваров.КодТовараСвой = ТабСоответствий_КонтурEDI.КодТовараСвой

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	СправочникНоменклатура.Ссылка,
	НЕОПРЕДЕЛЕНО,
	СправочникЕдиницыИзмерения.Ссылка,
	2
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК СправочникНоменклатура
		ПО ТабТоваров.КодТовараСвой = СправочникНоменклатура.Код
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ЕдиницыИзмерения КАК СправочникЕдиницыИзмерения
		ПО СправочникНоменклатура.Ссылка = СправочникЕдиницыИзмерения.Владелец
		И СправочникНоменклатура.БазоваяЕдиницаИзмерения = СправочникЕдиницыИзмерения.ЕдиницаПоКлассификатору 
ГДЕ
	(НЕ ТабТоваров.КодТовараСвой = "")

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	Штрихкоды.Номенклатура,
	Штрихкоды.ХарактеристикаПартия,
	Штрихкоды.ЕдиницаИзмерения,
	1
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ШтриховыеКоды КАК Штрихкоды
		ПО (ПОДСТРОКА(ТабТоваров.GTIN, 2, 13) = Штрихкоды.Штрихкод)
ГДЕ
	(НЕ ТабТоваров.GTIN = "")</query>
				<autoFillFields>false</autoFillFields>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТовары1СВEDIВ_GTIN</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ РАЗЛИЧНЫЕ
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ТабТоваров.Номенклатура.Код КАК КодТовараСвой,
	ВЫРАЗИТЬ(Штрихкоды.Штрихкод КАК СТРОКА(14)) КАК GTIN
ПОМЕСТИТЬ ВТШтрихкодыТоваров
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ШтриховыеКоды КАК Штрихкоды
		ПО ТабТоваров.Номенклатура = Штрихкоды.Номенклатура
			//И ТабТоваров.ХарактеристикаНоменклатуры = Штрихкоды.ХарактеристикаПартия
			И ТабТоваров.ЕдиницаИзмерения = Штрихкоды.ЕдиницаИзмерения
ГДЕ
	&amp;ИскатьТоварПоШК

ИНДЕКСИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	//ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения</query>
				<autoFillFields>false</autoFillFields>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>БП_16</name>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
			ПО (СчетФактураВыданный.ДокументОснование = РеализацияТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	РеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_</name>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения.Наименование КАК КодЕдиницыИзмерения,
	РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	Неопределено КАК ХарактеристикаНоменклатуры,
	Неопределено КАК СерияНоменклатуры,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СтранаПроисхождения КАК Страна,
	РеализацияТоваровУслугТовары.НомерГТД КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС КАК СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугВозвратнаяТара.НомерСтроки,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.Наименование,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НаименованиеПолное,
	Неопределено,
	Неопределено,
	РеализацияТоваровУслугВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.НДС0),
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НомерГТД,
	РеализацияТоваровУслугВозвратнаяТара.Количество,
	РеализацияТоваровУслугВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.РеализацияТоваровУслуг.ВозвратнаяТара КАК РеализацияТоваровУслугВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И РеализацияТоваровУслугВозвратнаяТара.Ссылка В(&amp;Ссылка)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_DESADV_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения.Наименование КАК КодЕдиницыИзмерения,
	РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	Неопределено КАК ХарактеристикаНоменклатуры,
	Неопределено КАК СерияНоменклатуры,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СтранаПроисхождения КАК Страна,
	РеализацияТоваровУслугТовары.НомерГТД КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС КАК СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.БазоваяЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное,
	Неопределено,
	Неопределено,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	ВозвратТоваровОтПокупателяТовары.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяТовары.НомерГТД,
	-ВозвратТоваровОтПокупателяТовары.Количество,
	-ВозвратТоваровОтПокупателяТовары.Сумма,
	-ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	NULL
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугВозвратнаяТара.НомерСтроки,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.Наименование,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НаименованиеПолное,
	Неопределено,
	Неопределено,
	РеализацияТоваровУслугВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НомерГТД,
	РеализацияТоваровУслугВозвратнаяТара.Количество,
	РеализацияТоваровУслугВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.РеализацияТоваровУслуг.ВозвратнаяТара КАК РеализацияТоваровУслугВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И РеализацияТоваровУслугВозвратнаяТара.Ссылка В(&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.Наименование,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НаименованиеПолное,
	Неопределено,
	Неопределено,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.НДС0),
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НомерГТД,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Количество,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.ВозвратТоваровОтПокупателя.ВозвратнаяТара КАК ВозвратТоваровОтПокупателяВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И ВозвратТоваровОтПокупателяВозвратнаяТара.Ссылка В(&amp;Возвраты)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>БП_20</name>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
			ПО (СчетФактураВыданный.ДокументОснование = РеализацияТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	РеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Счет_Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докСчетНаОплатуПокупателю.Ссылка КАК PORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетНаОплатуПокупателю КАК докСчетНаОплатуПокупателю
				ПО докРеализацияТоваровУслуг.СчетНаОплатуПокупателю = докСчетНаОплатуПокупателю.Ссылка}
			ПО (СчетФактураВыданный.ДокументОснование = докРеализацияТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Счет_Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докСчетНаОплатуПокупателю.Ссылка КАК PORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	докРеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетНаОплатуПокупателю КАК докСчетНаОплатуПокупателю
			ПО докРеализацияТоваровУслуг.СчетНаОплатуПокупателю = докСчетНаОплатуПокупателю.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_</name>
					<item xsi:type="DataSetQuery">
						<name>СчетНаОплатуПокупателю</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	СчетНаОплатуПокупателю.Номенклатура,
	Неопределено КАК ХарактеристикаНоменклатуры,
	СчетНаОплатуПокупателю.Номенклатура.БазоваяЕдиницаИзмерения КАК ЕдиницаИзмерения,
	СчетНаОплатуПокупателю.Номенклатура.БазоваяЕдиницаИзмерения.Наименование КАК КодЕдиницыИзмерения,
	СчетНаОплатуПокупателю.Цена,
	СчетНаОплатуПокупателю.СтавкаНДС,
	СчетНаОплатуПокупателю.Количество КАК Количество,
	СчетНаОплатуПокупателю.Сумма КАК Сумма,
	СчетНаОплатуПокупателю.СуммаНДС КАК СуммаНДС
ИЗ
	Документ.СчетНаОплатуПокупателю.Товары КАК СчетНаОплатуПокупателю
ГДЕ
	СчетНаОплатуПокупателю.Ссылка В(&amp;Ссылка)</query>
						<autoFillFields>false</autoFillFields>
					</item>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения.Наименование КАК КодЕдиницыИзмерения,
	РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	Неопределено КАК ХарактеристикаНоменклатуры,
	Неопределено КАК СерияНоменклатуры,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СтранаПроисхождения КАК Страна,
	РеализацияТоваровУслугТовары.НомерГТД КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС КАК СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В (&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугВозвратнаяТара.НомерСтроки,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.Наименование,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НаименованиеПолное,
	Неопределено,
	Неопределено КАК СерияНоменклатуры,
	РеализацияТоваровУслугВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НомерГТД,
	РеализацияТоваровУслугВозвратнаяТара.Количество,
	РеализацияТоваровУслугВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.РеализацияТоваровУслуг.ВозвратнаяТара КАК РеализацияТоваровУслугВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И РеализацияТоваровУслугВозвратнаяТара.Ссылка В (&amp;Ссылка)

</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_DESADV_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения.Наименование КАК КодЕдиницыИзмерения,
	РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	Неопределено КАК ХарактеристикаНоменклатуры,
	Неопределено КАК СерияНоменклатуры,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СтранаПроисхождения КАК Страна,
	РеализацияТоваровУслугТовары.НомерГТД КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС КАК СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В (&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.БазоваяЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное,
	Неопределено,
	Неопределено КАК СерияНоменклатуры,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	ВозвратТоваровОтПокупателяТовары.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяТовары.НомерГТД,
	-ВозвратТоваровОтПокупателяТовары.Количество,
	-ВозвратТоваровОтПокупателяТовары.Сумма,
	-ВозвратТоваровОтПокупателяТовары.СуммаНДС КАК СуммаНДС,
	NULL
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугВозвратнаяТара.НомерСтроки,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.Наименование,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НаименованиеПолное,
	Неопределено,
	Неопределено КАК СерияНоменклатуры,
	РеализацияТоваровУслугВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НомерГТД,
	РеализацияТоваровУслугВозвратнаяТара.Количество,
	РеализацияТоваровУслугВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.РеализацияТоваровУслуг.ВозвратнаяТара КАК РеализацияТоваровУслугВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И РеализацияТоваровУслугВозвратнаяТара.Ссылка В (&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.Наименование,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НаименованиеПолное,
	Неопределено,
	Неопределено КАК СерияНоменклатуры,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.НДС0),
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НомерГТД,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Количество,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.ВозвратТоваровОтПокупателя.ВозвратнаяТара КАК ВозвратТоваровОтПокупателяВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И ВозвратТоваровОтПокупателяВозвратнаяТара.Ссылка В(&amp;Возвраты)
</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RETINS_RETREC_</name>
					<item xsi:type="DataSetQuery">
						<name>ВозвратТоваровОтПокупателя</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ВозвратТоваровОтПокупателяТовары.НомерСтроки,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	Неопределено КАК ХарактеристикаНоменклатуры,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.БазоваяЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.БазоваяЕдиницаИзмерения.Код КАК КодЕдиницыИзмерения,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование КАК Наименование,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	Неопределено КАК СерияНоменклатуры,
	ВЫБОР
		КОГДА ВозвратТоваровОтПокупателяТовары.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка)
			ТОГДА ВозвратТоваровОтПокупателяТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ ВозвратТоваровОтПокупателяТовары.СтранаПроисхождения
	КОНЕЦ КАК Страна,
	ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.НомерГТД.Код, ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.Номенклатура.НомерГТД.Код, "")) КАК НомерГТД,
	ВозвратТоваровОтПокупателяТовары.Количество,
	ВозвратТоваровОтПокупателяТовары.Сумма,
	ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Ссылка)</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.НомерСтроки,
	ПоступлениеТоваровУслугТовары.Номенклатура,
	Неопределено КАК ХарактеристикаНоменклатуры,
	ПоступлениеТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ПоступлениеТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения.Код КАК КодЕдиницыИзмерения,
	ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	ПоступлениеТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	Неопределено КАК СерияНоменклатуры,
	ВЫБОР
		КОГДА ПоступлениеТоваровУслугТовары.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка)
			ТОГДА ПоступлениеТоваровУслугТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ ПоступлениеТоваровУслугТовары.СтранаПроисхождения
	КОНЕЦ КАК Страна,
	ЕСТЬNULL(ПоступлениеТоваровУслугТовары.НомерГТД.Код, ЕСТЬNULL(ПоступлениеТоваровУслугТовары.Номенклатура.НомерГТД.Код, "")) КАК НомерГТД,
	ПоступлениеТоваровУслугТовары.Количество,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка В(&amp;Ссылка)</query>
					</item>
				</item>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>БСХП_20</name>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
			ПО (СчетФактураВыданный.ДокументОснование = РеализацияТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	РеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Счет_Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докСчетНаОплатуПокупателю.Ссылка КАК PORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетНаОплатуПокупателю КАК докСчетНаОплатуПокупателю
				ПО докРеализацияТоваровУслуг.СчетНаОплатуПокупателю = докСчетНаОплатуПокупателю.Ссылка}
			ПО (СчетФактураВыданный.ДокументОснование = докРеализацияТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Счет_Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докСчетНаОплатуПокупателю.Ссылка КАК PORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	докРеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетНаОплатуПокупателю КАК докСчетНаОплатуПокупателю
			ПО докРеализацияТоваровУслуг.СчетНаОплатуПокупателю = докСчетНаОплатуПокупателю.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_</name>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения.Наименование КАК КодЕдиницыИзмерения,
	РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	NULL КАК ХарактеристикаНоменклатуры,
	NULL КАК СерияНоменклатуры,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СтранаПроисхождения КАК Страна,
	РеализацияТоваровУслугТовары.НомерГТД КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС КАК СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.БазоваяЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное,
	NULL,
	NULL,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	ВозвратТоваровОтПокупателяТовары.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяТовары.НомерГТД,
	-ВозвратТоваровОтПокупателяТовары.Количество,
	-ВозвратТоваровОтПокупателяТовары.Сумма,
	-ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	NULL
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.Наименование,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НаименованиеПолное,
	NULL,
	NULL,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НомерГТД,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Количество,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.ВозвратТоваровОтПокупателя.ВозвратнаяТара КАК ВозвратТоваровОтПокупателяВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И ВозвратТоваровОтПокупателяВозвратнаяТара.Ссылка В(&amp;Возвраты)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_DESADV_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения.Наименование КАК КодЕдиницыИзмерения,
	РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	NULL КАК ХарактеристикаНоменклатуры,
	NULL КАК СерияНоменклатуры,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СтранаПроисхождения КАК Страна,
	РеализацияТоваровУслугТовары.НомерГТД КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС КАК СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.БазоваяЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное,
	NULL,
	NULL,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	ВозвратТоваровОтПокупателяТовары.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяТовары.НомерГТД,
	-ВозвратТоваровОтПокупателяТовары.Количество,
	-ВозвратТоваровОтПокупателяТовары.Сумма,
	-ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	NULL
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.Наименование,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НаименованиеПолное,
	NULL,
	NULL,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.НДС0),
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НомерГТД,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Количество,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.ВозвратТоваровОтПокупателя.ВозвратнаяТара КАК ВозвратТоваровОтПокупателяВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И ВозвратТоваровОтПокупателяВозвратнаяТара.Ссылка В(&amp;Возвраты)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>ТКПТ</name>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация_СчетФактура</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	ЗаказПокупателя.Ссылка КАК PORDERS,
	ЗаказПокупателя.Ссылка КАК ORDERS,
	ЗаказПокупателя.Ссылка КАК ORDRSP,
	РеализацияТоваров.Ссылка КАК RECADV,
	РеализацияТоваров.Ссылка КАК DESADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваров КАК РеализацияТоваров
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПокупателя КАК ЗаказПокупателя
				ПО РеализацияТоваров.ДокументОснование = ЗаказПокупателя.Ссылка}
			ПО СчетФактураВыданный.ДокументОснование = РеализацияТоваров.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_</name>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПокупателя</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказПокупателяТовары.Номенклатура,
	ЗаказПокупателяТовары.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ЗаказПокупателяТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказПокупателяТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ЗаказПокупателяТовары.Цена,
	ЗаказПокупателяТовары.СтавкаНДС,
	ЗаказПокупателяТовары.Количество КАК Количество,
	ЗаказПокупателяТовары.Сумма КАК Сумма,
	ЗаказПокупателяТовары.СуммаНДС КАК СуммаНДС
ИЗ
	Документ.ЗаказПокупателя.Товары КАК ЗаказПокупателяТовары
ГДЕ
	ЗаказПокупателяТовары.Ссылка В(&amp;Ссылка)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_DESADV_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваров</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровТовары.НомерСтроки,
	РеализацияТоваровТовары.Номенклатура,
	РеализацияТоваровТовары.ХарактеристикаНоменклатуры,
	РеализацияТоваровТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РеализацияТоваровТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	РеализацияТоваровТовары.Номенклатура.Наименование КАК Наименование,
	РеализацияТоваровТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	РеализацияТоваровТовары.Цена,
	РеализацияТоваровТовары.СтавкаНДС,
	NULL КАК СерияНоменклатуры,
	РеализацияТоваровТовары.Номенклатура.СтранаПроисхождения КАК Страна,
	РеализацияТоваровТовары.Номенклатура.ГТД.Код КАК НомерГТД,
	РеализацияТоваровТовары.Количество КАК Количество,
	РеализацияТоваровТовары.Сумма КАК Сумма,
	РеализацияТоваровТовары.СуммаНДС КАК СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваров.Товары КАК РеализацияТоваровТовары
ГДЕ
	РеализацияТоваровТовары.Ссылка В(&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.ХарактеристикаНоменклатуры,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	NULL,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.ГТД.Код,
	-ВозвратТоваровОтПокупателяТовары.Количество,
	-ВозвратТоваровОтПокупателяТовары.Сумма,
	-ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	NULL
ИЗ
	Документ.ВозвратОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_ПредварительноеПоступление_Поступление_СчетФактура</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	ЗаказПоставщику.Ссылка КАК PORDERS,
	ЗаказПоставщику.Ссылка КАК ORDERS,
	ЗаказПоставщику.Ссылка КАК ORDRSP,
	ПоступлениеТоваров.Ссылка КАК RECADV,
	ПредварительноеПоступлениеТоваров.Ссылка КАК DESADV,
	СчетФактураПолученный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураПолученный КАК СчетФактураПолученный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваров КАК ПоступлениеТоваров
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ПредварительноеПоступлениеТоваров КАК ПредварительноеПоступлениеТоваров
					{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПоставщику КАК ЗаказПоставщику
					ПО ПредварительноеПоступлениеТоваров.ДокументОснование = ЗаказПоставщику.Ссылка}
				ПО ПоступлениеТоваров.ДокументОснование = ПредварительноеПоступлениеТоваров.Ссылка}
			ПО СчетФактураПолученный.ДокументОснование = ПоступлениеТоваров.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Поступление_СчетФактура</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	ЗаказПоставщику.Ссылка КАК PORDERS,
	ЗаказПоставщику.Ссылка КАК ORDERS,
	ЗаказПоставщику.Ссылка КАК ORDRSP,
	ПоступлениеТоваров.Ссылка КАК RECADV,
	ПоступлениеТоваров.Ссылка КАК DESADV,
	СчетФактураПолученный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураПолученный КАК СчетФактураПолученный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваров КАК ПоступлениеТоваров
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПоставщику КАК ЗаказПоставщику
				ПО ПоступлениеТоваров.ДокументОснование = ЗаказПоставщику.Ссылка}
			ПО СчетФактураПолученный.ДокументОснование = ПоступлениеТоваров.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_ORDERS_</name>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПоставщику</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказПоставщикуТовары.Номенклатура.Код КАК КодТовараПокупателя,
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.ХарактеристикаНоменклатуры,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ЗаказПоставщикуТовары.Номенклатура.Наименование КАК Наименование,
	ЗаказПоставщикуТовары.Цена,
	ЗаказПоставщикуТовары.СтавкаНДС,
	СУММА(ЗаказПоставщикуТовары.Количество) КАК Количество,
	СУММА(ЗаказПоставщикуТовары.Сумма) КАК Сумма,
	СУММА(ЗаказПоставщикуТовары.СуммаНДС) КАК СуммаНДС
ИЗ
	Документ.ЗаказПоставщику.Товары КАК ЗаказПоставщикуТовары
ГДЕ
	ЗаказПоставщикуТовары.Ссылка = &amp;Ссылка

СГРУППИРОВАТЬ ПО
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.ХарактеристикаНоменклатуры,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения,
	ЗаказПоставщикуТовары.Цена,
	ЗаказПоставщикуТовары.Номенклатура.Наименование,
	ЗаказПоставщикуТовары.СтавкаНДС,
	ЗаказПоставщикуТовары.Номенклатура.Код</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RECADV_</name>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваров</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваров.Номенклатура,
	ПоступлениеТоваров.ХарактеристикаНоменклатуры,
	ПоступлениеТоваров.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ПоступлениеТоваров.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ПоступлениеТоваров.Номенклатура.Наименование КАК Наименование,
	ПоступлениеТоваров.Количество КАК Количество,
	ПоступлениеТоваров.Цена,
	ПоступлениеТоваров.СтавкаНДС,
	ПоступлениеТоваров.Сумма,
	ПоступлениеТоваров.СуммаНДС
ИЗ
	Документ.ПоступлениеТоваров.Товары КАК ПоступлениеТоваров
ГДЕ
	ПоступлениеТоваров.Ссылка = &amp;Ссылка</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТоварыEDIВ1С</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ТабТоваров.GTIN КАК GTIN,
	ТабТоваров.КодТовараСторонний КАК КодТовараСторонний,
	ТабТоваров.КодТовараСвой КАК КодТовараСвой,
	ТабСоответствий_КонтурEDI.Номенклатура КАК Номенклатура,
	ТабСоответствий_КонтурEDI.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ТабСоответствий_КонтурEDI.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	3 КАК Приоритет
ПОМЕСТИТЬ ВТ_НайденныеСоответствия
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТабСоответствий_КонтурEDI КАК ТабСоответствий_КонтурEDI
		ПО ТабТоваров.GTIN = ТабСоответствий_КонтурEDI.GTIN
			И ТабТоваров.КодТовараСторонний = ТабСоответствий_КонтурEDI.КодТовараСторонний
			И ТабТоваров.КодТовараСвой = ТабСоответствий_КонтурEDI.КодТовараСвой

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	СправочникНоменклатура.Ссылка,
	НЕОПРЕДЕЛЕНО,
	СправочникНоменклатура.ОсновнаяЕдиницаИзмерения,
	2
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК СправочникНоменклатура
		ПО ТабТоваров.КодТовараСвой = СправочникНоменклатура.Код
ГДЕ
	НЕ ТабТоваров.КодТовараСвой = ""

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	Штрихкоды.Объект,
	Штрихкоды.ХарактеристикаНоменклатуры,
	Штрихкоды.ЕдиницаИзмерения,
	1
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ШтрихКоды КАК Штрихкоды
		ПО (ПОДСТРОКА(ТабТоваров.GTIN, 2, 13) = Штрихкоды.ШтрихКод)
ГДЕ
	НЕ ТабТоваров.GTIN = ""</query>
				<autoFillFields>false</autoFillFields>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТовары1СВEDIВ_GTIN</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ РАЗЛИЧНЫЕ
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ТабТоваров.Номенклатура.Код КАК КодТовараСвой,
	ВЫРАЗИТЬ(Штрихкоды.Штрихкод КАК СТРОКА(14)) КАК GTIN
ПОМЕСТИТЬ ВТШтрихкодыТоваров
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО ТабТоваров.Номенклатура = Штрихкоды.Объект
			И (Штрихкоды.ОсновнойШтрихкод = ИСТИНА)
ГДЕ
	&amp;ИскатьТоварПоШК

ИНДЕКСИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения</query>
				<autoFillFields>false</autoFillFields>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>УТ_10_2</name>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докЗаказПокупателя.Ссылка КАК PORDERS,
	докЗаказПокупателя.Ссылка КАК ORDERS,
	докЗаказПокупателя.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПокупателя КАК докЗаказПокупателя
				ПО докРеализацияТоваровУслуг.Сделка = докЗаказПокупателя.Ссылка}
			ПО СчетФактураВыданный.ДокументОснование = докРеализацияТоваровУслуг.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
			ПО СчетФактураВыданный.ДокументОснование = РеализацияТоваровУслуг.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докЗаказПокупателя.Ссылка КАК PORDERS,
	докЗаказПокупателя.Ссылка КАК ORDERS,
	докЗаказПокупателя.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	докРеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПокупателя КАК докЗаказПокупателя
			ПО докРеализацияТоваровУслуг.Сделка = докЗаказПокупателя.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	РеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_</name>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПокупателя_Проведен</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказыПокупателейОбороты.Номенклатура КАК Номенклатура,
	ЗаказыПокупателейОбороты.ХарактеристикаНоменклатуры,
	ЗаказыПокупателейОбороты.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказыПокупателейОбороты.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ЗаказыПокупателейОбороты.КоличествоПриход * ЗаказыПокупателейОбороты.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент / ЗаказыПокупателейОбороты.ЕдиницаИзмерения.Коэффициент КАК Количество,
	ЗаказыПокупателейОбороты.Цена,
	ЗаказыПокупателейОбороты.СуммаВзаиморасчетовПриход КАК Сумма,
	ЗаказПокупателяТовары.СтавкаНДС
ИЗ
	РегистрНакопления.ЗаказыПокупателей.Обороты(, , , ЗаказПокупателя В (&amp;Ссылка)) КАК ЗаказыПокупателейОбороты
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			Таб.Номенклатура КАК Номенклатура,
			Таб.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
			МАКСИМУМ(Таб.СтавкаНДС) КАК СтавкаНДС
		ИЗ
			Документ.ЗаказПокупателя.Товары КАК Таб
		ГДЕ
			Таб.Ссылка В(&amp;Ссылка)
		
		СГРУППИРОВАТЬ ПО
			Таб.Номенклатура,
			Таб.ХарактеристикаНоменклатуры) КАК ЗаказПокупателяТовары
		ПО ЗаказыПокупателейОбороты.Номенклатура = ЗаказПокупателяТовары.Номенклатура
			И ЗаказыПокупателейОбороты.ХарактеристикаНоменклатуры = ЗаказПокупателяТовары.ХарактеристикаНоменклатуры</query>
						<autoFillFields>false</autoFillFields>
					</item>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПокупателя_НеПроведен</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказПокупателяТовары.Номенклатура,
	ЗаказПокупателяТовары.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ЗаказПокупателяТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказПокупателяТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ЗаказПокупателяТовары.Цена,
	ЗаказПокупателяТовары.СтавкаНДС,
	ЗаказПокупателяТовары.Количество КАК Количество,
	ЗаказПокупателяТовары.Сумма КАК Сумма,
	ЗаказПокупателяТовары.СуммаНДС КАК СуммаНДС
ИЗ
	Документ.ЗаказПокупателя.Товары КАК ЗаказПокупателяТовары
ГДЕ
	ЗаказПокупателяТовары.Ссылка В(&amp;Ссылка)</query>
						<autoFillFields>false</autoFillFields>
					</item>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.ХарактеристикаНоменклатуры,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СерияНоменклатуры,
	ВЫБОР
		КОГДА (РеализацияТоваровУслугТовары.СерияНоменклатуры = ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка)
				ИЛИ РеализацияТоваровУслугТовары.СерияНоменклатуры.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка))
				И РеализацияТоваровУслугТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ РеализацияТоваровУслугТовары.СерияНоменклатуры.СтранаПроисхождения
	КОНЕЦ КАК Страна,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ЕСТЬNULL(РеализацияТоваровУслугТовары.СерияНоменклатуры.НомерГТД.Код, ЕСТЬNULL(РеализацияТоваровУслугТовары.Номенклатура.НомерГТД.Код, ""))
		ИНАЧЕ ""
	КОНЕЦ КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугВозвратнаяТара.НомерСтроки,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура,
	NULL,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков.ЕдиницаПоКлассификатору.Наименование,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.Наименование,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НаименованиеПолное,
	РеализацияТоваровУслугВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	NULL,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	"",
	РеализацияТоваровУслугВозвратнаяТара.Количество,
	РеализацияТоваровУслугВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.РеализацияТоваровУслуг.ВозвратнаяТара КАК РеализацияТоваровУслугВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И РеализацияТоваровУслугВозвратнаяТара.Ссылка В(&amp;Ссылка)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_DESADV_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.ХарактеристикаНоменклатуры,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СерияНоменклатуры,
	ВЫБОР
		КОГДА (РеализацияТоваровУслугТовары.СерияНоменклатуры = ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка)
				ИЛИ РеализацияТоваровУслугТовары.СерияНоменклатуры.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка))
				И РеализацияТоваровУслугТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ РеализацияТоваровУслугТовары.СерияНоменклатуры.СтранаПроисхождения
	КОНЕЦ КАК Страна,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ЕСТЬNULL(РеализацияТоваровУслугТовары.СерияНоменклатуры.НомерГТД.Код, ЕСТЬNULL(РеализацияТоваровУслугТовары.Номенклатура.НомерГТД.Код, ""))
		ИНАЧЕ ""
	КОНЕЦ КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС КАК СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.ХарактеристикаНоменклатуры,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры,
	ВЫБОР
		КОГДА (ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры = ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка)
				ИЛИ ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка))
				И ВозвратТоваровОтПокупателяТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ВозвратТоваровОтПокупателяТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры.СтранаПроисхождения
	КОНЕЦ,
	ВЫБОР
		КОГДА ВозвратТоваровОтПокупателяТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры.НомерГТД.Код, ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.Номенклатура.НомерГТД.Код, ""))
		ИНАЧЕ ""
	КОНЕЦ,
	-ВозвратТоваровОтПокупателяТовары.Количество,
	-ВозвратТоваровОтПокупателяТовары.Сумма,
	-ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	NULL
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугВозвратнаяТара.НомерСтроки,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура,
	NULL,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков.ЕдиницаПоКлассификатору.Наименование,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.Наименование,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НаименованиеПолное,
	РеализацияТоваровУслугВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	NULL,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	"",
	РеализацияТоваровУслугВозвратнаяТара.Количество,
	РеализацияТоваровУслугВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.РеализацияТоваровУслуг.ВозвратнаяТара КАК РеализацияТоваровУслугВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И РеализацияТоваровУслугВозвратнаяТара.Ссылка В(&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура,
	NULL,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков.ЕдиницаПоКлассификатору.Наименование,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.Наименование,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НаименованиеПолное,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	NULL,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	"",
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Количество,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.ВозвратТоваровОтПокупателя.ВозвратнаяТара КАК ВозвратТоваровОтПокупателяВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И ВозвратТоваровОтПокупателяВозвратнаяТара.Ссылка В(&amp;Возвраты)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Поступление_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	ЗаказПоставщику.Ссылка КАК PORDERS,
	ЗаказПоставщику.Ссылка КАК ORDERS,
	ЗаказПоставщику.Ссылка КАК ORDRSP,
	ПоступлениеТоваровУслуг.Ссылка КАК DESADV,
	ПоступлениеТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураПолученный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураПолученный КАК СчетФактураПолученный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваровУслуг КАК ПоступлениеТоваровУслуг
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПоставщику КАК ЗаказПоставщику
				ПО ПоступлениеТоваровУслуг.Сделка = ЗаказПоставщику.Ссылка}
			ПО СчетФактураПолученный.ДокументОснование = ПоступлениеТоваровУслуг.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_ORDERS_</name>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПоставщику</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказПоставщикуТовары.Номенклатура.Код КАК КодТовараПокупателя,
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.ХарактеристикаНоменклатуры,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ЗаказПоставщикуТовары.Номенклатура.Наименование КАК Наименование,
	ЗаказПоставщикуТовары.Цена,
	ЗаказПоставщикуТовары.СтавкаНДС,
	СУММА(ЗаказПоставщикуТовары.Количество) КАК Количество,
	СУММА(ЗаказПоставщикуТовары.Сумма) КАК Сумма,
	СУММА(ЗаказПоставщикуТовары.СуммаНДС) КАК СуммаНДС
ИЗ
	Документ.ЗаказПоставщику.Товары КАК ЗаказПоставщикуТовары
ГДЕ
	ЗаказПоставщикуТовары.Ссылка = &amp;Ссылка

СГРУППИРОВАТЬ ПО
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.ХарактеристикаНоменклатуры,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения,
	ЗаказПоставщикуТовары.Цена,
	ЗаказПоставщикуТовары.Номенклатура.Наименование,
	ЗаказПоставщикуТовары.СтавкаНДС,
	ЗаказПоставщикуТовары.Номенклатура.Код</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RECADV_</name>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.Номенклатура,
	ПоступлениеТоваровУслугТовары.ХарактеристикаНоменклатуры,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	ПоступлениеТоваровУслугТовары.Количество КАК Количество,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка = &amp;Ссылка</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТоварыEDIВ1С</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ТабТоваров.GTIN КАК GTIN,
	ТабТоваров.КодТовараСторонний КАК КодТовараСторонний,
	ТабТоваров.КодТовараСвой КАК КодТовараСвой,
	ТабСоответствий_КонтурEDI.Номенклатура КАК Номенклатура,
	ТабСоответствий_КонтурEDI.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ТабСоответствий_КонтурEDI.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	3 КАК Приоритет
ПОМЕСТИТЬ ВТ_НайденныеСоответствия
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТабСоответствий_КонтурEDI КАК ТабСоответствий_КонтурEDI
		ПО ТабТоваров.GTIN = ТабСоответствий_КонтурEDI.GTIN
			И ТабТоваров.КодТовараСторонний = ТабСоответствий_КонтурEDI.КодТовараСторонний
			И ТабТоваров.КодТовараСвой = ТабСоответствий_КонтурEDI.КодТовараСвой

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	СправочникНоменклатура.Ссылка,
	НЕОПРЕДЕЛЕНО,
	СправочникНоменклатура.ЕдиницаХраненияОстатков,
	2
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК СправочникНоменклатура
		ПО ТабТоваров.КодТовараСвой = СправочникНоменклатура.Код
ГДЕ
	НЕ ТабТоваров.КодТовараСвой = ""

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	Штрихкоды.Владелец,
	Штрихкоды.ХарактеристикаНоменклатуры,
	Штрихкоды.ЕдиницаИзмерения,
	1
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО (ПОДСТРОКА(ТабТоваров.GTIN, 2, 13) = Штрихкоды.Штрихкод)
			И (Штрихкоды.ТипШтрихкода = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ТипыШтрихкодов.EAN13))
ГДЕ
	НЕ ТабТоваров.GTIN = ""</query>
				<autoFillFields>false</autoFillFields>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТовары1СВEDIВ_GTIN</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ РАЗЛИЧНЫЕ
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ТабТоваров.Номенклатура.Код КАК КодТовараСвой,
	КОЛИЧЕСТВО(ВЫРАЗИТЬ(Штрихкоды.Штрихкод КАК СТРОКА(14))) КАК КоличествоШК
ПОМЕСТИТЬ ПосчитанныеКоличестваШК
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО ТабТоваров.Номенклатура = Штрихкоды.Владелец
			И ТабТоваров.ХарактеристикаНоменклатуры = Штрихкоды.ХарактеристикаНоменклатуры
			И ТабТоваров.ЕдиницаИзмерения = Штрихкоды.ЕдиницаИзмерения
ГДЕ
	&amp;ИскатьТоварПоШК

СГРУППИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ТабТоваров.Номенклатура.Код

ИНДЕКСИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ПосчитанныеКоличестваШК.Номенклатура,
	ПосчитанныеКоличестваШК.ХарактеристикаНоменклатуры,
	ПосчитанныеКоличестваШК.ЕдиницаИзмерения,
	ПосчитанныеКоличестваШК.КодТовараСвой
ПОМЕСТИТЬ ТоварыСВалиднымиШК
ИЗ
	ПосчитанныеКоличестваШК КАК ПосчитанныеКоличестваШК
ГДЕ
	ПосчитанныеКоличестваШК.КоличествоШК = 1
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	ТоварыСВалиднымиШК.Номенклатура,
	ТоварыСВалиднымиШК.ХарактеристикаНоменклатуры,
	ТоварыСВалиднымиШК.ЕдиницаИзмерения,
	ТоварыСВалиднымиШК.КодТовараСвой,
	ВЫРАЗИТЬ(Штрихкоды.Штрихкод КАК СТРОКА(14)) КАК GTIN
ПОМЕСТИТЬ ВТШтрихкодыТоваров
ИЗ
	ТоварыСВалиднымиШК КАК ТоварыСВалиднымиШК
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО ТоварыСВалиднымиШК.Номенклатура = Штрихкоды.Владелец
			И ТоварыСВалиднымиШК.ХарактеристикаНоменклатуры = Штрихкоды.ХарактеристикаНоменклатуры
			И ТоварыСВалиднымиШК.ЕдиницаИзмерения = Штрихкоды.ЕдиницаИзмерения
ГДЕ
	&amp;ИскатьТоварПоШК

ИНДЕКСИРОВАТЬ ПО
	ТоварыСВалиднымиШК.Номенклатура,
	ТоварыСВалиднымиШК.ХарактеристикаНоменклатуры,
	ТоварыСВалиднымиШК.ЕдиницаИзмерения</query>
				<autoFillFields>false</autoFillFields>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>УТ_УПП_КА</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>НомерСтроки</dataPath>
			<field>НомерСтроки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕдиницаИзмерения</dataPath>
			<field>ЕдиницаИзмерения</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КодЕдиницыИзмерения</dataPath>
			<field>КодЕдиницыИзмерения</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Количество</dataPath>
			<field>Количество</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Наименование</dataPath>
			<field>Наименование</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НаименованиеПолное</dataPath>
			<field>НаименованиеПолное</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Номенклатура</dataPath>
			<field>Номенклатура</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НомерГТД</dataPath>
			<field>НомерГТД</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СерияНоменклатуры</dataPath>
			<field>СерияНоменклатуры</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтавкаНДС</dataPath>
			<field>СтавкаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Страна</dataPath>
			<field>Страна</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Сумма</dataPath>
			<field>Сумма</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаНДС</dataPath>
			<field>СуммаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ТипЕдиницы</dataPath>
			<field>ТипЕдиницы</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ХарактеристикаНоменклатуры</dataPath>
			<field>ХарактеристикаНоменклатуры</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Цена</dataPath>
			<field>Цена</field>
		</field>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>НомерСтроки</dataPath>
				<field>НомерСтроки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЕдиницаИзмерения</dataPath>
				<field>ЕдиницаИзмерения</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КодЕдиницыИзмерения</dataPath>
				<field>КодЕдиницыИзмерения</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Количество</dataPath>
				<field>Количество</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Наименование</dataPath>
				<field>Наименование</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НаименованиеПолное</dataPath>
				<field>НаименованиеПолное</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Номенклатура</dataPath>
				<field>Номенклатура</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НомерГТД</dataPath>
				<field>НомерГТД</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СерияНоменклатуры</dataPath>
				<field>СерияНоменклатуры</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СтавкаНДС</dataPath>
				<field>СтавкаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Страна</dataPath>
				<field>Страна</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма</dataPath>
				<field>Сумма</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаНДС</dataPath>
				<field>СуммаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ТипЕдиницы</dataPath>
				<field>ТипЕдиницы</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ХарактеристикаНоменклатуры</dataPath>
				<field>ХарактеристикаНоменклатуры</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Цена</dataPath>
				<field>Цена</field>
			</field>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докЗаказПокупателя.Ссылка КАК PORDERS,
	докЗаказПокупателя.Ссылка КАК ORDERS,
	докЗаказПокупателя.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданныйДокументыОснования.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПокупателя КАК докЗаказПокупателя
				ПО докРеализацияТоваровУслуг.Сделка = докЗаказПокупателя.Ссылка}
			ПО СчетФактураВыданныйДокументыОснования.ДокументОснование = докРеализацияТоваровУслуг.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданныйДокументыОснования.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
			ПО СчетФактураВыданныйДокументыОснования.ДокументОснование = РеализацияТоваровУслуг.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докЗаказПокупателя.Ссылка КАК PORDERS,
	докЗаказПокупателя.Ссылка КАК ORDERS,
	докЗаказПокупателя.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	докРеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПокупателя КАК докЗаказПокупателя
			ПО (докРеализацияТоваровУслуг.Сделка = докЗаказПокупателя.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	РеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<field xsi:type="DataSetFieldField">
					<dataPath>НомерСтроки</dataPath>
					<field>НомерСтроки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЕдиницаИзмерения</dataPath>
					<field>ЕдиницаИзмерения</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КодЕдиницыИзмерения</dataPath>
					<field>КодЕдиницыИзмерения</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Количество</dataPath>
					<field>Количество</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Наименование</dataPath>
					<field>Наименование</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НаименованиеПолное</dataPath>
					<field>НаименованиеПолное</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Номенклатура</dataPath>
					<field>Номенклатура</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НомерГТД</dataPath>
					<field>НомерГТД</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СерияНоменклатуры</dataPath>
					<field>СерияНоменклатуры</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СтавкаНДС</dataPath>
					<field>СтавкаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Страна</dataPath>
					<field>Страна</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Сумма</dataPath>
					<field>Сумма</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СуммаНДС</dataPath>
					<field>СуммаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ТипЕдиницы</dataPath>
					<field>ТипЕдиницы</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ХарактеристикаНоменклатуры</dataPath>
					<field>ХарактеристикаНоменклатуры</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Цена</dataPath>
					<field>Цена</field>
				</field>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_</name>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПокупателя_Проведен</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказыПокупателейОбороты.Номенклатура КАК Номенклатура,
	ЗаказыПокупателейОбороты.ХарактеристикаНоменклатуры,
	ЗаказыПокупателейОбороты.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказыПокупателейОбороты.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ЗаказыПокупателейОбороты.КоличествоПриход * ЗаказыПокупателейОбороты.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент / ЗаказыПокупателейОбороты.ЕдиницаИзмерения.Коэффициент КАК Количество,
	ЗаказыПокупателейОбороты.Цена,
	ЗаказыПокупателейОбороты.СуммаВзаиморасчетовПриход КАК Сумма,
	ЗаказПокупателяТовары.СтавкаНДС
ИЗ
	РегистрНакопления.ЗаказыПокупателей.Обороты(, , , ЗаказПокупателя В (&amp;Ссылка)) КАК ЗаказыПокупателейОбороты
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			Таб.Номенклатура КАК Номенклатура,
			Таб.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
			МАКСИМУМ(Таб.СтавкаНДС) КАК СтавкаНДС
		ИЗ
			Документ.ЗаказПокупателя.Товары КАК Таб
		ГДЕ
			Таб.Ссылка В(&amp;Ссылка)
		
		СГРУППИРОВАТЬ ПО
			Таб.Номенклатура,
			Таб.ХарактеристикаНоменклатуры) КАК ЗаказПокупателяТовары
		ПО ЗаказыПокупателейОбороты.Номенклатура = ЗаказПокупателяТовары.Номенклатура
			И ЗаказыПокупателейОбороты.ХарактеристикаНоменклатуры = ЗаказПокупателяТовары.ХарактеристикаНоменклатуры
ГДЕ
	НЕ ЗаказыПокупателейОбороты.СтатусПартии = ЗНАЧЕНИЕ(Перечисление.СтатусыПартийТоваров.ВозвратнаяТара)</query>
						<autoFillFields>false</autoFillFields>
					</item>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПокупателя_НеПроведен</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query> ВЫБРАТЬ
	ЗаказПокупателяТовары.Номенклатура,
	ЗаказПокупателяТовары.ХарактеристикаНоменклатуры как ХарактеристикаНоменклатуры,
	ЗаказПокупателяТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказПокупателяТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ЗаказПокупателяТовары.Цена,
	ЗаказПокупателяТовары.СтавкаНДС,
	ЗаказПокупателяТовары.Количество КАК Количество,
	ЗаказПокупателяТовары.Сумма КАК Сумма,
	ЗаказПокупателяТовары.СуммаНДС КАК СуммаНДС
ИЗ
	Документ.ЗаказПокупателя.Товары КАК ЗаказПокупателяТовары
ГДЕ
	ЗаказПокупателяТовары.Ссылка в (&amp;Ссылка)</query>
						<autoFillFields>false</autoFillFields>
					</item>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.ХарактеристикаНоменклатуры,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СерияНоменклатуры,
	ВЫБОР
		КОГДА (РеализацияТоваровУслугТовары.СерияНоменклатуры = ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка)
				ИЛИ РеализацияТоваровУслугТовары.СерияНоменклатуры.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка))
				И РеализацияТоваровУслугТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ РеализацияТоваровУслугТовары.СерияНоменклатуры.СтранаПроисхождения
	КОНЕЦ КАК Страна,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ЕСТЬNULL(РеализацияТоваровУслугТовары.СерияНоменклатуры.НомерГТД.Код, ЕСТЬNULL(РеализацияТоваровУслугТовары.Номенклатура.НомерГТД.Код, ""))
		ИНАЧЕ ""
	КОНЕЦ КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка в (&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугВозвратнаяТара.НомерСтроки,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура,
	NULL,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков.ЕдиницаПоКлассификатору.Наименование,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.Наименование,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НаименованиеПолное,
	РеализацияТоваровУслугВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	NULL,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	"",
	РеализацияТоваровУслугВозвратнаяТара.Количество,
	РеализацияТоваровУслугВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.РеализацияТоваровУслуг.ВозвратнаяТара КАК РеализацияТоваровУслугВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И РеализацияТоваровУслугВозвратнаяТара.Ссылка в (&amp;Ссылка)

</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_DESADV_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.ХарактеристикаНоменклатуры,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СерияНоменклатуры,
	ВЫБОР
		КОГДА (РеализацияТоваровУслугТовары.СерияНоменклатуры = ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка)
				ИЛИ РеализацияТоваровУслугТовары.СерияНоменклатуры.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка))
				И РеализацияТоваровУслугТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ РеализацияТоваровУслугТовары.СерияНоменклатуры.СтранаПроисхождения
	КОНЕЦ КАК Страна,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ЕСТЬNULL(РеализацияТоваровУслугТовары.СерияНоменклатуры.НомерГТД.Код, ЕСТЬNULL(РеализацияТоваровУслугТовары.Номенклатура.НомерГТД.Код, ""))
		ИНАЧЕ ""
	КОНЕЦ КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка в (&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.ХарактеристикаНоменклатуры,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры,
	ВЫБОР
		КОГДА (ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры = ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка)
				ИЛИ ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка))
				И ВозвратТоваровОтПокупателяТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ВозвратТоваровОтПокупателяТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры.СтранаПроисхождения
	КОНЕЦ,
	ВЫБОР
		КОГДА ВозвратТоваровОтПокупателяТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры.НомерГТД.Код, ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.Номенклатура.НомерГТД.Код, ""))
		ИНАЧЕ ""
	КОНЕЦ,
	-ВозвратТоваровОтПокупателяТовары.Количество,
	-ВозвратТоваровОтПокупателяТовары.Сумма,
	-ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	NULL
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугВозвратнаяТара.НомерСтроки,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура,
	NULL,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков.ЕдиницаПоКлассификатору.Наименование,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.Наименование,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НаименованиеПолное,
	РеализацияТоваровУслугВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	NULL,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	"",
	РеализацияТоваровУслугВозвратнаяТара.Количество,
	РеализацияТоваровУслугВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.РеализацияТоваровУслуг.ВозвратнаяТара КАК РеализацияТоваровУслугВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И РеализацияТоваровУслугВозвратнаяТара.Ссылка в (&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура,
	NULL,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков.ЕдиницаПоКлассификатору.Наименование,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.Наименование,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НаименованиеПолное,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	NULL,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	"",
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Количество,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.ВозвратТоваровОтПокупателя.ВозвратнаяТара КАК ВозвратТоваровОтПокупателяВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И ВозвратТоваровОтПокупателяВозвратнаяТара.Ссылка В(&amp;Возвраты)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RETINS_RETREC_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерСтроки</dataPath>
						<field>НомерСтроки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КодЕдиницыИзмерения</dataPath>
						<field>КодЕдиницыИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Количество</dataPath>
						<field>Количество</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Наименование</dataPath>
						<field>Наименование</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НаименованиеПолное</dataPath>
						<field>НаименованиеПолное</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерГТД</dataPath>
						<field>НомерГТД</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СерияНоменклатуры</dataPath>
						<field>СерияНоменклатуры</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДС</dataPath>
						<field>СтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Страна</dataPath>
						<field>Страна</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Сумма</dataPath>
						<field>Сумма</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаНДС</dataPath>
						<field>СуммаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ТипЕдиницы</dataPath>
						<field>ТипЕдиницы</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ХарактеристикаНоменклатуры</dataPath>
						<field>ХарактеристикаНоменклатуры</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<item xsi:type="DataSetQuery">
						<name>ВозвратТоваровОтПокупателя</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерСтроки</dataPath>
							<field>НомерСтроки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодЕдиницыИзмерения</dataPath>
							<field>КодЕдиницыИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НаименованиеПолное</dataPath>
							<field>НаименованиеПолное</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ВозвратТоваровОтПокупателяТовары.НомерСтроки,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.ХарактеристикаНоменклатуры,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование КАК Наименование,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры,
	ВЫБОР
		КОГДА (ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры = ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка)
				ИЛИ ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка))
				И ВозвратТоваровОтПокупателяТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ВозвратТоваровОтПокупателяТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры.СтранаПроисхождения
	КОНЕЦ КАК Страна,
	ВЫБОР
		КОГДА ВозвратТоваровОтПокупателяТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры.НомерГТД.Код, ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.Номенклатура.НомерГТД.Код, ""))
		ИНАЧЕ ""
	КОНЕЦ КАК НомерГТД,
	ВозвратТоваровОтПокупателяТовары.Количество,
	ВозвратТоваровОтПокупателяТовары.Сумма,
	ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Ссылка)</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваровУслуг</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерСтроки</dataPath>
							<field>НомерСтроки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодЕдиницыИзмерения</dataPath>
							<field>КодЕдиницыИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НаименованиеПолное</dataPath>
							<field>НаименованиеПолное</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.НомерСтроки,
	ПоступлениеТоваровУслугТовары.Номенклатура,
	ПоступлениеТоваровУслугТовары.ХарактеристикаНоменклатуры,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	ПоступлениеТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	ПоступлениеТоваровУслугТовары.СерияНоменклатуры,
	ВЫБОР
		КОГДА (ПоступлениеТоваровУслугТовары.СерияНоменклатуры = ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка)
				ИЛИ ПоступлениеТоваровУслугТовары.СерияНоменклатуры.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка))
				И ПоступлениеТоваровУслугТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ПоступлениеТоваровУслугТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ ПоступлениеТоваровУслугТовары.СерияНоменклатуры.СтранаПроисхождения
	КОНЕЦ КАК Страна,
	ВЫБОР
		КОГДА ПоступлениеТоваровУслугТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ЕСТЬNULL(ПоступлениеТоваровУслугТовары.СерияНоменклатуры.НомерГТД.Код, ЕСТЬNULL(ПоступлениеТоваровУслугТовары.Номенклатура.НомерГТД.Код, ""))
		ИНАЧЕ ""
	КОНЕЦ КАК НомерГТД,
	ПоступлениеТоваровУслугТовары.Количество,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка В(&amp;Ссылка)</query>
					</item>
				</item>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Поступление_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	ЗаказПоставщику.Ссылка КАК PORDERS,
	ЗаказПоставщику.Ссылка КАК ORDERS,
	ЗаказПоставщику.Ссылка КАК ORDRSP,
	ПоступлениеТоваровУслуг.Ссылка КАК DESADV,
	ПоступлениеТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураПолученныйДокументыОснования.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураПолученный.ДокументыОснования КАК СчетФактураПолученныйДокументыОснования
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваровУслуг КАК ПоступлениеТоваровУслуг
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПоставщику КАК ЗаказПоставщику
				ПО (ПоступлениеТоваровУслуг.Сделка = ЗаказПоставщику.Ссылка)}
			ПО (СчетФактураПолученныйДокументыОснования.ДокументОснование = ПоступлениеТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_ORDERS_</name>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПоставщику</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказПоставщикуТовары.Номенклатура.Код КАК КодТовараПокупателя,
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.ХарактеристикаНоменклатуры,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ЗаказПоставщикуТовары.Номенклатура.Наименование КАК Наименование,
	ЗаказПоставщикуТовары.Цена,
	ЗаказПоставщикуТовары.СтавкаНДС,
	СУММА(ЗаказПоставщикуТовары.Количество) КАК Количество,
	СУММА(ЗаказПоставщикуТовары.Сумма) КАК Сумма,
	СУММА(ЗаказПоставщикуТовары.СуммаНДС) КАК СуммаНДС
ИЗ
	Документ.ЗаказПоставщику.Товары КАК ЗаказПоставщикуТовары
ГДЕ
	ЗаказПоставщикуТовары.Ссылка = &amp;Ссылка

СГРУППИРОВАТЬ ПО
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.ХарактеристикаНоменклатуры,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения,
	ЗаказПоставщикуТовары.Цена,
	ЗаказПоставщикуТовары.Номенклатура.Наименование,
	ЗаказПоставщикуТовары.СтавкаНДС,
	ЗаказПоставщикуТовары.Номенклатура.Код</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RECADV_</name>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.Номенклатура,
	ПоступлениеТоваровУслугТовары.ХарактеристикаНоменклатуры,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	ПоступлениеТоваровУслугТовары.Количество КАК Количество,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка = &amp;Ссылка</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТоварыEDIВ1С</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ТабТоваров.GTIN КАК GTIN,
	ТабТоваров.КодТовараСторонний КАК КодТовараСторонний,
	ТабТоваров.КодТовараСвой КАК КодТовараСвой,
	ТабСоответствий_КонтурEDI.Номенклатура КАК Номенклатура,
	ТабСоответствий_КонтурEDI.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ТабСоответствий_КонтурEDI.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	3 КАК Приоритет
ПОМЕСТИТЬ ВТ_НайденныеСоответствия
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТабСоответствий_КонтурEDI КАК ТабСоответствий_КонтурEDI
		ПО ТабТоваров.GTIN = ТабСоответствий_КонтурEDI.GTIN
			И ТабТоваров.КодТовараСторонний = ТабСоответствий_КонтурEDI.КодТовараСторонний
			И ТабТоваров.КодТовараСвой = ТабСоответствий_КонтурEDI.КодТовараСвой

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	СправочникНоменклатура.Ссылка,
	НЕОПРЕДЕЛЕНО,
	СправочникНоменклатура.ЕдиницаХраненияОстатков,
	2
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК СправочникНоменклатура
		ПО ТабТоваров.КодТовараСвой = СправочникНоменклатура.Код
ГДЕ
	(НЕ ТабТоваров.КодТовараСвой = "")

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	Штрихкоды.Владелец,
	Штрихкоды.ХарактеристикаНоменклатуры,
	Штрихкоды.ЕдиницаИзмерения,
	1
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО (ПОДСТРОКА(ТабТоваров.GTIN, 2, 13) = Штрихкоды.Штрихкод)
			И (Штрихкоды.ТипШтрихкода = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ТипыШтрихкодов.EAN13))
ГДЕ
	(НЕ ТабТоваров.GTIN = "")</query>
				<autoFillFields>false</autoFillFields>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТовары1СВEDIВ_GTIN</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ РАЗЛИЧНЫЕ
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ТабТоваров.Номенклатура.Код КАК КодТовараСвой,
	КОЛИЧЕСТВО(ВЫРАЗИТЬ(Штрихкоды.Штрихкод КАК СТРОКА(14))) КАК КоличествоШК
ПОМЕСТИТЬ ПосчитанныеКоличестваШК
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО ТабТоваров.Номенклатура = Штрихкоды.Владелец
			И ТабТоваров.ХарактеристикаНоменклатуры = Штрихкоды.ХарактеристикаНоменклатуры
			И ТабТоваров.ЕдиницаИзмерения = Штрихкоды.ЕдиницаИзмерения
ГДЕ
	&amp;ИскатьТоварПоШК

СГРУППИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ТабТоваров.Номенклатура.Код

ИНДЕКСИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ПосчитанныеКоличестваШК.Номенклатура,
	ПосчитанныеКоличестваШК.ХарактеристикаНоменклатуры,
	ПосчитанныеКоличестваШК.ЕдиницаИзмерения,
	ПосчитанныеКоличестваШК.КодТовараСвой
ПОМЕСТИТЬ ТоварыСВалиднымиШК
ИЗ
	ПосчитанныеКоличестваШК КАК ПосчитанныеКоличестваШК
ГДЕ
	ПосчитанныеКоличестваШК.КоличествоШК = 1
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	ТоварыСВалиднымиШК.Номенклатура,
	ТоварыСВалиднымиШК.ХарактеристикаНоменклатуры,
	ТоварыСВалиднымиШК.ЕдиницаИзмерения,
	ТоварыСВалиднымиШК.КодТовараСвой,
	ВЫРАЗИТЬ(Штрихкоды.Штрихкод КАК СТРОКА(14)) КАК GTIN
ПОМЕСТИТЬ ВТШтрихкодыТоваров
ИЗ
	ТоварыСВалиднымиШК КАК ТоварыСВалиднымиШК
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО ТоварыСВалиднымиШК.Номенклатура = Штрихкоды.Владелец
			И ТоварыСВалиднымиШК.ХарактеристикаНоменклатуры = Штрихкоды.ХарактеристикаНоменклатуры
			И ТоварыСВалиднымиШК.ЕдиницаИзмерения = Штрихкоды.ЕдиницаИзмерения
ГДЕ
	&amp;ИскатьТоварПоШК

ИНДЕКСИРОВАТЬ ПО
	ТоварыСВалиднымиШК.Номенклатура,
	ТоварыСВалиднымиШК.ХарактеристикаНоменклатуры,
	ТоварыСВалиднымиШК.ЕдиницаИзмерения</query>
				<autoFillFields>false</autoFillFields>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>УФ_БП</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаНДС</dataPath>
			<field>СуммаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НомерСтроки</dataPath>
			<field>НомерСтроки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Сумма</dataPath>
			<field>Сумма</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Наименование</dataPath>
			<field>Наименование</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Наименование</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НаименованиеПолное</dataPath>
			<field>НаименованиеПолное</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Наименование полное</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтавкаНДС</dataPath>
			<field>СтавкаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ХарактеристикаНоменклатуры</dataPath>
			<field>ХарактеристикаНоменклатуры</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Характеристика номенклатуры</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НомерГТД</dataPath>
			<field>НомерГТД</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Номер ГТД</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ТипЕдиницы</dataPath>
			<field>ТипЕдиницы</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Тип единицы</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Количество</dataPath>
			<field>Количество</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Страна</dataPath>
			<field>Страна</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Страна</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕдиницаИзмерения</dataPath>
			<field>ЕдиницаИзмерения</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Единица измерения</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Номенклатура</dataPath>
			<field>Номенклатура</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Цена</dataPath>
			<field>Цена</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СерияНоменклатуры</dataPath>
			<field>СерияНоменклатуры</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Серия номенклатуры</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КодЕдиницыИзмерения</dataPath>
			<field>КодЕдиницыИзмерения</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Код единицы измерения</v8:content>
				</v8:item>
			</title>
		</field>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаНДС</dataPath>
				<field>СуммаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НомерСтроки</dataPath>
				<field>НомерСтроки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма</dataPath>
				<field>Сумма</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Наименование</dataPath>
				<field>Наименование</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Наименование</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НаименованиеПолное</dataPath>
				<field>НаименованиеПолное</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Наименование полное</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СтавкаНДС</dataPath>
				<field>СтавкаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ХарактеристикаНоменклатуры</dataPath>
				<field>ХарактеристикаНоменклатуры</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Характеристика номенклатуры</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НомерГТД</dataPath>
				<field>НомерГТД</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Номер ГТД</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ТипЕдиницы</dataPath>
				<field>ТипЕдиницы</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Тип единицы</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Количество</dataPath>
				<field>Количество</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Страна</dataPath>
				<field>Страна</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Страна</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЕдиницаИзмерения</dataPath>
				<field>ЕдиницаИзмерения</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Единица измерения</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Номенклатура</dataPath>
				<field>Номенклатура</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Цена</dataPath>
				<field>Цена</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СерияНоменклатуры</dataPath>
				<field>СерияНоменклатуры</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Серия номенклатуры</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КодЕдиницыИзмерения</dataPath>
				<field>КодЕдиницыИзмерения</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Код единицы измерения</v8:content>
					</v8:item>
				</title>
			</field>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Счет_Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докСчетНаОплатуПокупателю.Ссылка КАК PORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетНаОплатуПокупателю КАК докСчетНаОплатуПокупателю
				ПО докРеализацияТоваровУслуг.СчетНаОплатуПокупателю = докСчетНаОплатуПокупателю.Ссылка}
			ПО ((СчетФактураВыданный.ДокументОснование) = докРеализацияТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
			ПО ((СчетФактураВыданный.ДокументОснование) = РеализацияТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Счет_Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докСчетНаОплатуПокупателю.Ссылка КАК PORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	докРеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетНаОплатуПокупателю КАК докСчетНаОплатуПокупателю
			ПО докРеализацияТоваровУслуг.СчетНаОплатуПокупателю = докСчетНаОплатуПокупателю.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	РеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<field xsi:type="DataSetFieldField">
					<dataPath>СуммаНДС</dataPath>
					<field>СуммаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НомерСтроки</dataPath>
					<field>НомерСтроки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Сумма</dataPath>
					<field>Сумма</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Наименование</dataPath>
					<field>Наименование</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Наименование</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НаименованиеПолное</dataPath>
					<field>НаименованиеПолное</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Наименование полное</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СтавкаНДС</dataPath>
					<field>СтавкаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ХарактеристикаНоменклатуры</dataPath>
					<field>ХарактеристикаНоменклатуры</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Характеристика номенклатуры</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НомерГТД</dataPath>
					<field>НомерГТД</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Номер ГТД</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ТипЕдиницы</dataPath>
					<field>ТипЕдиницы</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Тип единицы</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Количество</dataPath>
					<field>Количество</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Страна</dataPath>
					<field>Страна</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Страна</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЕдиницаИзмерения</dataPath>
					<field>ЕдиницаИзмерения</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Единица измерения</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Номенклатура</dataPath>
					<field>Номенклатура</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Цена</dataPath>
					<field>Цена</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СерияНоменклатуры</dataPath>
					<field>СерияНоменклатуры</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Серия номенклатуры</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КодЕдиницыИзмерения</dataPath>
					<field>КодЕдиницыИзмерения</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Код единицы измерения</v8:content>
						</v8:item>
					</title>
				</field>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_</name>
					<item xsi:type="DataSetQuery">
						<name>СчетНаОплатуПокупателю</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
    ЗаказПокупателяТовары.Номенклатура,
    Неопределено КАК ХарактеристикаНоменклатуры,
    ЗаказПокупателяТовары.Номенклатура.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
    ЗаказПокупателяТовары.Цена,
    ЗаказПокупателяТовары.СтавкаНДС,
    ЗаказПокупателяТовары.Количество КАК Количество,
    ЛОЖЬ КАК Пометка,
    ЗаказПокупателяТовары.Сумма КАК Сумма
ИЗ
    Документ.СчетНаОплатуПокупателю.Товары КАК ЗаказПокупателяТовары
ГДЕ
    ЗаказПокупателяТовары.Ссылка В(&amp;Ссылка)</query>
						<autoFillFields>false</autoFillFields>
					</item>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	Неопределено КАК ХарактеристикаНоменклатуры,
	Неопределено КАК СерияНоменклатуры,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СтранаПроисхождения КАК Страна,
	РеализацияТоваровУслугТовары.НомерГТД КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС КАК СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В (&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугВозвратнаяТара.НомерСтроки,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.ЕдиницаИзмерения,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.Наименование,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НаименованиеПолное,
	Неопределено,
	Неопределено КАК СерияНоменклатуры,
	РеализацияТоваровУслугВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НомерГТД,
	РеализацияТоваровУслугВозвратнаяТара.Количество,
	РеализацияТоваровУслугВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.РеализацияТоваровУслуг.ВозвратнаяТара КАК РеализацияТоваровУслугВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И РеализацияТоваровУслугВозвратнаяТара.Ссылка В (&amp;Ссылка)

</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_DESADV_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	Неопределено КАК ХарактеристикаНоменклатуры,
	Неопределено КАК СерияНоменклатуры,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СтранаПроисхождения КАК Страна,
	РеализацияТоваровУслугТовары.НомерГТД КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС КАК СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В (&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.ЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное,
	Неопределено,
	Неопределено КАК СерияНоменклатуры,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	ВозвратТоваровОтПокупателяТовары.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяТовары.НомерГТД,
	-ВозвратТоваровОтПокупателяТовары.Количество,
	-ВозвратТоваровОтПокупателяТовары.Сумма,
	-ВозвратТоваровОтПокупателяТовары.СуммаНДС КАК СуммаНДС,
	NULL
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугВозвратнаяТара.НомерСтроки,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.ЕдиницаИзмерения,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.Наименование,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НаименованиеПолное,
	Неопределено,
	Неопределено КАК СерияНоменклатуры,
	РеализацияТоваровУслугВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НомерГТД,
	РеализацияТоваровУслугВозвратнаяТара.Количество,
	РеализацияТоваровУслугВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.РеализацияТоваровУслуг.ВозвратнаяТара КАК РеализацияТоваровУслугВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И РеализацияТоваровУслугВозвратнаяТара.Ссылка В (&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.ЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.Наименование,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НаименованиеПолное,
	Неопределено,
	Неопределено КАК СерияНоменклатуры,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НомерГТД,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Количество,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.ВозвратТоваровОтПокупателя.ВозвратнаяТара КАК ВозвратТоваровОтПокупателяВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И ВозвратТоваровОтПокупателяВозвратнаяТара.Ссылка В(&amp;Возвраты)
</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RETINS_RETREC_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаНДС</dataPath>
						<field>СуммаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерСтроки</dataPath>
						<field>НомерСтроки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Сумма</dataPath>
						<field>Сумма</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Наименование</dataPath>
						<field>Наименование</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Наименование</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НаименованиеПолное</dataPath>
						<field>НаименованиеПолное</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Наименование полное</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДС</dataPath>
						<field>СтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ХарактеристикаНоменклатуры</dataPath>
						<field>ХарактеристикаНоменклатуры</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Характеристика номенклатуры</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерГТД</dataPath>
						<field>НомерГТД</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Номер ГТД</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ТипЕдиницы</dataPath>
						<field>ТипЕдиницы</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Тип единицы</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Количество</dataPath>
						<field>Количество</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Страна</dataPath>
						<field>Страна</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Страна</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Единица измерения</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СерияНоменклатуры</dataPath>
						<field>СерияНоменклатуры</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Серия номенклатуры</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КодЕдиницыИзмерения</dataPath>
						<field>КодЕдиницыИзмерения</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Код единицы измерения</v8:content>
							</v8:item>
						</title>
					</field>
					<item xsi:type="DataSetQuery">
						<name>ВозвратТоваровОтПокупателя</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерСтроки</dataPath>
							<field>НомерСтроки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НаименованиеПолное</dataPath>
							<field>НаименованиеПолное</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование полное</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Характеристика номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Номер ГТД</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Тип единицы</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Страна</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Единица измерения</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Серия номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодЕдиницыИзмерения</dataPath>
							<field>КодЕдиницыИзмерения</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Код единицы измерения</v8:content>
								</v8:item>
							</title>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ВозвратТоваровОтПокупателяТовары.НомерСтроки,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	Неопределено КАК ХарактеристикаНоменклатуры,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.ЕдиницаИзмерения.Код КАК КодЕдиницыИзмерения,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование КАК Наименование,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	Неопределено КАК СерияНоменклатуры,
	ВЫБОР
		КОГДА ВозвратТоваровОтПокупателяТовары.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка)
			ТОГДА ВозвратТоваровОтПокупателяТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ ВозвратТоваровОтПокупателяТовары.СтранаПроисхождения
	КОНЕЦ КАК Страна,
	ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.НомерГТД.Код, ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.Номенклатура.НомерГТД.Код, "")) КАК НомерГТД,
	ВозвратТоваровОтПокупателяТовары.Количество,
	ВозвратТоваровОтПокупателяТовары.Сумма,
	ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Ссылка)</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваровУслуг</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерСтроки</dataPath>
							<field>НомерСтроки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НаименованиеПолное</dataPath>
							<field>НаименованиеПолное</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование полное</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Характеристика номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Номер ГТД</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Тип единицы</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Страна</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Единица измерения</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Серия номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодЕдиницыИзмерения</dataPath>
							<field>КодЕдиницыИзмерения</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Код единицы измерения</v8:content>
								</v8:item>
							</title>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.НомерСтроки,
	ПоступлениеТоваровУслугТовары.Номенклатура,
	Неопределено КАК ХарактеристикаНоменклатуры,
	ПоступлениеТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ПоступлениеТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения.Код КАК КодЕдиницыИзмерения,
	ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	ПоступлениеТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	Неопределено КАК СерияНоменклатуры,
	ВЫБОР
		КОГДА ПоступлениеТоваровУслугТовары.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка)
			ТОГДА ПоступлениеТоваровУслугТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ ПоступлениеТоваровУслугТовары.СтранаПроисхождения
	КОНЕЦ КАК Страна,
	ЕСТЬNULL(ПоступлениеТоваровУслугТовары.НомерГТД.Код, ЕСТЬNULL(ПоступлениеТоваровУслугТовары.Номенклатура.НомерГТД.Код, "")) КАК НомерГТД,
	ПоступлениеТоваровУслугТовары.Количество,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка В(&amp;Ссылка)</query>
					</item>
				</item>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>ПоступлениеТоваровУслуг_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	ПоступлениеТоваровУслуг.Ссылка КАК PORDERS,
	ПоступлениеТоваровУслуг.Ссылка КАК ORDERS,
	ПоступлениеТоваровУслуг.Ссылка КАК ORDRSP,
	ПоступлениеТоваровУслуг.Ссылка КАК DESADV,
	ПоступлениеТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураПолученный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураПолученный КАК СчетФактураПолученный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваровУслуг КАК ПоступлениеТоваровУслуг
			ПО СчетФактураПолученный.ДокументОснование = ПоступлениеТоваровУслуг.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_ORDERS_</name>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.Номенклатура,
	Неопределено КАК ХарактеристикаНоменклатуры,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения.Наименование КАК КодЕдиницыИзмерения,
	ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	ПоступлениеТоваровУслугТовары.Количество КАК Количество,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка = &amp;Ссылка</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RECADV_</name>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.Номенклатура,
	Неопределено КАК ХарактеристикаНоменклатуры,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения.Наименование КАК КодЕдиницыИзмерения,
	ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	ПоступлениеТоваровУслугТовары.Количество КАК Количество,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка = &amp;Ссылка</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТоварыEDIВ1С</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ТабТоваров.GTIN КАК GTIN,
	ТабТоваров.КодТовараСторонний КАК КодТовараСторонний,
	ТабТоваров.КодТовараСвой КАК КодТовараСвой,
	ТабСоответствий_КонтурEDI.Номенклатура КАК Номенклатура,
	ТабСоответствий_КонтурEDI.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ТабСоответствий_КонтурEDI.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	3 КАК Приоритет
ПОМЕСТИТЬ ВТ_НайденныеСоответствия
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТабСоответствий_КонтурEDI КАК ТабСоответствий_КонтурEDI
		ПО ТабТоваров.GTIN = ТабСоответствий_КонтурEDI.GTIN
			И ТабТоваров.КодТовараСторонний = ТабСоответствий_КонтурEDI.КодТовараСторонний
			И ТабТоваров.КодТовараСвой = ТабСоответствий_КонтурEDI.КодТовараСвой

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	СправочникНоменклатура.Ссылка,
	НЕОПРЕДЕЛЕНО,
	СправочникНоменклатура.ЕдиницаИзмерения,
	2
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК СправочникНоменклатура
		ПО ТабТоваров.КодТовараСвой = СправочникНоменклатура.Код
ГДЕ
	(НЕ ТабТоваров.КодТовараСвой = "")
</query>
				<autoFillFields>false</autoFillFields>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТовары1СВEDIВ_GTIN</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ТабТоваров.Номенклатура.Код КАК СТРОКА) КАК КодТовараСвой,
	"" КАК GTIN
ПОМЕСТИТЬ ВТШтрихкодыТоваров
ИЗ
	ТабТоваров КАК ТабТоваров

ИНДЕКСИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения</query>
				<autoFillFields>false</autoFillFields>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>УФ_УНФ</name>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докЗаказПокупателя.Ссылка КАК PORDERS,
	докЗаказПокупателя.Ссылка КАК ORDERS,
	докЗаказПокупателя.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданныйДокументыОснования.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактура.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РасходнаяНакладная КАК докРеализацияТоваровУслуг
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПокупателя КАК докЗаказПокупателя
				ПО ((докРеализацияТоваровУслуг.Заказ) = докЗаказПокупателя.Ссылка)}
			ПО ((СчетФактураВыданныйДокументыОснования.ДокументОснование) = докРеализацияТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданныйДокументыОснования.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактура.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РасходнаяНакладная КАК РеализацияТоваровУслуг
			ПО ((СчетФактураВыданныйДокументыОснования.ДокументОснование) = РеализацияТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докЗаказПокупателя.Ссылка КАК PORDERS,
	докЗаказПокупателя.Ссылка КАК ORDERS,
	докЗаказПокупателя.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	докРеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РасходнаяНакладная КАК докРеализацияТоваровУслуг
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПокупателя КАК докЗаказПокупателя
			ПО ((докРеализацияТоваровУслуг.Заказ) = докЗаказПокупателя.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	РеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РасходнаяНакладная КАК РеализацияТоваровУслуг
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_</name>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПокупателя</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказПокупателяТовары.Номенклатура,
	ЗаказПокупателяТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ЗаказПокупателяТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказПокупателяТовары.Цена,
	ЗаказПокупателяТовары.СтавкаНДС,
	ЗаказПокупателяТовары.Количество КАК Количество,
	ЛОЖЬ КАК Пометка,
	ЗаказПокупателяТовары.Сумма КАК Сумма
ИЗ
	Документ.ЗаказПокупателя.Запасы КАК ЗаказПокупателяТовары
ГДЕ
	ЗаказПокупателяТовары.Ссылка в (&amp;Ссылка)
</query>
						<autoFillFields>false</autoFillFields>
					</item>
					<item xsi:type="DataSetQuery">
						<name>РасходнаяНакладная</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,

  	РеализацияТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,

	РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	"" КАК СерияНоменклатуры,
	Значение(Справочник.СтраныМира.ПустаяСсылка) КАК Страна,
	"" КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.РасходнаяНакладная.Запасы КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В (&amp;Ссылка)
</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_DESADV_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>РасходнаяНакладная</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,

  	РеализацияТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,

	РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	"" КАК СерияНоменклатуры,
	Значение(Справочник.СтраныМира.ПустаяСсылка) КАК Страна,
	"" КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.РасходнаяНакладная.Запасы КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В (&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.Характеристика КАК ХарактеристикаНоменклатуры,

	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения,

	ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,

	"" КАК СерияНоменклатуры,
	Значение(Справочник.СтраныМира.ПустаяСсылка) КАК Страна,
	"" КАК НомерГТД,
	-ВозвратТоваровОтПокупателяТовары.Количество,
	-ВозвратТоваровОтПокупателяТовары.Сумма,
	-ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	NULL
ИЗ
	Документ.ПриходнаяНакладная.Запасы КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТовары1СВEDIВ_GTIN</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ РАЗЛИЧНЫЕ
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ТабТоваров.Номенклатура.Код КАК КодТовараСвой,
	ВЫРАЗИТЬ(Штрихкоды.Штрихкод КАК СТРОКА(14)) КАК GTIN
ПОМЕСТИТЬ ВТШтрихкодыТоваров
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ШтрихкодыНоменклатуры КАК Штрихкоды
		ПО ТабТоваров.Номенклатура = Штрихкоды.Номенклатура
			И ТабТоваров.ХарактеристикаНоменклатуры = Штрихкоды.Характеристика
ГДЕ
	&amp;ИскатьТоварПоШК

ИНДЕКСИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения</query>
				<autoFillFields>false</autoFillFields>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>УФ_УТ</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаНДС</dataPath>
			<field>СуммаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НомерСтроки</dataPath>
			<field>НомерСтроки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Сумма</dataPath>
			<field>Сумма</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Наименование</dataPath>
			<field>Наименование</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Наименование</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НаименованиеПолное</dataPath>
			<field>НаименованиеПолное</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Наименование полное</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтавкаНДС</dataPath>
			<field>СтавкаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ХарактеристикаНоменклатуры</dataPath>
			<field>ХарактеристикаНоменклатуры</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Характеристика номенклатуры</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НомерГТД</dataPath>
			<field>НомерГТД</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Номер ГТД</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ТипЕдиницы</dataPath>
			<field>ТипЕдиницы</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Тип единицы</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Количество</dataPath>
			<field>Количество</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Страна</dataPath>
			<field>Страна</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Страна</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕдиницаИзмерения</dataPath>
			<field>ЕдиницаИзмерения</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Единица измерения</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Номенклатура</dataPath>
			<field>Номенклатура</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Цена</dataPath>
			<field>Цена</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СерияНоменклатуры</dataPath>
			<field>СерияНоменклатуры</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Серия номенклатуры</v8:content>
				</v8:item>
			</title>
		</field>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаНДС</dataPath>
				<field>СуммаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НомерСтроки</dataPath>
				<field>НомерСтроки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма</dataPath>
				<field>Сумма</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Наименование</dataPath>
				<field>Наименование</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Наименование</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НаименованиеПолное</dataPath>
				<field>НаименованиеПолное</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Наименование полное</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СтавкаНДС</dataPath>
				<field>СтавкаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ХарактеристикаНоменклатуры</dataPath>
				<field>ХарактеристикаНоменклатуры</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Характеристика номенклатуры</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НомерГТД</dataPath>
				<field>НомерГТД</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Номер ГТД</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ТипЕдиницы</dataPath>
				<field>ТипЕдиницы</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Тип единицы</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Количество</dataPath>
				<field>Количество</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Страна</dataPath>
				<field>Страна</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Страна</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЕдиницаИзмерения</dataPath>
				<field>ЕдиницаИзмерения</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Единица измерения</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Номенклатура</dataPath>
				<field>Номенклатура</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Цена</dataPath>
				<field>Цена</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СерияНоменклатуры</dataPath>
				<field>СерияНоменклатуры</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Серия номенклатуры</v8:content>
					</v8:item>
				</title>
			</field>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докЗаказПокупателя.Ссылка КАК PORDERS,
	докЗаказПокупателя.Ссылка КАК ORDERS,
	докЗаказПокупателя.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказКлиента КАК докЗаказПокупателя
				ПО (докРеализацияТоваровУслуг.ЗаказКлиента = докЗаказПокупателя.Ссылка)}
			ПО (СчетФактураВыданный.ДокументОснование = докРеализацияТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
			ПО (СчетФактураВыданный.ДокументОснование = РеализацияТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докЗаказПокупателя.Ссылка КАК PORDERS,
	докЗаказПокупателя.Ссылка КАК ORDERS,
	докЗаказПокупателя.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	докРеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказКлиента КАК докЗаказПокупателя
			ПО (докРеализацияТоваровУслуг.ЗаказКлиента = докЗаказПокупателя.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	РеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<field xsi:type="DataSetFieldField">
					<dataPath>СуммаНДС</dataPath>
					<field>СуммаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НомерСтроки</dataPath>
					<field>НомерСтроки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Сумма</dataPath>
					<field>Сумма</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Наименование</dataPath>
					<field>Наименование</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Наименование</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НаименованиеПолное</dataPath>
					<field>НаименованиеПолное</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Наименование полное</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СтавкаНДС</dataPath>
					<field>СтавкаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ХарактеристикаНоменклатуры</dataPath>
					<field>ХарактеристикаНоменклатуры</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Характеристика номенклатуры</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НомерГТД</dataPath>
					<field>НомерГТД</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Номер ГТД</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ТипЕдиницы</dataPath>
					<field>ТипЕдиницы</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Тип единицы</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Количество</dataPath>
					<field>Количество</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Страна</dataPath>
					<field>Страна</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Страна</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЕдиницаИзмерения</dataPath>
					<field>ЕдиницаИзмерения</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Единица измерения</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Номенклатура</dataPath>
					<field>Номенклатура</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Цена</dataPath>
					<field>Цена</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СерияНоменклатуры</dataPath>
					<field>СерияНоменклатуры</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Серия номенклатуры</v8:content>
						</v8:item>
					</title>
				</field>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_</name>
					<item xsi:type="DataSetQuery">
						<name>ЗаказКлиента</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказПокупателяТовары.Номенклатура,
	ЗаказПокупателяТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА ЗаказПокупателяТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА ЗаказПокупателяТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ЗаказПокупателяТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ЗаказПокупателяТовары.Цена,
	ЗаказПокупателяТовары.СтавкаНДС,
	ВЫБОР
		КОГДА ЗаказПокупателяТовары.Отменено
			ТОГДА 0
		ИНАЧЕ ЗаказПокупателяТовары.КоличествоУпаковок
	КОНЕЦ КАК Количество,
	ЗаказПокупателяТовары.Сумма КАК Сумма,
	ЗаказПокупателяТовары.СуммаНДС КАК СуммаНДС
ИЗ
	Документ.ЗаказКлиента.Товары КАК ЗаказПокупателяТовары
ГДЕ
	ЗаказПокупателяТовары.Ссылка В(&amp;Ссылка)
	И НЕ ЗаказПокупателяТовары.Отменено</query>
						<autoFillFields>false</autoFillFields>
					</item>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ РеализацияТоваровУслугТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка) КАК СерияНоменклатуры,
	ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка) КАК Страна,
	"" КАК НомерГТД,
	РеализацияТоваровУслугТовары.КоличествоУпаковок КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	ВЫРАЗИТЬ("" КАК Строка(2)) КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)


</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_DESADV_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг_Проведен</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура КАК Номенклатура,
	РеализацияТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ РеализацияТоваровУслугТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.КоличествоУпаковок = 0
			ТОГДА 0
		ИНАЧЕ РеализацияТоваровУслугТовары.СуммаСНДС / РеализацияТоваровУслугТовары.КоличествоУпаковок
	КОНЕЦ КАК Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка) КАК СерияНоменклатуры,
	РеализацияТоваровУслугТовары.НомерГТД.СтранаПроисхождения КАК Страна,
	РеализацияТоваровУслугТовары.НомерГТД.Код КАК НомерГТД,
	РеализацияТоваровУслугТовары.КоличествоУпаковок КАК Количество,
	РеализацияТоваровУслугТовары.СуммаСНДС КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	ВЫРАЗИТЬ("" КАК СТРОКА(2)) КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.ВидыЗапасов КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)


//ранее мы учитывали здесь возвраты чтобы очитстить итоговую СФ, теперь на УФ штатно только через COINVOIC
//проблемаа в том что в видах запасов Возврата нет упаковки!!! 

//ОБЪЕДИНИТЬ ВСЕ

//ВЫБРАТЬ
//	0,
//	ВозвратТоваровОтПокупателяТовары.Номенклатура,
//	ВозвратТоваровОтПокупателяТовары.Характеристика,
//	ВЫБОР
//		КОГДА ВозвратТоваровОтПокупателяТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
//			ТОГДА ВозвратТоваровОтПокупателяТовары.Номенклатура.ЕдиницаИзмерения
//		ИНАЧЕ ВозвратТоваровОтПокупателяТовары.Упаковка
//	КОНЕЦ,
//	ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование,
//	ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное,
//	ВЫБОР
//		КОГДА ВозвратТоваровОтПокупателяТовары.КоличествоУпаковок = 0
//			ТОГДА 0
//		ИНАЧЕ ВозвратТоваровОтПокупателяТовары.СуммаСНДС / ВозвратТоваровОтПокупателяТовары.КоличествоУпаковок
//	КОНЕЦ,
//	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
//	ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка),
//	ВозвратТоваровОтПокупателяТовары.НомерГТД.СтранаПроисхождения,
//	ВозвратТоваровОтПокупателяТовары.НомерГТД.Код,
//	-ВозвратТоваровОтПокупателяТовары.Количество,
//	-ВозвратТоваровОтПокупателяТовары.Сумма,
//	-ВозвратТоваровОтПокупателяТовары.СуммаНДС,
//	ВЫРАЗИТЬ("" КАК СТРОКА(2))
//ИЗ
//	Документ.ВозвратТоваровОтКлиента.ВидыЗапасов КАК ВозвратТоваровОтПокупателяТовары
//ГДЕ
//	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)</query>
						<autoFillFields>false</autoFillFields>
					</item>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг_НеПроведен</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура КАК Номенклатура,
	РеализацияТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ РеализацияТоваровУслугТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка) КАК СерияНоменклатуры,
	ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка) КАК Страна,
	"" КАК НомерГТД,
	РеализацияТоваровУслугТовары.КоличествоУпаковок КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	ВЫРАЗИТЬ("" КАК Строка(2)) КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)

//ОБЪЕДИНИТЬ ВСЕ

//ВЫБРАТЬ
//	0,
//	ВозвратТоваровОтПокупателяТовары.Номенклатура,
//	ВозвратТоваровОтПокупателяТовары.Характеристика,
//	ВЫБОР
//		КОГДА ВозвратТоваровОтПокупателяТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
//			ТОГДА ВозвратТоваровОтПокупателяТовары.Номенклатура.ЕдиницаИзмерения
//		ИНАЧЕ ВозвратТоваровОтПокупателяТовары.Упаковка
//	КОНЕЦ,
//	ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование,
//	ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное,
//	ВозвратТоваровОтПокупателяТовары.Цена,
//	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
//	ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка),
//	ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка),
//	"",
//	-ВозвратТоваровОтПокупателяТовары.Количество,
//	-ВозвратТоваровОтПокупателяТовары.Сумма,
//	-ВозвратТоваровОтПокупателяТовары.СуммаНДС,
//	ВЫРАЗИТЬ("" КАК Строка(2))
//ИЗ
//	Документ.ВозвратТоваровОтКлиента.Товары КАК ВозвратТоваровОтПокупателяТовары
//ГДЕ
//	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)
</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RETINS_RETREC_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаНДС</dataPath>
						<field>СуммаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерСтроки</dataPath>
						<field>НомерСтроки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Сумма</dataPath>
						<field>Сумма</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Наименование</dataPath>
						<field>Наименование</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Наименование</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НаименованиеПолное</dataPath>
						<field>НаименованиеПолное</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Наименование полное</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДС</dataPath>
						<field>СтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ХарактеристикаНоменклатуры</dataPath>
						<field>ХарактеристикаНоменклатуры</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Характеристика номенклатуры</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерГТД</dataPath>
						<field>НомерГТД</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Номер ГТД</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ТипЕдиницы</dataPath>
						<field>ТипЕдиницы</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Тип единицы</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Количество</dataPath>
						<field>Количество</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Страна</dataPath>
						<field>Страна</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Страна</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Единица измерения</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СерияНоменклатуры</dataPath>
						<field>СерияНоменклатуры</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Серия номенклатуры</v8:content>
							</v8:item>
						</title>
					</field>
					<item xsi:type="DataSetQuery">
						<name>ВозвратТоваровОтКлиента</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерСтроки</dataPath>
							<field>НомерСтроки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НаименованиеПолное</dataPath>
							<field>НаименованиеПолное</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование полное</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Характеристика номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Номер ГТД</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Тип единицы</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Страна</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Единица измерения</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Серия номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ВозвратТоваровОтКлиентаТовары.НомерСтроки,
	ВозвратТоваровОтКлиентаТовары.Номенклатура,
	ВозвратТоваровОтКлиентаТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА ВозвратТоваровОтКлиентаТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА ВозвратТоваровОтКлиентаТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ВозвратТоваровОтКлиентаТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВозвратТоваровОтКлиентаТовары.Номенклатура.Наименование КАК Наименование,
	ВозвратТоваровОтКлиентаТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	ВозвратТоваровОтКлиентаТовары.Цена,
	ВозвратТоваровОтКлиентаТовары.СтавкаНДС,
	Неопределено КАК СерияНоменклатуры,
	Неопределено КАК Страна,
	Неопределено КАК НомерГТД,
	ВозвратТоваровОтКлиентаТовары.КоличествоУпаковок КАК Количество,
	ВозвратТоваровОтКлиентаТовары.Сумма,
	ВозвратТоваровОтКлиентаТовары.СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.ВозвратТоваровОтКлиента.Товары КАК ВозвратТоваровОтКлиентаТовары
ГДЕ
	ВозвратТоваровОтКлиентаТовары.Ссылка В(&amp;Ссылка)</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваровУслуг</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерСтроки</dataPath>
							<field>НомерСтроки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НаименованиеПолное</dataPath>
							<field>НаименованиеПолное</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование полное</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Характеристика номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Номер ГТД</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Тип единицы</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Страна</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Единица измерения</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Серия номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.НомерСтроки,
	ПоступлениеТоваровУслугТовары.Номенклатура,
	ПоступлениеТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА ПоступлениеТоваровУслугТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА ПоступлениеТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ПоступлениеТоваровУслугТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	ПоступлениеТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	Неопределено КАК СерияНоменклатуры,
	Неопределено КАК Страна,
	Неопределено КАК НомерГТД,
	ПоступлениеТоваровУслугТовары.КоличествоУпаковок КАК Количество,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка В(&amp;Ссылка)</query>
					</item>
				</item>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Поступление_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докЗаказПоставщику.Ссылка КАК PORDERS,
	докЗаказПоставщику.Ссылка КАК ORDERS,
	докЗаказПоставщику.Ссылка КАК ORDRSP,
	докПоступлениеТоваровУслуг.Ссылка КАК DESADV,
	докПоступлениеТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураПолученныйДокументыОснования.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураПолученный.ДокументыОснования КАК СчетФактураПолученныйДокументыОснования
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваровУслуг КАК докПоступлениеТоваровУслуг
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПоставщику КАК докЗаказПоставщику
				ПО (докПоступлениеТоваровУслуг.ЗаказПоставщику = докЗаказПоставщику.Ссылка)}
			ПО (СчетФактураПолученныйДокументыОснования.ДокументОснование = докПоступлениеТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТовары1СВEDIВ_GTIN</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ РАЗЛИЧНЫЕ
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ТабТоваров.Номенклатура.Код КАК КодТовараСвой,
	ВЫРАЗИТЬ(Штрихкоды.Штрихкод КАК СТРОКА(14)) КАК GTIN
ПОМЕСТИТЬ ВТШтрихкодыТоваров
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ШтрихкодыНоменклатуры КАК Штрихкоды
		ПО ТабТоваров.Номенклатура = Штрихкоды.Номенклатура
			И ТабТоваров.ХарактеристикаНоменклатуры = Штрихкоды.Характеристика
			И ТабТоваров.ЕдиницаИзмерения = Штрихкоды.Упаковка
ГДЕ
	&amp;ИскатьТоварПоШК

ИНДЕКСИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения</query>
				<autoFillFields>false</autoFillFields>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_ORDERS_</name>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПоставщику</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказПоставщикуТовары.Номенклатура.Код КАК КодТовараПокупателя,
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА ЗаказПоставщикуТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА ЗаказПоставщикуТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ЗаказПоставщикуТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ЗаказПоставщикуТовары.Номенклатура.Наименование КАК Наименование,
	ЗаказПоставщикуТовары.Цена,
	ЗаказПоставщикуТовары.СтавкаНДС,
	СУММА(ЗаказПоставщикуТовары.КоличествоУпаковок) КАК Количество,
	СУММА(ЗаказПоставщикуТовары.Сумма) КАК Сумма,
	СУММА(ЗаказПоставщикуТовары.СуммаНДС) КАК СуммаНДС
ИЗ
	Документ.ЗаказПоставщику.Товары КАК ЗаказПоставщикуТовары
ГДЕ
	ЗаказПоставщикуТовары.Ссылка = &amp;Ссылка
	И НЕ ЗаказПоставщикуТовары.Отменено

СГРУППИРОВАТЬ ПО
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.Характеристика,
	ЗаказПоставщикуТовары.Цена,
	ЗаказПоставщикуТовары.Номенклатура.Наименование,
	ЗаказПоставщикуТовары.СтавкаНДС,
	ЗаказПоставщикуТовары.Номенклатура.Код,
	ВЫБОР
		КОГДА ЗаказПоставщикуТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА ЗаказПоставщикуТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ЗаказПоставщикуТовары.Упаковка
	КОНЕЦ</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RECADV_</name>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.Номенклатура,
	ПоступлениеТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА ПоступлениеТоваровУслугТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА ПоступлениеТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ПоступлениеТоваровУслугТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК Наименование,
	ПоступлениеТоваровУслугТовары.КоличествоУпаковок КАК Количество,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка = &amp;Ссылка</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТоварыEDIВ1С</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ТабТоваров.GTIN КАК GTIN,
	ТабТоваров.КодТовараСторонний КАК КодТовараСторонний,
	ТабТоваров.КодТовараСвой КАК КодТовараСвой,
	ТабСоответствий_КонтурEDI.Номенклатура КАК Номенклатура,
	ТабСоответствий_КонтурEDI.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ТабСоответствий_КонтурEDI.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	3 КАК Приоритет
ПОМЕСТИТЬ ВТ_НайденныеСоответствия
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТабСоответствий_КонтурEDI КАК ТабСоответствий_КонтурEDI
		ПО ТабТоваров.GTIN = ТабСоответствий_КонтурEDI.GTIN
			И ТабТоваров.КодТовараСторонний = ТабСоответствий_КонтурEDI.КодТовараСторонний
			И ТабТоваров.КодТовараСвой = ТабСоответствий_КонтурEDI.КодТовараСвой

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	СправочникНоменклатура.Ссылка,
	НЕОПРЕДЕЛЕНО,
	СправочникНоменклатура.ЕдиницаИзмерения,
	2
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК СправочникНоменклатура
		ПО ТабТоваров.КодТовараСвой = СправочникНоменклатура.Код
ГДЕ
	(НЕ ТабТоваров.КодТовараСвой = "")

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	Штрихкоды.Номенклатура,
	Штрихкоды.Характеристика,
	Штрихкоды.Упаковка,
	1
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ШтрихкодыНоменклатуры КАК Штрихкоды
		ПО (ПОДСТРОКА(ТабТоваров.GTIN, 2, 13) = Штрихкоды.Штрихкод)
			
ГДЕ
	(НЕ ТабТоваров.GTIN = "")</query>
				<autoFillFields>false</autoFillFields>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>ДалионУМ</name>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Накладная</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	Заказ.Ссылка КАК PORDERS,
	Заказ.Ссылка КАК ORDERS,
	Заказ.Ссылка КАК ORDRSP,
	ПриходнаяНакладная.Ссылка КАК RECADV,
	ПриходнаяНакладная.Ссылка КАК DESADV,
	ПриходнаяНакладная.Ссылка КАК INVOIC 
	
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ПриходнаяНакладная КАК ПриходнаяНакладная
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПоставщику КАК Заказ
			ПО ПриходнаяНакладная.ДокументОснование = Заказ.Ссылка}
		ПО (ИСТИНА)}
		</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_ORDERS_</name>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПоставщику</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказПоставщикуТовары.Номенклатура.Код КАК КодТовараПокупателя,
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.ХарактеристикаНоменклатуры,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ЗаказПоставщикуТовары.Номенклатура.Наименование КАК Наименование,
	ЗаказПоставщикуТовары.Цена,
	ЗаказПоставщикуТовары.СтавкаНДС,
	СУММА(ЗаказПоставщикуТовары.Количество) КАК Количество,
	СУММА(ЗаказПоставщикуТовары.Сумма) КАК Сумма,
	СУММА(ЗаказПоставщикуТовары.СуммаНДС) КАК СуммаНДС
ИЗ
	Документ.ЗаказПоставщику.Товары КАК ЗаказПоставщикуТовары
ГДЕ
	ЗаказПоставщикуТовары.Ссылка = &amp;Ссылка

СГРУППИРОВАТЬ ПО
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.ХарактеристикаНоменклатуры,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения,
	ЗаказПоставщикуТовары.Цена,
	ЗаказПоставщикуТовары.Номенклатура.Наименование,
	ЗаказПоставщикуТовары.СтавкаНДС,
	ЗаказПоставщикуТовары.Номенклатура.Код</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RECADV_</name>
					<item xsi:type="DataSetQuery">
						<name>ПриходнаяНакладная</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПриходнаяНакладная.Номенклатура,
	ПриходнаяНакладная.ХарактеристикаНоменклатуры,
	ПриходнаяНакладная.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ПриходнаяНакладная.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ПриходнаяНакладная.Номенклатура.Наименование КАК Наименование,
	ПриходнаяНакладная.Количество КАК Количество,
	ПриходнаяНакладная.Цена,
	ПриходнаяНакладная.СтавкаНДС,
	ПриходнаяНакладная.Сумма,
	ПриходнаяНакладная.СуммаНДС
ИЗ
	Документ.ПриходнаяНакладная.Товары КАК ПриходнаяНакладная
ГДЕ
	ПриходнаяНакладная.Ссылка = &amp;Ссылка
</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТоварыEDIВ1С</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ТабТоваров.GTIN КАК GTIN,
	ТабТоваров.КодТовараСторонний КАК КодТовараСторонний,
	ТабТоваров.КодТовараСвой КАК КодТовараСвой,
	ТабСоответствий_КонтурEDI.Номенклатура КАК Номенклатура,
	ТабСоответствий_КонтурEDI.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ТабСоответствий_КонтурEDI.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	3 КАК Приоритет
ПОМЕСТИТЬ ВТ_НайденныеСоответствия
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТабСоответствий_КонтурEDI КАК ТабСоответствий_КонтурEDI
		ПО ТабТоваров.GTIN = ТабСоответствий_КонтурEDI.GTIN
			И ТабТоваров.КодТовараСторонний = ТабСоответствий_КонтурEDI.КодТовараСторонний
			И ТабТоваров.КодТовараСвой = ТабСоответствий_КонтурEDI.КодТовараСвой

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	СправочникНоменклатура.Ссылка,
	НЕОПРЕДЕЛЕНО,
	СправочникНоменклатура.ЕдиницаИзмеренияОтчетов,
	2
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК СправочникНоменклатура
		ПО ТабТоваров.КодТовараСвойЧисло = СправочникНоменклатура.Код
ГДЕ
	(НЕ ТабТоваров.КодТовараСвой = "")

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	Штрихкоды.Номенклатура,
	Штрихкоды.ХарактеристикаНоменклатуры,
	Штрихкоды.ЕдиницаИзмерения,
	1
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО (ПОДСТРОКА(ТабТоваров.GTIN, 1, 13) = Штрихкоды.Штрихкод)
ГДЕ
	(НЕ ТабТоваров.GTIN = "")</query>
				<autoFillFields>false</autoFillFields>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТовары1СВEDIВ_GTIN</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ РАЗЛИЧНЫЕ
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ТабТоваров.Номенклатура.Код КАК КодТовараСвой,
	ВЫРАЗИТЬ(Штрихкоды.Штрихкод КАК СТРОКА(14)) КАК GTIN
ПОМЕСТИТЬ ВТШтрихкодыТоваров
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО ТабТоваров.Номенклатура = Штрихкоды.Номенклатура
			И (Штрихкоды.НеИспользуется = ЛОЖЬ)
ГДЕ
	&amp;ИскатьТоварПоШК

ИНДЕКСИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения</query>
				<autoFillFields>false</autoFillFields>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>РасходнаяНакладная_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РасходнаяНакладная.Ссылка КАК PORDERS,
	РасходнаяНакладная.Ссылка КАК ORDERS,
	РасходнаяНакладная.Ссылка КАК ORDRSP,
	РасходнаяНакладная.Ссылка КАК DESADV,
	РасходнаяНакладная.Ссылка КАК RECADV,
	СчетФактура.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактура КАК СчетФактура
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РасходнаяНакладная КАК РасходнаяНакладная
			ПО СчетФактура.ДокументОснование = РасходнаяНакладная.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_DESADV_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>РасходнаяНакладная</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РасходнаяНакладнаяТовары.НомерСтроки,
	РасходнаяНакладнаяТовары.Номенклатура,
	РасходнаяНакладнаяТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РасходнаяНакладнаяТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	РасходнаяНакладнаяТовары.Номенклатура.Наименование КАК Наименование,
	РасходнаяНакладнаяТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	РасходнаяНакладнаяТовары.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	Неопределено КАК СерияНоменклатуры,
	РасходнаяНакладнаяТовары.Цена,
	РасходнаяНакладнаяТовары.СтавкаНДС,
	Значение(Справочник.КлассификаторСтранМира.) КАК Страна,
	Значение(Справочник.НомераГТД.) КАК НомерГТД,
	РасходнаяНакладнаяТовары.Количество КАК Количество,
	РасходнаяНакладнаяТовары.Сумма КАК Сумма,
	РасходнаяНакладнаяТовары.СуммаНДС КАК СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.РасходнаяНакладная.Товары КАК РасходнаяНакладнаяТовары
ГДЕ
	РасходнаяНакладнаяТовары.Ссылка В (&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное,
	ВозвратТоваровОтПокупателяТовары.ХарактеристикаНоменклатуры,
	Неопределено КАК СерияНоменклатуры,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	ВозвратТоваровОтПокупателяТовары.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяТовары.НомерГТД,
	-ВозвратТоваровОтПокупателяТовары.Количество,
	-ВозвратТоваровОтПокупателяТовары.Сумма,
	-ВозвратТоваровОтПокупателяТовары.СуммаНДС КАК СуммаНДС,
	NULL
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>ХБКП_УСП</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕдиницаИзмерения</dataPath>
			<field>ЕдиницаИзмерения</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КодЕдиницыИзмерения</dataPath>
			<field>КодЕдиницыИзмерения</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Количество</dataPath>
			<field>Количество</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Номенклатура</dataPath>
			<field>Номенклатура</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НоменклатураСтавкаНДС</dataPath>
			<field>НоменклатураСтавкаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Сумма</dataPath>
			<field>Сумма</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаНДС</dataPath>
			<field>СуммаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ХарактеристикаНоменклатуры</dataPath>
			<field>ХарактеристикаНоменклатуры</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Цена</dataPath>
			<field>Цена</field>
		</field>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЕдиницаИзмерения</dataPath>
				<field>ЕдиницаИзмерения</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КодЕдиницыИзмерения</dataPath>
				<field>КодЕдиницыИзмерения</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Количество</dataPath>
				<field>Количество</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Номенклатура</dataPath>
				<field>Номенклатура</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НоменклатураСтавкаНДС</dataPath>
				<field>НоменклатураСтавкаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма</dataPath>
				<field>Сумма</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаНДС</dataPath>
				<field>СуммаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ХарактеристикаНоменклатуры</dataPath>
				<field>ХарактеристикаНоменклатуры</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Цена</dataPath>
				<field>Цена</field>
			</field>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>ЗаказПокупателя_Реализация_СчетФактураВыданный</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докЗаказПокупателя.Ссылка КАК PORDERS,
	докЗаказПокупателя.Ссылка КАК ORDERS,
	докЗаказПокупателя.Ссылка КАК ORDRSP,
	докРеализация.Ссылка КАК DESADV,
	докРеализация.Ссылка КАК RECADV,
	СчетФактураВыданныйДокументыОснования.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.Реализация КАК докРеализация
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПокупателя КАК докЗаказПокупателя
				ПО докРеализация.ДокументОснование = докЗаказПокупателя.Ссылка}
			ПО СчетФактураВыданныйДокументыОснования.ДокументОснование = докРеализация.Ссылка}
		ПО (ИСТИНА)}</query>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЕдиницаИзмерения</dataPath>
					<field>ЕдиницаИзмерения</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КодЕдиницыИзмерения</dataPath>
					<field>КодЕдиницыИзмерения</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Количество</dataPath>
					<field>Количество</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Номенклатура</dataPath>
					<field>Номенклатура</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НоменклатураСтавкаНДС</dataPath>
					<field>НоменклатураСтавкаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Сумма</dataPath>
					<field>Сумма</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СуммаНДС</dataPath>
					<field>СуммаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ХарактеристикаНоменклатуры</dataPath>
					<field>ХарактеристикаНоменклатуры</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Цена</dataPath>
					<field>Цена</field>
				</field>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КодЕдиницыИзмерения</dataPath>
						<field>КодЕдиницыИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Количество</dataPath>
						<field>Количество</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НоменклатураСтавкаНДС</dataPath>
						<field>НоменклатураСтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Сумма</dataPath>
						<field>Сумма</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаНДС</dataPath>
						<field>СуммаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ХарактеристикаНоменклатуры</dataPath>
						<field>ХарактеристикаНоменклатуры</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПокупателя</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодЕдиницыИзмерения</dataPath>
							<field>КодЕдиницыИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НоменклатураСтавкаНДС</dataPath>
							<field>НоменклатураСтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query> ВЫБРАТЬ
	ЗаказПокупателяТовары.Номенклатура,
	Неопределено как ХарактеристикаНоменклатуры,
	ЗаказПокупателяТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказПокупателяТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	0 КАК Цена,
	ЗаказПокупателяТовары.Номенклатура.СтавкаНДС,
	ЗаказПокупателяТовары.Количество КАК Количество,
	0 КАК Сумма,
	0 КАК СуммаНДС
ИЗ
	Документ.ЗаказПокупателя.Товары КАК ЗаказПокупателяТовары
ГДЕ
	ЗаказПокупателяТовары.Ссылка в (&amp;Ссылка)</query>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_DESADV_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>Реализация</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТовары.НомерСтроки,
	РеализацияТовары.Номенклатура,
	Неопределено КАК ХарактеристикаНоменклатуры,
	РеализацияТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РеализацияТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	РеализацияТовары.Номенклатура.Наименование КАК Наименование,
	РеализацияТовары.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
	РеализацияТовары.Цена,
	РеализацияТовары.СтавкаНДС,
	Неопределено КАК СерияНоменклатуры,
	РеализацияТовары.Номенклатура.СтранаПроисхождения КАК Страна,
	РеализацияТовары.Номенклатура.НомерГТД.Код КАК НомерГТД,
	РеализацияТовары.Количество КАК Количество,
	РеализацияТовары.Сумма КАК Сумма,
	РеализацияТовары.СуммаНДС,
	NULL КАК ТипЕдиницы
ИЗ
	Документ.Реализация.Товары КАК РеализацияТовары
ГДЕ
	РеализацияТовары.Ссылка в (&amp;Ссылка)</query>
					</item>
				</item>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
			</item>
		</item>
	</dataSet>
	<parameter>
		<name>Ссылка</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Ссылка</v8:content>
			</v8:item>
		</title>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>ОтправлятьВозвратнуюТару</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Отправлять возвратную тару</v8:content>
			</v8:item>
		</title>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>Возвраты</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Возвраты</v8:content>
			</v8:item>
		</title>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
	</parameter>
	<settingsVariant>
		<dcsset:name>Основной</dcsset:name>
		<dcsset:presentation xsi:type="xs:string">Основной</dcsset:presentation>
		<dcsset:settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows"/>
	</settingsVariant>
</DataCompositionSchema>