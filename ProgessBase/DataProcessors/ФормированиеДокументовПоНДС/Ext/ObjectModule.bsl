#Если Клиент Тогда
// Основная функция действия формирования документов.
//
// Параметры
//	УдалятьУчтенныеДокументы - булево, если Истина, 
//			то в транзакции формирования документов
//			сформированные документы будут проводиться
//			а учтенные - помечаться на удаление.
//
// Возвращаемое значение
//  Истина - документы сформированы успешно
Функция СформироватьДокументы() Экспорт
	
	Заголовок   = "Формирование документов по настройке " + Настройка + " на дату " + Формат(КонецМесяца(ДатаФормирования), "ДЛФ=ДД");
	ТекстОшибки = "";
	
	//Выполним логику, находящуюся в регламенте
	МассивСформированныеДокументы = Неопределено;
	МассивУчтенныеДокументы		  = Неопределено;
		
	Если Не ЗначениеЗаполнено(Организация) Тогда
		Возврат Ложь;
	КонецЕсли;
	
	НастройкаСтруктура = Новый Структура("Организация, Дата", Организация, ДатаФормирования);
	
	НачатьТранзакцию();
	
	СписокСформированныхДокументов = Неопределено;
	
	УчетНДСФормированиеДвижений.СформироватьРегламентныеДокументыПоНДС(НастройкаСтруктура, СписокСформированныхДокументов);
	
	ЗафиксироватьТранзакцию();
	
	Для Каждого Документ Из СписокСформированныхДокументов Цикл
		СформированныеДокументы.Добавить().Документ = Документ;
	КонецЦикла;
	
	Возврат Истина;
	
КонецФункции //СформироватьДокументы()

// Заполняет период формирования по данным настройки
//
Процедура ЗаполнитьДаннымиНастройки() Экспорт
	
	//Период определяется настройкой
	Если Настройка.Пустая() Тогда
		
	Иначе
		
		Организация = Настройка.Организация;
		
	КонецЕсли;
	
	СформированныеДокументы.Очистить();
	
КонецПроцедуры
#КонецЕсли
