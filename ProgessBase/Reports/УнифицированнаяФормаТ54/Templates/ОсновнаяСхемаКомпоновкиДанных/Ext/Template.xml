<?xml version="1.0" encoding="UTF-8"?>
<DataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema" xmlns:dcscom="http://v8.1c.ru/8.1/data-composition-system/common" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataSource>
		<name>ИсточникДанных1</name>
		<dataSourceType>Local</dataSourceType>
	</dataSource>
	<dataSet xsi:type="DataSetQuery">
		<name>СписокСотрудников</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>ГоловнаяОрганизация</dataPath>
			<field>ГоловнаяОрганизация</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Головная организация</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Должность</dataPath>
			<field>Должность</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Должность</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Организация</dataPath>
			<field>Организация</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Организация</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПериодРегистрации</dataPath>
			<field>ПериодРегистрации</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Период регистрации</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПодразделениеОрганизации</dataPath>
			<field>ПодразделениеОрганизации</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Подразделение организации</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Сотрудник</dataPath>
			<field>Сотрудник</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сотрудник</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Физлицо</dataPath>
			<field>Физлицо</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Физ. лицо</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ВидДоговора</dataPath>
			<field>ВидДоговора</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Вид договора</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КатегорияСтатистическогоУчета</dataPath>
			<field>КатегорияСтатистическогоУчета</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Категория статистического учета</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ТабельныйНомер</dataPath>
			<field>ТабельныйНомер</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Табельный номер</v8:content>
				</v8:item>
			</title>
		</field>
		<dataSource>ИсточникДанных1</dataSource>
		<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК ПериодРегистрации
ПОМЕСТИТЬ Периоды
ИЗ
	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
ГДЕ
	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо,
	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник,
	ОсновныеНачисленияРаботниковОрганизаций.ОбособленноеПодразделение КАК Организация,
	ОсновныеНачисленияРаботниковОрганизаций.Организация КАК ГоловнаяОрганизация,
	НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ) КАК ПериодРегистрации,
	ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяССылка) КАК ПодразделениеОрганизации,
	ЗНАЧЕНИЕ(Справочник.ДолжностиОрганизаций.ПустаяССылка) КАК Должность
ПОМЕСТИТЬ НеСотрудники
ИЗ
	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
		ПО (ДоговорНаВыполнениеРаботСФизЛицом.Проведен)
			И ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо = ДоговорНаВыполнениеРаботСФизЛицом.ФизЛицо
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
		ПО ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо = РаботникиОрганизаций.Сотрудник.Физлицо
ГДЕ
	РаботникиОрганизаций.Сотрудник ЕСТЬ NULL 
	И ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник ЕСТЬ NULL 
	И ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода

ОБЪЕДИНИТЬ

ВЫБРАТЬ РАЗЛИЧНЫЕ
	ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо,
	ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
	ДополнительныеНачисленияРаботниковОрганизаций.ОбособленноеПодразделение,
	ДополнительныеНачисленияРаботниковОрганизаций.Организация,
	НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ),
	ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяССылка),
	ЗНАЧЕНИЕ(Справочник.ДолжностиОрганизаций.ПустаяССылка)
ИЗ
	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
		ПО (ДоговорНаВыполнениеРаботСФизЛицом.Проведен)
			И ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо = ДоговорНаВыполнениеРаботСФизЛицом.ФизЛицо
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
		ПО ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо = РаботникиОрганизаций.Сотрудник.Физлицо
ГДЕ
	РаботникиОрганизаций.Сотрудник ЕСТЬ NULL 
	И ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник ЕСТЬ NULL 
	И ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ДатыПоследнихДвижений.ПериодРегистрации КАК ПериодРегистрации,
	ДатыПоследнихДвижений.Физлицо КАК Физлицо,
	ВЫБОР
		КОГДА ДатыПоследнихДвижений.Организация.ГоловнаяОрганизация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
			ТОГДА ДатыПоследнихДвижений.Организация
		ИНАЧЕ ДатыПоследнихДвижений.Организация.ГоловнаяОрганизация
	КОНЕЦ КАК ГоловнаяОрганизация,
	ДатыПоследнихДвижений.Организация КАК Организация,
	ВЫБОР
		КОГДА Работающие.Сотрудник ЕСТЬ НЕ NULL 
			ТОГДА ВЫБОР
					КОГДА Работающие.ПериодЗавершения &lt;= КОНЕЦПЕРИОДА(ДатыПоследнихДвижений.ПериодРегистрации, МЕСЯЦ)
							И Работающие.ПериодЗавершения &lt;&gt; ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
						ТОГДА Работающие.ПодразделениеОрганизацииЗавершения
					ИНАЧЕ Работающие.ПодразделениеОрганизации
				КОНЕЦ
		КОГДА Уволенные.Сотрудник ЕСТЬ НЕ NULL 
			ТОГДА ВЫБОР
					КОГДА Уволенные.ПериодЗавершения &lt;= КОНЕЦПЕРИОДА(ДатыПоследнихДвижений.ПериодРегистрации, МЕСЯЦ)
							И Уволенные.ПериодЗавершения &lt;&gt; ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
						ТОГДА Уволенные.ПодразделениеОрганизацииЗавершения
					ИНАЧЕ Уволенные.ПодразделениеОрганизации
				КОНЕЦ
		ИНАЧЕ NULL
	КОНЕЦ КАК Подразделение,
	ВЫБОР
		КОГДА Работающие.Сотрудник ЕСТЬ НЕ NULL 
			ТОГДА ВЫБОР
					КОГДА Работающие.ПериодЗавершения &lt;= КОНЕЦПЕРИОДА(ДатыПоследнихДвижений.ПериодРегистрации, МЕСЯЦ)
							И Работающие.ПериодЗавершения &lt;&gt; ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
						ТОГДА Работающие.ДолжностьЗавершения
					ИНАЧЕ Работающие.Должность
				КОНЕЦ
		КОГДА Уволенные.Сотрудник ЕСТЬ НЕ NULL 
			ТОГДА ВЫБОР
					КОГДА Уволенные.ПериодЗавершения &lt;= КОНЕЦПЕРИОДА(ДатыПоследнихДвижений.ПериодРегистрации, МЕСЯЦ)
							И Уволенные.ПериодЗавершения &lt;&gt; ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
						ТОГДА Уволенные.ДолжностьЗавершения
					ИНАЧЕ Уволенные.Должность
				КОНЕЦ
		ИНАЧЕ NULL
	КОНЕЦ КАК Должность,
	ВЫБОР
		КОГДА Работающие.Сотрудник ЕСТЬ НЕ NULL 
			ТОГДА ВЫБОР
					КОГДА Работающие.ПериодЗавершения &lt;= КОНЕЦПЕРИОДА(ДатыПоследнихДвижений.ПериодРегистрации, МЕСЯЦ)
							И Работающие.ПериодЗавершения &lt;&gt; ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
							И Работающие.ПричинаИзмененияСостоянияЗавершения = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
						ТОГДА Работающие.ПериодЗавершения
					ИНАЧЕ ДАТАВРЕМЯ(1, 1, 1)
				КОНЕЦ
		КОГДА Уволенные.Сотрудник ЕСТЬ НЕ NULL 
				И Работающие.Сотрудник ЕСТЬ NULL 
			ТОГДА Уволенные.Период
		ИНАЧЕ ДАТАВРЕМЯ(1, 1, 1)
	КОНЕЦ КАК ДатаУвольнения,
	ВЫБОР
		КОГДА Работающие.Сотрудник ЕСТЬ НЕ NULL 
			ТОГДА Работающие.Сотрудник
		КОГДА Уволенные.Сотрудник ЕСТЬ НЕ NULL 
				И Работающие.Сотрудник ЕСТЬ NULL 
			ТОГДА Уволенные.Сотрудник
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.СотрудникиОрганизаций.ПустаяСсылка)
	КОНЕЦ КАК Сотрудник
ПОМЕСТИТЬ Работники
ИЗ
	(ВЫБРАТЬ
		Периоды.ПериодРегистрации КАК ПериодРегистрации,
		МАКСИМУМ(РаботникиОрганизаций.Период) КАК Период,
		РаботникиОрганизаций.Сотрудник.Физлицо КАК Физлицо,
		ВЫБОР
			КОГДА РаботникиОрганизаций.ПериодЗавершения &lt;= КОНЕЦПЕРИОДА(Периоды.ПериодРегистрации, МЕСЯЦ)
					И РаботникиОрганизаций.ПериодЗавершения &lt;&gt; ДАТАВРЕМЯ(1, 1, 1)
				ТОГДА РаботникиОрганизаций.ОбособленноеПодразделениеЗавершения
			ИНАЧЕ РаботникиОрганизаций.ОбособленноеПодразделение
		КОНЕЦ КАК Организация
	ИЗ
		Периоды КАК Периоды
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
			ПО (РаботникиОрганизаций.Период &lt;= КОНЕЦПЕРИОДА(Периоды.ПериодРегистрации, МЕСЯЦ))
	ГДЕ
		РаботникиОрганизаций.Сотрудник.ВидЗанятости &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
	{ГДЕ
		РаботникиОрганизаций.Сотрудник.Физлицо.* КАК Физлицо}
	
	СГРУППИРОВАТЬ ПО
		Периоды.ПериодРегистрации,
		РаботникиОрганизаций.Сотрудник.Физлицо,
		ВЫБОР
			КОГДА РаботникиОрганизаций.ПериодЗавершения &lt;= КОНЕЦПЕРИОДА(Периоды.ПериодРегистрации, МЕСЯЦ)
					И РаботникиОрганизаций.ПериодЗавершения &lt;&gt; ДАТАВРЕМЯ(1, 1, 1)
				ТОГДА РаботникиОрганизаций.ОбособленноеПодразделениеЗавершения
			ИНАЧЕ РаботникиОрганизаций.ОбособленноеПодразделение
		КОНЕЦ) КАК ДатыПоследнихДвижений
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК Работающие
		ПО ДатыПоследнихДвижений.Физлицо = Работающие.Сотрудник.Физлицо
			И ДатыПоследнихДвижений.Период = Работающие.Период
			И (Работающие.ПричинаИзмененияСостояния &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение))
			И (Работающие.Сотрудник.ВидЗанятости &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
			И (ДатыПоследнихДвижений.Организация = ВЫБОР
				КОГДА Работающие.ПериодЗавершения &lt;= КОНЕЦПЕРИОДА(ДатыПоследнихДвижений.ПериодРегистрации, МЕСЯЦ)
						И Работающие.ПериодЗавершения &lt;&gt; ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Работающие.ОбособленноеПодразделениеЗавершения
				ИНАЧЕ Работающие.ОбособленноеПодразделение
			КОНЕЦ)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК Уволенные
		ПО ДатыПоследнихДвижений.Физлицо = Уволенные.Сотрудник.Физлицо
			И ДатыПоследнихДвижений.Период = Уволенные.Период
			И (Уволенные.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение))
			И (Уволенные.Сотрудник.ВидЗанятости &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство))
			И (ДатыПоследнихДвижений.Организация = ВЫБОР
				КОГДА Уволенные.ПериодЗавершения &lt;= КОНЕЦПЕРИОДА(ДатыПоследнихДвижений.ПериодРегистрации, МЕСЯЦ)
						И Уволенные.ПериодЗавершения &lt;&gt; ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА Уволенные.ОбособленноеПодразделениеЗавершения
				ИНАЧЕ Уволенные.ОбособленноеПодразделение
			КОНЕЦ)
{ГДЕ
	ДатыПоследнихДвижений.ПериодРегистрации,
	ДатыПоследнихДвижений.Физлицо.*,
	ДатыПоследнихДвижений.Организация.*,
	(ВЫБОР
			КОГДА Работающие.Сотрудник ЕСТЬ НЕ NULL 
				ТОГДА ВЫБОР
						КОГДА Работающие.ПериодЗавершения &lt;= КОНЕЦПЕРИОДА(ДатыПоследнихДвижений.ПериодРегистрации, МЕСЯЦ)
								И Работающие.ПериодЗавершения &lt;&gt; ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
							ТОГДА Работающие.ОбособленноеПодразделениеЗавершения
						ИНАЧЕ Работающие.ОбособленноеПодразделение
					КОНЕЦ
			КОГДА Уволенные.Сотрудник ЕСТЬ НЕ NULL 
				ТОГДА ВЫБОР
						КОГДА Уволенные.ПериодЗавершения &lt;= КОНЕЦПЕРИОДА(ДатыПоследнихДвижений.ПериодРегистрации, МЕСЯЦ)
								И Уволенные.ПериодЗавершения &lt;&gt; ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
							ТОГДА Уволенные.ОбособленноеПодразделениеЗавершения
						ИНАЧЕ Уволенные.ОбособленноеПодразделение
					КОНЕЦ
			ИНАЧЕ NULL
		КОНЕЦ).* КАК Организация}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Договор.ПериодРегистрации,
	Договор.Организация,
	Договор.Физлицо,
	Договор.Должность КАК Должность,
	Договор.ГоловнаяОрганизация,
	ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации,
	ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания,
	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник
ПОМЕСТИТЬ Договорники
ИЗ
	(ВЫБРАТЬ
		ДатыПоследнихДоговоров.ПериодРегистрации КАК ПериодРегистрации,
		ДатыПоследнихДоговоров.Организация КАК Организация,
		ДатыПоследнихДоговоров.Физлицо КАК Физлицо,
		ЗНАЧЕНИЕ(Справочник.ДолжностиОрганизаций.ПустаяСсылка) КАК Должность,
		ВЫБОР
			КОГДА ДоговорНаВыполнениеРаботСФизЛицом.Организация.ГоловнаяОрганизация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
				ТОГДА ДоговорНаВыполнениеРаботСФизЛицом.Организация
			ИНАЧЕ ДоговорНаВыполнениеРаботСФизЛицом.Организация.ГоловнаяОрганизация
		КОНЕЦ КАК ГоловнаяОрганизация,
		МАКСИМУМ(ДоговорНаВыполнениеРаботСФизЛицом.Ссылка) КАК Ссылка
	ИЗ
		(ВЫБРАТЬ
			Договора.Физлицо КАК Физлицо,
			Договора.Организация КАК Организация,
			МАКСИМУМ(Договора.ДатаНачала) КАК ДатаНачала,
			Периоды.ПериодРегистрации КАК ПериодРегистрации
		ИЗ
			Периоды КАК Периоды
				ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
					ДоговорНаВыполнениеРаботСФизЛицом.ФизЛицо КАК Физлицо,
					ДоговорНаВыполнениеРаботСФизЛицом.Организация КАК Организация,
					ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала КАК ДатаНачала,
					ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания КАК ДатаОкончания
				ИЗ
					Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
				ГДЕ
					ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала &lt;= &amp;КонецПериода
					И ДоговорНаВыполнениеРаботСФизЛицом.Проведен
				{ГДЕ
					ДоговорНаВыполнениеРаботСФизЛицом.ФизЛицо.*,
					ДоговорНаВыполнениеРаботСФизЛицом.Организация.*}) КАК Договора
				ПО (Договора.ДатаНачала &lt;= КОНЕЦПЕРИОДА(Периоды.ПериодРегистрации, МЕСЯЦ))
		
		СГРУППИРОВАТЬ ПО
			Договора.Физлицо,
			Договора.Организация,
			Периоды.ПериодРегистрации) КАК ДатыПоследнихДоговоров
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
			ПО ДатыПоследнихДоговоров.Физлицо = ДоговорНаВыполнениеРаботСФизЛицом.ФизЛицо
				И ДатыПоследнихДоговоров.Организация = ДоговорНаВыполнениеРаботСФизЛицом.Организация
				И ДатыПоследнихДоговоров.ДатаНачала = ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала
	{ГДЕ
		ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник.*,
		ДоговорНаВыполнениеРаботСФизЛицом.Организация.*,
		ДоговорНаВыполнениеРаботСФизЛицом.ФизЛицо.*}
	
	СГРУППИРОВАТЬ ПО
		ДатыПоследнихДоговоров.Физлицо,
		ДатыПоследнихДоговоров.Организация,
		ДатыПоследнихДоговоров.ПериодРегистрации,
		ВЫБОР
			КОГДА ДоговорНаВыполнениеРаботСФизЛицом.Организация.ГоловнаяОрганизация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
				ТОГДА ДоговорНаВыполнениеРаботСФизЛицом.Организация
			ИНАЧЕ ДоговорНаВыполнениеРаботСФизЛицом.Организация.ГоловнаяОрганизация
		КОНЕЦ) КАК Договор
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
		ПО Договор.Ссылка = ДоговорНаВыполнениеРаботСФизЛицом.Ссылка
{ГДЕ
	Договор.ПериодРегистрации,
	Договор.Организация.*,
	Договор.Физлицо.*,
	Договор.Должность.*,
	Договор.ГоловнаяОрганизация.*}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Работники.ПериодРегистрации КАК ПериодРегистрации,
	Работники.Физлицо КАК Физлицо,
	Работники.ГоловнаяОрганизация КАК ГоловнаяОрганизация,
	Работники.Организация КАК Организация,
	Работники.Подразделение КАК Подразделение,
	Работники.Должность КАК Должность,
	Работники.Сотрудник КАК Сотрудник,
	Работники.Должность.КатегорияСтатистическогоУчета КАК КатегорияСтатистическогоУчета,
	Работники.Сотрудник.ВидДоговора КАК ВидДоговора,
	Работники.Сотрудник.Код КАК ТабельныйНомер
{ВЫБРАТЬ
	ПериодРегистрации,
	Физлицо.*,
	ГоловнаяОрганизация.*,
	Организация.*,
	Подразделение.* КАК ПодразделениеОрганизации,
	Должность.*,
	Сотрудник.*,
	КатегорияСтатистическогоУчета.*,
	ВидДоговора.*,
	ТабельныйНомер}
ИЗ
	Работники КАК Работники
		ЛЕВОЕ СОЕДИНЕНИЕ Договорники КАК Договорники
		ПО Работники.Физлицо = Договорники.Физлицо
			И Работники.ГоловнаяОрганизация = Договорники.ГоловнаяОрганизация
			И Работники.ПериодРегистрации = Договорники.ПериодРегистрации
ГДЕ
	(Работники.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ Работники.ДатаУвольнения &gt; Работники.ПериодРегистрации
			ИЛИ Договорники.Физлицо ЕСТЬ NULL 
			ИЛИ Договорники.ДатаОкончания &lt; Работники.ДатаУвольнения)
	И (Работники.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
			ИЛИ Работники.ДатаУвольнения &gt;= &amp;НачалоПериода)
{ГДЕ
	Работники.ПериодРегистрации,
	Работники.Физлицо.*,
	Работники.ГоловнаяОрганизация.*,
	Работники.Организация.*,
	Работники.Подразделение.* КАК ПодразделениеОрганизации,
	Работники.Должность.*,
	Работники.Сотрудник.*,
	Работники.Должность.КатегорияСтатистическогоУчета.* КАК КатегорияСтатистическогоУчета,
	Работники.Сотрудник.ВидДоговора.* КАК ВидДоговора,
	Работники.Сотрудник.Код КАК ТабельныйНомер}

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	Договорники.ПериодРегистрации,
	Договорники.Физлицо,
	Договорники.ГоловнаяОрганизация,
	Договорники.Организация,
	Договорники.ПодразделениеОрганизации,
	Договорники.Должность,
	Договорники.Сотрудник,
	Договорники.Должность.КатегорияСтатистическогоУчета,
	Договорники.Сотрудник.ВидДоговора,
	Договорники.Сотрудник.Код
ИЗ
	Договорники КАК Договорники
		ЛЕВОЕ СОЕДИНЕНИЕ Работники КАК Работники
		ПО Договорники.Физлицо = Работники.Физлицо
			И Договорники.ГоловнаяОрганизация = Работники.ГоловнаяОрганизация
			И Договорники.ПериодРегистрации = Работники.ПериодРегистрации
ГДЕ
	(Работники.ДатаУвольнения ЕСТЬ NULL 
			ИЛИ Работники.ДатаУвольнения &lt;&gt; ДАТАВРЕМЯ(1, 1, 1)
				И Договорники.ДатаОкончания &gt; Работники.ДатаУвольнения
				И Работники.ДатаУвольнения &lt;= Работники.ПериодРегистрации)
	И Договорники.ДатаОкончания &gt;= &amp;НачалоПериода
{ГДЕ
	Договорники.ПериодРегистрации,
	Договорники.Физлицо.*,
	Договорники.ГоловнаяОрганизация.*,
	Договорники.Организация.*,
	Договорники.ПодразделениеОрганизации.*,
	Договорники.Должность.*,
	Договорники.Сотрудник.*,
	Договорники.Сотрудник.ВидДоговора.* КАК ВидДоговора,
	Договорники.Должность.КатегорияСтатистическогоУчета.* КАК КатегорияСтатистическогоУчета,
	Договорники.Сотрудник.Код КАК ТабельныйНомер}

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	НеСотрудники.ПериодРегистрации,
	НеСотрудники.ФизЛицо,
	НеСотрудники.ГоловнаяОрганизация,
	НеСотрудники.Организация,
	НеСотрудники.ПодразделениеОрганизации,
	НеСотрудники.Должность,
	НеСотрудники.Сотрудник,
	НеСотрудники.Должность.КатегорияСтатистическогоУчета,
	НеСотрудники.Сотрудник.ВидДоговора,
	НеСотрудники.Сотрудник.Код
ИЗ
	НеСотрудники КАК НеСотрудники
{ГДЕ
	НеСотрудники.ПериодРегистрации,
	НеСотрудники.ФизЛицо.*,
	НеСотрудники.ГоловнаяОрганизация.*,
	НеСотрудники.Организация.*,
	НеСотрудники.ПодразделениеОрганизации.*,
	НеСотрудники.Должность.*,
	НеСотрудники.Сотрудник.*,
	НеСотрудники.Должность.КатегорияСтатистическогоУчета.* КАК КатегорияСтатистическогоУчета,
	НеСотрудники.Сотрудник.ВидДоговора.* КАК ВидДоговора,
	НеСотрудники.Сотрудник.Код КАК ТабельныйНомер}
{ХАРАКТЕРИСТИКИ
	ТИП(Справочник.ДолжностиОрганизаций)
	СПИСОК (ВЫБРАТЬ
			СвойстваОбъектов.Ссылка,
			" Дополнительное свойство: " + СвойстваОбъектов.Наименование КАК Наименование,
			СвойстваОбъектов.ТипЗначения
		ИЗ
			ПланВидовХарактеристик.СвойстваОбъектов КАК СвойстваОбъектов
		ГДЕ
			СвойстваОбъектов.НазначениеСвойства = ЗНАЧЕНИЕ(ПланВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Справочник_ДолжностиОрганизаций)
			И (НЕ СвойстваОбъектов.ПометкаУдаления))
	ИДЕНТИФИКАТОР Ссылка
	ИМЯ Наименование
	ТИПЗНАЧЕНИЯ ТипЗначения
	ЗНАЧЕНИЯ РегистрСведений.ЗначенияСвойствОбъектов
	ОБЪЕКТ Объект
	ХАРАКТЕРИСТИКА Свойство
	ЗНАЧЕНИЕ Значение }
{ХАРАКТЕРИСТИКИ
	ТИП(Справочник.ДолжностиОрганизаций)
	СПИСОК (ВЫБРАТЬ
			КатегорииОбъектов.Ссылка,
			" Дополнительная категория: " + КатегорииОбъектов.Наименование КАК Наименование
		ИЗ
			Справочник.КатегорииОбъектов КАК КатегорииОбъектов
		ГДЕ
			КатегорииОбъектов.НазначениеКатегории = ЗНАЧЕНИЕ(ПланВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Справочник_ДолжностиОрганизаций)
			И (НЕ КатегорииОбъектов.ПометкаУдаления))
	ИДЕНТИФИКАТОР Ссылка
	ИМЯ Наименование
	ЗНАЧЕНИЯ РегистрСведений.КатегорииОбъектов
	ОБЪЕКТ Объект
	ХАРАКТЕРИСТИКА Категория }
{ХАРАКТЕРИСТИКИ
	ТИП(Справочник.ПодразделенияОрганизаций)
	СПИСОК (ВЫБРАТЬ
			СвойстваОбъектов.Ссылка,
			" Дополнительное свойство: " + СвойстваОбъектов.Наименование КАК Наименование,
			СвойстваОбъектов.ТипЗначения
		ИЗ
			ПланВидовХарактеристик.СвойстваОбъектов КАК СвойстваОбъектов
		ГДЕ
			СвойстваОбъектов.НазначениеСвойства = ЗНАЧЕНИЕ(ПланВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Справочник_ПодразделенияОрганизаций)
			И (НЕ СвойстваОбъектов.ПометкаУдаления))
	ИДЕНТИФИКАТОР Ссылка
	ИМЯ Наименование
	ТИПЗНАЧЕНИЯ ТипЗначения
	ЗНАЧЕНИЯ РегистрСведений.ЗначенияСвойствОбъектов
	ОБЪЕКТ Объект
	ХАРАКТЕРИСТИКА Свойство
	ЗНАЧЕНИЕ Значение }
{ХАРАКТЕРИСТИКИ
	ТИП(Справочник.СотрудникиОрганизаций)
	СПИСОК (ВЫБРАТЬ
			СвойстваОбъектов.Ссылка,
			" Дополнительное свойство: " + СвойстваОбъектов.Наименование КАК Наименование,
			СвойстваОбъектов.ТипЗначения
		ИЗ
			ПланВидовХарактеристик.СвойстваОбъектов КАК СвойстваОбъектов
		ГДЕ
			СвойстваОбъектов.НазначениеСвойства = ЗНАЧЕНИЕ(ПланВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Справочник_СотрудникиОрганизаций)
			И (НЕ СвойстваОбъектов.ПометкаУдаления))
	ИДЕНТИФИКАТОР Ссылка
	ИМЯ Наименование
	ТИПЗНАЧЕНИЯ ТипЗначения
	ЗНАЧЕНИЯ РегистрСведений.ЗначенияСвойствОбъектов
	ОБЪЕКТ Объект
	ХАРАКТЕРИСТИКА Свойство
	ЗНАЧЕНИЕ Значение }
{ХАРАКТЕРИСТИКИ
	ТИП(Справочник.ПодразделенияОрганизаций)
	СПИСОК (ВЫБРАТЬ
			КатегорииОбъектов.Ссылка,
			" Дополнительная категория: " + КатегорииОбъектов.Наименование КАК Наименование
		ИЗ
			Справочник.КатегорииОбъектов КАК КатегорииОбъектов
		ГДЕ
			КатегорииОбъектов.НазначениеКатегории = ЗНАЧЕНИЕ(ПланВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Справочник_ПодразделенияОрганизаций)
			И (НЕ КатегорииОбъектов.ПометкаУдаления))
	ИДЕНТИФИКАТОР Ссылка
	ИМЯ Наименование
	ЗНАЧЕНИЯ РегистрСведений.КатегорииОбъектов
	ОБЪЕКТ Объект
	ХАРАКТЕРИСТИКА Категория }
{ХАРАКТЕРИСТИКИ
	ТИП(Справочник.СотрудникиОрганизаций)
	СПИСОК (ВЫБРАТЬ
			КатегорииОбъектов.Ссылка,
			" Дополнительная категория: " + КатегорииОбъектов.Наименование КАК Наименование
		ИЗ
			Справочник.КатегорииОбъектов КАК КатегорииОбъектов
		ГДЕ
			КатегорииОбъектов.НазначениеКатегории = ЗНАЧЕНИЕ(ПланВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Справочник_СотрудникиОрганизаций)
			И (НЕ КатегорииОбъектов.ПометкаУдаления))
	ИДЕНТИФИКАТОР Ссылка
	ИМЯ Наименование
	ЗНАЧЕНИЯ РегистрСведений.КатегорииОбъектов
	ОБЪЕКТ Объект
	ХАРАКТЕРИСТИКА Категория }
{ХАРАКТЕРИСТИКИ
	ТИП(Справочник.ФизическиеЛица)
	СПИСОК (ВЫБРАТЬ
			СвойстваОбъектов.Ссылка,
			" Дополнительное свойство: " + СвойстваОбъектов.Наименование КАК Наименование,
			СвойстваОбъектов.ТипЗначения
		ИЗ
			ПланВидовХарактеристик.СвойстваОбъектов КАК СвойстваОбъектов
		ГДЕ
			СвойстваОбъектов.НазначениеСвойства = ЗНАЧЕНИЕ(ПланВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Справочник_ФизическиеЛица)
			И (НЕ СвойстваОбъектов.ПометкаУдаления))
	ИДЕНТИФИКАТОР Ссылка
	ИМЯ Наименование
	ТИПЗНАЧЕНИЯ ТипЗначения
	ЗНАЧЕНИЯ РегистрСведений.ЗначенияСвойствОбъектов
	ОБЪЕКТ Объект
	ХАРАКТЕРИСТИКА Свойство
	ЗНАЧЕНИЕ Значение }
{ХАРАКТЕРИСТИКИ
	ТИП(Справочник.ПодразделенияОрганизаций)
	СПИСОК (ВЫБРАТЬ
			"Ответственное лицо" КАК Идентификатор,
			"Ответственное лицо" КАК ИмяХарактеристики)
	ИДЕНТИФИКАТОР Идентификатор
	ИМЯ ИмяХарактеристики
	ЗНАЧЕНИЯ (ВЫБРАТЬ
			ОтветственныеЛицаСрезПоследних.СтруктурнаяЕдиница КАК Объект,
			"Ответственное лицо" КАК Идентификатор,
			ОтветственныеЛицаСрезПоследних.ФизическоеЛицо КАК Значение
		ИЗ
			РегистрСведений.ОтветственныеЛицаОрганизаций.СрезПоследних КАК ОтветственныеЛицаСрезПоследних
		ГДЕ
			ОтветственныеЛицаСрезПоследних.СтруктурнаяЕдиница ССЫЛКА Справочник.ПодразделенияОрганизаций
			И ОтветственныеЛицаСрезПоследних.ОтветственноеЛицо = ЗНАЧЕНИЕ(Перечисление.ОтветственныеЛицаОрганизаций.Руководитель))
	ОБЪЕКТ Объект
	ХАРАКТЕРИСТИКА Идентификатор
	ЗНАЧЕНИЕ Значение }</query>
	</dataSet>
	<parameter>
		<name>КонецПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Конец периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>Date</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>НачалоПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Начало периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>Date</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<settingsVariant>
		<dcsset:name>Основной</dcsset:name>
		<dcsset:presentation xsi:type="xs:string">Основной</dcsset:presentation>
		<dcsset:settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows"/>
	</settingsVariant>
</DataCompositionSchema>