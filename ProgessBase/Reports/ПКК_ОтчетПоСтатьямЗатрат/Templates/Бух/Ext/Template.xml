<?xml version="1.0" encoding="UTF-8"?>
<DataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema" xmlns:dcscom="http://v8.1c.ru/8.1/data-composition-system/common" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataSource>
		<name>ИсточникДанных1</name>
		<dataSourceType>Local</dataSourceType>
	</dataSource>
	<dataSet xsi:type="DataSetQuery">
		<name>НаборДанных1</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>ВыслугаЛет</dataPath>
			<field>ВыслугаЛет</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ВыслугаПлан</dataPath>
			<field>ВыслугаПлан</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ВыслугаФакт</dataPath>
			<field>ВыслугаФакт</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Должность</dataPath>
			<field>Должность</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Месяц</dataPath>
			<field>Месяц</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НормаЧасовЗаМесяц</dataPath>
			<field>НормаЧасовЗаМесяц</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НочныеПлан</dataPath>
			<field>НочныеПлан</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НочныеФакт</dataPath>
			<field>НочныеФакт</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Оклад</dataPath>
			<field>Оклад</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ОкладЗаЧас</dataPath>
			<field>ОкладЗаЧас</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ОкладПлан</dataPath>
			<field>ОкладПлан</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ОкладФакт</dataPath>
			<field>ОкладФакт</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПодразделениеОрганизации</dataPath>
			<field>ПодразделениеОрганизации</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПраздникиФакт</dataPath>
			<field>ПраздникиФакт</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Праздничные</dataPath>
			<field>Праздничные</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Сотрудник</dataPath>
			<field>Сотрудник</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЧасовПлан</dataPath>
			<field>ЧасовПлан</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЧасовФакт</dataPath>
			<field>ЧасовФакт</field>
		</field>
		<dataSource>ИсточникДанных1</dataSource>
		<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ГрафикиРаботыПоВидамВремени.Дата
ПОМЕСТИТЬ Периоды
ИЗ
	РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
ГДЕ
	ГрафикиРаботыПоВидамВремени.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	И ГрафикиРаботыПоВидамВремени.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоЧасам)

СГРУППИРОВАТЬ ПО
	ГрафикиРаботыПоВидамВремени.Дата
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ГрафикиРаботыПоВидамВремени.ГрафикРаботы,
	СУММА(ГрафикиРаботыПоВидамВремени.ПроизводственныйКалендарьПятидневкаЧасы) КАК ПроизводственныйКалендарьПятидневкаЧасы
ПОМЕСТИТЬ ВТ_НормаЧасов
ИЗ
	РегистрСведений.ГрафикиРаботыПоВидамВремени КАК ГрафикиРаботыПоВидамВремени
ГДЕ
	ГрафикиРаботыПоВидамВремени.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	И ГрафикиРаботыПоВидамВремени.ВидУчетаВремени = ЗНАЧЕНИЕ(Перечисление.ВидыУчетаВремени.ПоЧасам)
	И ГрафикиРаботыПоВидамВремени.ГрафикРаботы ССЫЛКА Справочник.ГрафикиРаботы

СГРУППИРОВАТЬ ПО
	ГрафикиРаботыПоВидамВремени.ГрафикРаботы
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	выб.Период,
	выб.Сотрудник,
	выб.ГрафикРаботы,
	выб.ПодразделениеОрганизации,
	выб.Должность,
	выб.ПричинаИзмененияСостояния
ПОМЕСТИТЬ ВТ_ГрафикиРабот
ИЗ
	(ВЫБРАТЬ
		РаботникиОрганизацийСрезПоследних.Период КАК Период,
		РаботникиОрганизацийСрезПоследних.Сотрудник КАК Сотрудник,
		РаботникиОрганизацийСрезПоследних.ГрафикРаботы КАК ГрафикРаботы,
		РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
		РаботникиОрганизацийСрезПоследних.Должность КАК Должность,
		РаботникиОрганизацийСрезПоследних.ПричинаИзмененияСостояния КАК ПричинаИзмененияСостояния
	ИЗ
		РегистрСведений.РаботникиОрганизаций.СрезПоследних(КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(&amp;НачалоПериода, ДЕНЬ, -1), ДЕНЬ), ) КАК РаботникиОрганизацийСрезПоследних
	ГДЕ
		РаботникиОрганизацийСрезПоследних.ПричинаИзмененияСостояния &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		РаботникиОрганизаций.Период,
		РаботникиОрганизаций.Сотрудник,
		РаботникиОрганизаций.ГрафикРаботы,
		РаботникиОрганизаций.ПодразделениеОрганизации,
		РаботникиОрганизаций.Должность,
		РаботникиОрганизаций.ПричинаИзмененияСостояния
	ИЗ
		РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
	ГДЕ
		РаботникиОрганизаций.Период МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода) КАК выб
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Периоды.Дата КАК дата,
	ВТ_ГрафикиРабот.Сотрудник,
	МАКСИМУМ(ВТ_ГрафикиРабот.Период) КАК Период
ПОМЕСТИТЬ ВТ_ГрафикиСДатами
ИЗ
	Периоды КАК Периоды
		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ГрафикиРабот КАК ВТ_ГрафикиРабот
		ПО Периоды.Дата &gt;= ВТ_ГрафикиРабот.Период

СГРУППИРОВАТЬ ПО
	Периоды.Дата,
	ВТ_ГрафикиРабот.Сотрудник
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ГрафикиСДатами.дата КАК дата,
	ВТ_ГрафикиСДатами.Сотрудник,
	ВТ_ГрафикиСДатами.Период,
	ВТ_ГрафикиРабот.ГрафикРаботы,
	ВТ_ГрафикиРабот.ПодразделениеОрганизации,
	ВТ_ГрафикиРабот.Должность,
	ВЫБОР
		КОГДА ВТ_ГрафикиРабот.ПричинаИзмененияСостояния ЕСТЬ NULL 
			ТОГДА ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Перемещение)
		ИНАЧЕ ВТ_ГрафикиРабот.ПричинаИзмененияСостояния
	КОНЕЦ КАК ПричинаИзменения
ПОМЕСТИТЬ ВТ_ГрафикиПоДням
ИЗ
	ВТ_ГрафикиСДатами КАК ВТ_ГрафикиСДатами
		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ГрафикиРабот КАК ВТ_ГрафикиРабот
		ПО ВТ_ГрафикиСДатами.Сотрудник = ВТ_ГрафикиРабот.Сотрудник
			И ВТ_ГрафикиСДатами.Период = ВТ_ГрафикиРабот.Период
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	выб.Период,
	выб.Сотрудник,
	выб.ВидРасчета,
	выб.Показатель1,
	выб.Показатель2,
	выб.Показатель3,
	выб.Показатель4,
	выб.Показатель5,
	выб.Показатель6
ПОМЕСТИТЬ ВТ_ПлановыеНачисления
ИЗ
	(ВЫБРАТЬ
		ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Период КАК Период,
		ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Сотрудник КАК Сотрудник,
		ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.ВидРасчета КАК ВидРасчета,
		ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Показатель1 КАК Показатель1,
		ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Показатель2 КАК Показатель2,
		ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Показатель3 КАК Показатель3,
		ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Показатель4 КАК Показатель4,
		ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Показатель5 КАК Показатель5,
		ПлановыеНачисленияРаботниковОрганизацийСрезПоследних.Показатель6 КАК Показатель6
	ИЗ
		РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций.СрезПоследних(КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(&amp;НачалоПериода, ДЕНЬ, -1), ДЕНЬ), ) КАК ПлановыеНачисленияРаботниковОрганизацийСрезПоследних
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ПлановыеНачисленияРаботниковОрганизаций.Период,
		ПлановыеНачисленияРаботниковОрганизаций.Сотрудник,
		ПлановыеНачисленияРаботниковОрганизаций.ВидРасчета,
		ПлановыеНачисленияРаботниковОрганизаций.Показатель1,
		ПлановыеНачисленияРаботниковОрганизаций.Показатель2,
		ПлановыеНачисленияРаботниковОрганизаций.Показатель3,
		ПлановыеНачисленияРаботниковОрганизаций.Показатель4,
		ПлановыеНачисленияРаботниковОрганизаций.Показатель5,
		ПлановыеНачисленияРаботниковОрганизаций.Показатель6
	ИЗ
		РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК ПлановыеНачисленияРаботниковОрганизаций
	ГДЕ
		ПлановыеНачисленияРаботниковОрганизаций.Период МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода) КАК выб
ГДЕ
	выб.Сотрудник В
			(ВЫБРАТЬ
				выб.Сотрудник
			ИЗ
				ВТ_ГрафикиРабот КАК выб)
	И (выб.ВидРасчета.Наименование = "1_Оклад по часам"
			ИЛИ выб.ВидРасчета.Наименование = "1_Доплата за ночные часы"
			ИЛИ выб.ВидРасчета.Наименование = "ИСП_1_Доплата за выслугу лет"
			ИЛИ выб.ВидРасчета.Наименование = "Оплата праздничных и выходных дней")
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Периоды.Дата КАК дата,
	ВТ_ПлановыеНачисления.Сотрудник,
	МАКСИМУМ(ВТ_ПлановыеНачисления.Период) КАК Период,
	ВТ_ПлановыеНачисления.ВидРасчета
ПОМЕСТИТЬ ВТ_ПлановыеНачисленияСДатами
ИЗ
	Периоды КАК Периоды
		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ПлановыеНачисления КАК ВТ_ПлановыеНачисления
		ПО Периоды.Дата &gt;= ВТ_ПлановыеНачисления.Период

СГРУППИРОВАТЬ ПО
	Периоды.Дата,
	ВТ_ПлановыеНачисления.Сотрудник,
	ВТ_ПлановыеНачисления.ВидРасчета
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ПлановыеНачисленияСДатами.дата КАК дата,
	ВТ_ПлановыеНачисленияСДатами.Сотрудник,
	СУММА(ВЫБОР
			КОГДА ВТ_ПлановыеНачисления.ВидРасчета.Наименование = "1_Оклад по часам"
				ТОГДА ВТ_ПлановыеНачисления.Показатель1
			ИНАЧЕ 0
		КОНЕЦ) КАК оклад
ПОМЕСТИТЬ ВТ_ПлановыеНачисленияПоДням
ИЗ
	ВТ_ПлановыеНачисленияСДатами КАК ВТ_ПлановыеНачисленияСДатами
		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ПлановыеНачисления КАК ВТ_ПлановыеНачисления
		ПО ВТ_ПлановыеНачисленияСДатами.Сотрудник = ВТ_ПлановыеНачисления.Сотрудник
			И ВТ_ПлановыеНачисленияСДатами.Период = ВТ_ПлановыеНачисления.Период
			И ВТ_ПлановыеНачисленияСДатами.ВидРасчета = ВТ_ПлановыеНачисления.ВидРасчета

СГРУППИРОВАТЬ ПО
	ВТ_ПлановыеНачисленияСДатами.дата,
	ВТ_ПлановыеНачисленияСДатами.Сотрудник
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ВидыСтажа.Ссылка
ПОМЕСТИТЬ ВТ_стажДляРасчета
ИЗ
	Справочник.ВидыСтажа КАК ВидыСтажа
ГДЕ
	ВидыСтажа.Наименование = "Стаж на предприятии"
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	&amp;НачалоПериода КАК дата,
	ФизическиеЛицаСтажи.Ссылка КАК физЛицо,
	ФизическиеЛицаСтажи.ДатаОтсчета,
	ФизическиеЛицаСтажи.РазмерМесяцев,
	ФизическиеЛицаСтажи.РазмерДней
ПОМЕСТИТЬ ВТ_физЛицаДляСтажа
ИЗ
	Справочник.ФизическиеЛица.Стажи КАК ФизическиеЛицаСтажи
ГДЕ
	ФизическиеЛицаСтажи.ВидСтажа В
			(ВЫБРАТЬ
				выб.Ссылка
			ИЗ
				ВТ_стажДляРасчета КАК выб)
	И ФизическиеЛицаСтажи.Ссылка В
			(ВЫБРАТЬ
				выб.Сотрудник.Физлицо КАК ссылка
			ИЗ
				ВТ_ПлановыеНачисления КАК выб
			ГДЕ
				выб.ВидРасчета.Наименование = "ИСП_1_Доплата за выслугу лет"
			СГРУППИРОВАТЬ ПО
						выб.Сотрудник.Физлицо)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Стажи.физЛицо,
	Стажи.РазмерМесяцев,
	Стажи.РазмерДней,
	Стажи.ДатаОтсчета,
	ВЫБОР
		КОГДА Стажи.ДатаОтсчета &gt;= ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(ДАТАВРЕМЯ(1, 1, 1), МЕСЯЦ, Стажи.РазмерМесяцев), ДЕНЬ, Стажи.РазмерДней)
			ТОГДА ВЫБОР
					КОГДА ВЫБОР
							КОГДА ДЕНЬ(Стажи.дата) &gt;= ДЕНЬ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(Стажи.ДатаОтсчета, МЕСЯЦ, -Стажи.РазмерМесяцев), ДЕНЬ, -Стажи.РазмерДней))
								ТОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(Стажи.ДатаОтсчета, МЕСЯЦ, -Стажи.РазмерМесяцев), ДЕНЬ, -Стажи.РазмерДней), Стажи.дата, МЕСЯЦ)
							КОГДА ДЕНЬ(Стажи.дата) &lt; ДЕНЬ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(Стажи.ДатаОтсчета, МЕСЯЦ, -Стажи.РазмерМесяцев), ДЕНЬ, -Стажи.РазмерДней))
								ТОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(Стажи.ДатаОтсчета, МЕСЯЦ, -Стажи.РазмерМесяцев), ДЕНЬ, -Стажи.РазмерДней), Стажи.дата, МЕСЯЦ) - 1
						КОНЕЦ / 12 &lt; (ВЫРАЗИТЬ(ВЫБОР
								КОГДА ДЕНЬ(Стажи.дата) &gt;= ДЕНЬ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(Стажи.ДатаОтсчета, МЕСЯЦ, -Стажи.РазмерМесяцев), ДЕНЬ, -Стажи.РазмерДней))
									ТОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(Стажи.ДатаОтсчета, МЕСЯЦ, -Стажи.РазмерМесяцев), ДЕНЬ, -Стажи.РазмерДней), Стажи.дата, МЕСЯЦ)
								КОГДА ДЕНЬ(Стажи.дата) &lt; ДЕНЬ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(Стажи.ДатаОтсчета, МЕСЯЦ, -Стажи.РазмерМесяцев), ДЕНЬ, -Стажи.РазмерДней))
									ТОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(Стажи.ДатаОтсчета, МЕСЯЦ, -Стажи.РазмерМесяцев), ДЕНЬ, -Стажи.РазмерДней), Стажи.дата, МЕСЯЦ) - 1
							КОНЕЦ / 12 КАК ЧИСЛО(7, 0)))
						ТОГДА (ВЫРАЗИТЬ(ВЫБОР
									КОГДА ДЕНЬ(Стажи.дата) &gt;= ДЕНЬ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(Стажи.ДатаОтсчета, МЕСЯЦ, -Стажи.РазмерМесяцев), ДЕНЬ, -Стажи.РазмерДней))
										ТОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(Стажи.ДатаОтсчета, МЕСЯЦ, -Стажи.РазмерМесяцев), ДЕНЬ, -Стажи.РазмерДней), Стажи.дата, МЕСЯЦ)
									КОГДА ДЕНЬ(Стажи.дата) &lt; ДЕНЬ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(Стажи.ДатаОтсчета, МЕСЯЦ, -Стажи.РазмерМесяцев), ДЕНЬ, -Стажи.РазмерДней))
										ТОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(Стажи.ДатаОтсчета, МЕСЯЦ, -Стажи.РазмерМесяцев), ДЕНЬ, -Стажи.РазмерДней), Стажи.дата, МЕСЯЦ) - 1
								КОНЕЦ / 12 КАК ЧИСЛО(7, 0))) - 1
					ИНАЧЕ ВЫРАЗИТЬ(ВЫБОР
								КОГДА ДЕНЬ(Стажи.дата) &gt;= ДЕНЬ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(Стажи.ДатаОтсчета, МЕСЯЦ, -Стажи.РазмерМесяцев), ДЕНЬ, -Стажи.РазмерДней))
									ТОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(Стажи.ДатаОтсчета, МЕСЯЦ, -Стажи.РазмерМесяцев), ДЕНЬ, -Стажи.РазмерДней), Стажи.дата, МЕСЯЦ)
								КОГДА ДЕНЬ(Стажи.дата) &lt; ДЕНЬ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(Стажи.ДатаОтсчета, МЕСЯЦ, -Стажи.РазмерМесяцев), ДЕНЬ, -Стажи.РазмерДней))
									ТОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(ДОБАВИТЬКДАТЕ(Стажи.ДатаОтсчета, МЕСЯЦ, -Стажи.РазмерМесяцев), ДЕНЬ, -Стажи.РазмерДней), Стажи.дата, МЕСЯЦ) - 1
							КОНЕЦ / 12 КАК ЧИСЛО(7, 0))
				КОНЕЦ
	КОНЕЦ КАК СтажЛет
ПОМЕСТИТЬ вт_стажи
ИЗ
	ВТ_физЛицаДляСтажа КАК Стажи
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ВТ_ГрафикиПоДням.дата КАК дата,
	ВТ_ГрафикиПоДням.Сотрудник КАК Сотрудник,
	ВТ_ГрафикиПоДням.ГрафикРаботы,
	ВТ_ГрафикиПоДням.ПодразделениеОрганизации,
	ВТ_ГрафикиПоДням.Должность,
	ВЫБОР
		КОГДА РабочееВремяРаботниковОрганизаций.Часов ЕСТЬ NULL 
			ТОГДА 0
		ИНАЧЕ РабочееВремяРаботниковОрганизаций.Часов
	КОНЕЦ КАК ЧасовФакт,
	ВЫБОР
		КОГДА РабочееВремяРаботниковОрганизаций.Часов = 11.5
				ИЛИ РабочееВремяРаботниковОрганизаций.Часов = 7.5
				ИЛИ РабочееВремяРаботниковОрганизаций.Часов = 5.5
			ТОГДА РабочееВремяРаботниковОрганизаций.Часов + 0.5
		ИНАЧЕ РабочееВремяРаботниковОрганизаций.Часов
	КОНЕЦ КАК ЧасовПлан,
	ВТ_НормаЧасов.ПроизводственныйКалендарьПятидневкаЧасы КАК НормаЧасовЗаМесяц,
	РегламентированныйПроизводственныйКалендарь.ВидДня,
	РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени,
	ВТ_ПлановыеНачисленияПоДням.оклад КАК Оклад,
	ВЫБОР
		КОГДА вт_стажи.СтажЛет ЕСТЬ NULL 
			ТОГДА 0
		ИНАЧЕ ВЫБОР
				КОГДА вт_стажи.СтажЛет = 5
					ТОГДА 5
				ИНАЧЕ ВЫБОР
						КОГДА вт_стажи.СтажЛет = 10
							ТОГДА 10
						ИНАЧЕ ВЫБОР
								КОГДА вт_стажи.СтажЛет = 15
									ТОГДА 15
								ИНАЧЕ 0
							КОНЕЦ
					КОНЕЦ
			КОНЕЦ
	КОНЕЦ КАК ВыслугаЛет,
	ВТ_ПлановыеНачисленияПоДням.оклад / ВТ_НормаЧасов.ПроизводственныйКалендарьПятидневкаЧасы КАК ОкладЗаЧас,
	ВЫБОР
		КОГДА AVT_РаботаСверхНормыПраздники.Часов ЕСТЬ NULL 
			ТОГДА 0
		ИНАЧЕ AVT_РаботаСверхНормыПраздники.Часов
	КОНЕЦ КАК Праздничные
ПОМЕСТИТЬ вт_ВсеДляРасчета
ИЗ
	ВТ_ГрафикиПоДням КАК ВТ_ГрафикиПоДням
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
		ПО ВТ_ГрафикиПоДням.ГрафикРаботы.AVT_ПроизводственныйКалендарь = РегламентированныйПроизводственныйКалендарь.AVT_ПроизводственныйКалендарь
			И ВТ_ГрафикиПоДням.дата = РегламентированныйПроизводственныйКалендарь.ДатаКалендаря
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.РабочееВремяРаботниковОрганизаций КАК РабочееВремяРаботниковОрганизаций
		ПО ВТ_ГрафикиПоДням.Сотрудник = РабочееВремяРаботниковОрганизаций.Сотрудник
			И ВТ_ГрафикиПоДням.дата = РабочееВремяРаботниковОрганизаций.Период
			И (РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Работа)
				ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы)
				ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Праздники)
				ИЛИ РабочееВремяРаботниковОрганизаций.ВидИспользованияРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Сверхурочные))
		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_НормаЧасов КАК ВТ_НормаЧасов
		ПО ВТ_ГрафикиПоДням.ГрафикРаботы = ВТ_НормаЧасов.ГрафикРаботы
		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ПлановыеНачисленияПоДням КАК ВТ_ПлановыеНачисленияПоДням
		ПО ВТ_ГрафикиПоДням.дата = ВТ_ПлановыеНачисленияПоДням.дата
			И ВТ_ГрафикиПоДням.Сотрудник = ВТ_ПлановыеНачисленияПоДням.Сотрудник
		ЛЕВОЕ СОЕДИНЕНИЕ вт_стажи КАК вт_стажи
		ПО ВТ_ГрафикиПоДням.Сотрудник.Физлицо = вт_стажи.физЛицо
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.AVT_РаботаСверхНормы КАК AVT_РаботаСверхНормыПраздники
		ПО ВТ_ГрафикиПоДням.дата = AVT_РаботаСверхНормыПраздники.Период
			И ВТ_ГрафикиПоДням.Сотрудник = AVT_РаботаСверхНормыПраздники.Сотрудник
			И (AVT_РаботаСверхНормыПраздники.ВидРасчета.Наименование = "Оплата праздничных и выходных дней")
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	вт_ВсеДляРасчета.дата,
	вт_ВсеДляРасчета.Сотрудник,
	вт_ВсеДляРасчета.ГрафикРаботы,
	вт_ВсеДляРасчета.ПодразделениеОрганизации,
	вт_ВсеДляРасчета.Должность,
	ВЫБОР
		КОГДА вт_ВсеДляРасчета.ЧасовФакт ЕСТЬ NULL 
			ТОГДА 0
		ИНАЧЕ вт_ВсеДляРасчета.ЧасовФакт
	КОНЕЦ КАК ЧасовФакт,
	ВЫБОР
		КОГДА вт_ВсеДляРасчета.ЧасовПлан ЕСТЬ NULL 
			ТОГДА 0
		ИНАЧЕ вт_ВсеДляРасчета.ЧасовПлан
	КОНЕЦ КАК ЧасовПлан,
	вт_ВсеДляРасчета.НормаЧасовЗаМесяц,
	вт_ВсеДляРасчета.ВидДня,
	вт_ВсеДляРасчета.ВидИспользованияРабочегоВремени,
	вт_ВсеДляРасчета.Оклад,
	вт_ВсеДляРасчета.ВыслугаЛет,
	вт_ВсеДляРасчета.ОкладЗаЧас,
	вт_ВсеДляРасчета.Праздничные,
	ВЫБОР
		КОГДА вт_ВсеДляРасчета.ВидИспользованияРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Работа)
			ТОГДА вт_ВсеДляРасчета.ЧасовФакт * вт_ВсеДляРасчета.ОкладЗаЧас
		ИНАЧЕ 0
	КОНЕЦ КАК ОкладФакт,
	ВЫБОР
		КОГДА вт_ВсеДляРасчета.ВидИспользованияРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Работа)
			ТОГДА вт_ВсеДляРасчета.ЧасовПлан * вт_ВсеДляРасчета.ОкладЗаЧас
		ИНАЧЕ 0
	КОНЕЦ КАК ОкладПлан,
	ВЫБОР
		КОГДА вт_ВсеДляРасчета.ВидИспользованияРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы)
			ТОГДА вт_ВсеДляРасчета.ЧасовФакт * вт_ВсеДляРасчета.ОкладЗаЧас
		ИНАЧЕ 0
	КОНЕЦ КАК НочныеФакт,
	ВЫБОР
		КОГДА вт_ВсеДляРасчета.ВидИспользованияРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.РаботаНочныеЧасы)
			ТОГДА вт_ВсеДляРасчета.ЧасовПлан * вт_ВсеДляРасчета.ОкладЗаЧас
		ИНАЧЕ 0
	КОНЕЦ КАК НочныеПлан,
	ВЫБОР
		КОГДА НЕ вт_ВсеДляРасчета.Праздничные = 0
			ТОГДА вт_ВсеДляРасчета.Праздничные * вт_ВсеДляРасчета.ОкладЗаЧас
		ИНАЧЕ 0
	КОНЕЦ КАК ПраздникиФакт,
	ВЫБОР
		КОГДА НЕ вт_ВсеДляРасчета.ВыслугаЛет = 0
			ТОГДА ВЫБОР
					КОГДА вт_ВсеДляРасчета.ВидИспользованияРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Работа)
						ТОГДА вт_ВсеДляРасчета.ЧасовФакт * вт_ВсеДляРасчета.ОкладЗаЧас
					ИНАЧЕ 0
				КОНЕЦ / 100 * вт_ВсеДляРасчета.ВыслугаЛет
		ИНАЧЕ 0
	КОНЕЦ КАК ВыслугаФакт,
	ВЫБОР
		КОГДА НЕ вт_ВсеДляРасчета.ВыслугаЛет = 0
			ТОГДА ВЫБОР
					КОГДА вт_ВсеДляРасчета.ВидИспользованияРабочегоВремени = ЗНАЧЕНИЕ(Справочник.КлассификаторИспользованияРабочегоВремени.Работа)
						ТОГДА вт_ВсеДляРасчета.ЧасовПлан * вт_ВсеДляРасчета.ОкладЗаЧас
					ИНАЧЕ 0
				КОНЕЦ / 100 * вт_ВсеДляРасчета.ВыслугаЛет
		ИНАЧЕ 0
	КОНЕЦ КАК ВыслугаПлан
ПОМЕСТИТЬ вт_итог
ИЗ
	вт_ВсеДляРасчета КАК вт_ВсеДляРасчета
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	вт_итог.Сотрудник,
	СУММА(вт_итог.ЧасовФакт) КАК ЧасовФакт,
	СУММА(вт_итог.ЧасовПлан) КАК ЧасовПлан,
	МАКСИМУМ(вт_итог.НормаЧасовЗаМесяц) КАК НормаЧасовЗаМесяц,
	СРЕДНЕЕ(вт_итог.Оклад) КАК Оклад,
	МАКСИМУМ(вт_итог.ВыслугаЛет) КАК ВыслугаЛет,
	СРЕДНЕЕ(вт_итог.ОкладЗаЧас) КАК ОкладЗаЧас,
	СУММА(вт_итог.Праздничные) КАК Праздничные,
	СУММА(вт_итог.ОкладФакт) КАК ОкладФакт,
	СУММА(вт_итог.ОкладПлан) КАК ОкладПлан,
	СУММА(вт_итог.НочныеФакт) КАК НочныеФакт,
	СУММА(вт_итог.НочныеПлан) КАК НочныеПлан,
	СУММА(вт_итог.ПраздникиФакт) КАК ПраздникиФакт,
	СУММА(вт_итог.ВыслугаФакт) КАК ВыслугаФакт,
	СУММА(вт_итог.ВыслугаПлан) КАК ВыслугаПлан,
	НАЧАЛОПЕРИОДА(вт_итог.дата, МЕСЯЦ) КАК Месяц,
	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации,
	РаботникиОрганизацийСрезПоследних.Должность
ПОМЕСТИТЬ вт
ИЗ
	вт_итог КАК вт_итог
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних(&amp;Конецпериода, ) КАК РаботникиОрганизацийСрезПоследних
		ПО вт_итог.Сотрудник = РаботникиОрганизацийСрезПоследних.Сотрудник
ГДЕ
	вт_итог.Сотрудник В
			(ВЫБРАТЬ
				вт_итог.Сотрудник
			ИЗ
				вт_итог КАК вт_итог
			ГДЕ
				НЕ вт_итог.ЧасовФакт = вт_итог.ЧасовПлан)
	И (НЕ вт_итог.ЧасовФакт = 0
			ИЛИ НЕ вт_итог.Праздничные = 0)

СГРУППИРОВАТЬ ПО
	вт_итог.Сотрудник,
	НАЧАЛОПЕРИОДА(вт_итог.дата, МЕСЯЦ),
	РаботникиОрганизацийСрезПоследних.ПодразделениеОрганизации,
	РаботникиОрганизацийСрезПоследних.Должность
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	вт.Сотрудник,
	вт.ЧасовФакт,
	вт.ЧасовПлан,
	вт.НормаЧасовЗаМесяц,
	вт.Оклад,
	вт.ВыслугаЛет,
	вт.ОкладЗаЧас,
	вт.Праздничные,
	вт.ОкладФакт,
	вт.ОкладПлан,
	вт.НочныеФакт,
	вт.НочныеПлан,
	вт.ПраздникиФакт,
	вт.ВыслугаФакт,
	вт.ВыслугаПлан,
	вт.Месяц ,
	вт.ПодразделениеОрганизации,
	вт.Должность
ИЗ
	вт КАК вт</query>
	</dataSet>
	<parameter>
		<name>КонецПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Конец периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>НачалоПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Начало периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>Период</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Период</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>false</useRestriction>
	</parameter>
	<settingsVariant>
		<dcsset:name>Основной</dcsset:name>
		<dcsset:presentation xsi:type="xs:string">Основной</dcsset:presentation>
		<dcsset:settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows">
			<dcsset:selection>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>СуммаРеглПриход</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>СуммаРеглПРасход</dcsset:field>
				</dcsset:item>
			</dcsset:selection>
			<dcsset:filter>
				<dcsset:item xsi:type="dcsset:FilterItemComparison">
					<dcsset:use>false</dcsset:use>
					<dcsset:left xsi:type="dcscor:Field">СтатьяДвиженияДенежныхСредств</dcsset:left>
					<dcsset:comparisonType>InHierarchy</dcsset:comparisonType>
				</dcsset:item>
			</dcsset:filter>
			<dcsset:outputParameters>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>РасположениеРеквизитов</dcscor:parameter>
					<dcscor:value xsi:type="dcsset:DataCompositionAttributesPlacement">Separately</dcscor:value>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Заголовок</dcscor:parameter>
					<dcscor:value xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Отчет о движении денежных средств (прямой метод)/Cash Flow Statement</v8:content>
						</v8:item>
					</dcscor:value>
				</dcscor:item>
			</dcsset:outputParameters>
			<dcsset:item xsi:type="dcsset:StructureItemTable">
				<dcsset:column>
					<dcsset:groupItems>
						<dcsset:item xsi:type="dcsset:GroupItemField">
							<dcsset:field>Период</dcsset:field>
							<dcsset:groupType>Items</dcsset:groupType>
							<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
							<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
							<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
						</dcsset:item>
					</dcsset:groupItems>
					<dcsset:order>
						<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
					</dcsset:order>
					<dcsset:selection>
						<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
					</dcsset:selection>
				</dcsset:column>
				<dcsset:row>
					<dcsset:groupItems>
						<dcsset:item xsi:type="dcsset:GroupItemField">
							<dcsset:field>СтатьяДвиженияДенежныхСредств.ФинКод</dcsset:field>
							<dcsset:groupType>Items</dcsset:groupType>
							<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
							<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
							<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
						</dcsset:item>
						<dcsset:item xsi:type="dcsset:GroupItemField">
							<dcsset:field>СтатьяДвиженияДенежныхСредств</dcsset:field>
							<dcsset:groupType>Hierarchy</dcsset:groupType>
							<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
							<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
							<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
						</dcsset:item>
					</dcsset:groupItems>
					<dcsset:order>
						<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
						<dcsset:item xsi:type="dcsset:OrderItemField">
							<dcsset:field>СтатьяДвиженияДенежныхСредств.ФинКод</dcsset:field>
							<dcsset:orderType>Asc</dcsset:orderType>
						</dcsset:item>
					</dcsset:order>
					<dcsset:selection>
						<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
					</dcsset:selection>
				</dcsset:row>
			</dcsset:item>
		</dcsset:settings>
	</settingsVariant>
</DataCompositionSchema>