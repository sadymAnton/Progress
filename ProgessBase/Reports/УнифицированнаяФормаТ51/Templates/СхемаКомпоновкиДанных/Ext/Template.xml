<?xml version="1.0" encoding="UTF-8"?>
<DataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema" xmlns:dcscom="http://v8.1c.ru/8.1/data-composition-system/common" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataSource>
		<name>ИсточникДанных1</name>
		<dataSourceType>Local</dataSourceType>
	</dataSource>
	<dataSet xsi:type="DataSetQuery">
		<name>СписокФизическихЛиц</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>ГоловнаяОрганизация</dataPath>
			<field>ГоловнаяОрганизация</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Головная организация</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Должность</dataPath>
			<field>Должность</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Должность</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Организация</dataPath>
			<field>Организация</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Организация</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПериодРегистрации</dataPath>
			<field>ПериодРегистрации</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Период регистрации</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПодразделениеОрганизации</dataPath>
			<field>ПодразделениеОрганизации</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Подразделение организации</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Сотрудник</dataPath>
			<field>Сотрудник</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сотрудник</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ФизЛицо</dataPath>
			<field>ФизЛицо</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Физ лицо</v8:content>
				</v8:item>
			</title>
		</field>
		<dataSource>ИсточникДанных1</dataSource>
		<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	НАЧАЛОПЕРИОДА(РегламентированныйПроизводственныйКалендарь.ДатаКалендаря, МЕСЯЦ) КАК ПериодРегистрации
ПОМЕСТИТЬ Периоды
ИЗ
	РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
ГДЕ
	РегламентированныйПроизводственныйКалендарь.ДатаКалендаря МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо,
	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник,
	ОсновныеНачисленияРаботниковОрганизаций.ОбособленноеПодразделение КАК Организация,
	ОсновныеНачисленияРаботниковОрганизаций.Организация КАК ГоловнаяОрганизация,
	НАЧАЛОПЕРИОДА(ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ) КАК ПериодРегистрации,
	ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяССылка) КАК ПодразделениеОрганизации,
	ЗНАЧЕНИЕ(Справочник.ДолжностиОрганизаций.ПустаяССылка) КАК Должность
ПОМЕСТИТЬ НеСотрудники
ИЗ
	РегистрРасчета.ОсновныеНачисленияРаботниковОрганизаций КАК ОсновныеНачисленияРаботниковОрганизаций
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
		ПО (ДоговорНаВыполнениеРаботСФизЛицом.Проведен)
			И ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо = ДоговорНаВыполнениеРаботСФизЛицом.ФизЛицо
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
		ПО ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо = РаботникиОрганизаций.Сотрудник.Физлицо
ГДЕ
	РаботникиОрганизаций.Сотрудник ЕСТЬ NULL 
	И ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник ЕСТЬ NULL 
	И ОсновныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	ОсновныеНачисленияРаботниковОрганизаций.ФизЛицо.*,
	ОсновныеНачисленияРаботниковОрганизаций.Сотрудник.*,
	ОсновныеНачисленияРаботниковОрганизаций.ОбособленноеПодразделение.* КАК Организация,
	ОсновныеНачисленияРаботниковОрганизаций.Организация.* КАК ГоловнаяОрганизация}

ОБЪЕДИНИТЬ

ВЫБРАТЬ РАЗЛИЧНЫЕ
	ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо,
	ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник,
	ДополнительныеНачисленияРаботниковОрганизаций.ОбособленноеПодразделение,
	ДополнительныеНачисленияРаботниковОрганизаций.Организация,
	НАЧАЛОПЕРИОДА(ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации, МЕСЯЦ),
	ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяССылка),
	ЗНАЧЕНИЕ(Справочник.ДолжностиОрганизаций.ПустаяССылка)
ИЗ
	РегистрРасчета.ДополнительныеНачисленияРаботниковОрганизаций КАК ДополнительныеНачисленияРаботниковОрганизаций
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
		ПО (ДоговорНаВыполнениеРаботСФизЛицом.Проведен)
			И ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо = ДоговорНаВыполнениеРаботСФизЛицом.ФизЛицо
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
		ПО ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо = РаботникиОрганизаций.Сотрудник.Физлицо
ГДЕ
	РаботникиОрганизаций.Сотрудник ЕСТЬ NULL 
	И ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник ЕСТЬ NULL 
	И ДополнительныеНачисленияРаботниковОрганизаций.ПериодРегистрации МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
{ГДЕ
	ДополнительныеНачисленияРаботниковОрганизаций.ФизЛицо.*,
	ДополнительныеНачисленияРаботниковОрганизаций.Сотрудник.*,
	ДополнительныеНачисленияРаботниковОрганизаций.ОбособленноеПодразделение.* КАК Организация,
	ДополнительныеНачисленияРаботниковОрганизаций.Организация.* КАК ГоловнаяОрганизация}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ДатыПоследнихДоговоров.ПериодРегистрации,
	ДатыПоследнихДоговоров.Организация,
	ДатыПоследнихДоговоров.Физлицо,
	ЗНАЧЕНИЕ(Справочник.ДолжностиОрганизаций.ПустаяСсылка) КАК Должность,
	ВЫБОР
		КОГДА ДоговорНаВыполнениеРаботСФизЛицом.Организация.ГоловнаяОрганизация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
			ТОГДА ДоговорНаВыполнениеРаботСФизЛицом.Организация
		ИНАЧЕ ДоговорНаВыполнениеРаботСФизЛицом.Организация.ГоловнаяОрганизация
	КОНЕЦ КАК ГоловнаяОрганизация,
	МАКСИМУМ(ДоговорНаВыполнениеРаботСФизЛицом.Ссылка) КАК Ссылка
ПОМЕСТИТЬ Договорники
ИЗ
	(ВЫБРАТЬ
		Договора.Физлицо КАК Физлицо,
		Договора.Организация КАК Организация,
		МАКСИМУМ(Договора.ДатаНачала) КАК ДатаНачала,
		Периоды.ПериодРегистрации КАК ПериодРегистрации,
		МАКСИМУМ(РаботникиОрганизаций.Период) КАК Период
	ИЗ
		Периоды КАК Периоды
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
				ДоговорНаВыполнениеРаботСФизЛицом.ФизЛицо КАК Физлицо,
				ДоговорНаВыполнениеРаботСФизЛицом.Организация КАК Организация,
				ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала КАК ДатаНачала,
				ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания КАК ДатаОкончания
			ИЗ
				Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
			ГДЕ
				ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала &lt;= &amp;КонецПериода
				И ДоговорНаВыполнениеРаботСФизЛицом.Проведен
			{ГДЕ
				ДоговорНаВыполнениеРаботСФизЛицом.ФизЛицо.*,
				ДоговорНаВыполнениеРаботСФизЛицом.Организация.*}) КАК Договора
			ПО (Договора.ДатаНачала &lt;= КОНЕЦПЕРИОДА(Периоды.ПериодРегистрации, МЕСЯЦ))
			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
			ПО (Договора.Физлицо = РаботникиОрганизаций.Сотрудник.Физлицо)
				И (ВЫБОР
					КОГДА Договора.Организация.ГоловнаяОрганизация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
						ТОГДА Договора.Организация
					ИНАЧЕ Договора.Организация.ГоловнаяОрганизация
				КОНЕЦ = РаботникиОрганизаций.Организация)
				И (КОНЕЦПЕРИОДА(Периоды.ПериодРегистрации, МЕСЯЦ) &gt;= РаботникиОрганизаций.Период)
	
	СГРУППИРОВАТЬ ПО
		Договора.Физлицо,
		Договора.Организация,
		Периоды.ПериодРегистрации) КАК ДатыПоследнихДоговоров
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
		ПО ДатыПоследнихДоговоров.Физлицо = ДоговорНаВыполнениеРаботСФизЛицом.ФизЛицо
			И ДатыПоследнихДоговоров.Организация = ДоговорНаВыполнениеРаботСФизЛицом.Организация
			И ДатыПоследнихДоговоров.ДатаНачала = ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала
			И (ДоговорНаВыполнениеРаботСФизЛицом.Проведен)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
		ПО ДатыПоследнихДоговоров.Физлицо = РаботникиОрганизаций.Сотрудник.Физлицо
			И ДатыПоследнихДоговоров.Период = РаботникиОрганизаций.Период
			И (ВЫБОР
				КОГДА ДатыПоследнихДоговоров.Организация.ГоловнаяОрганизация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
					ТОГДА ДатыПоследнихДоговоров.Организация
				ИНАЧЕ ДатыПоследнихДоговоров.Организация.ГоловнаяОрганизация
			КОНЕЦ = РаботникиОрганизаций.Организация)
ГДЕ
	ВЫБОР
			КОГДА РаботникиОрганизаций.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
					И РаботникиОрганизаций.Период &lt;= ДатыПоследнихДоговоров.ПериодРегистрации
				ТОГДА ИСТИНА
			КОГДА РаботникиОрганизаций.ПричинаИзмененияСостоянияЗавершения = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
					И РаботникиОрганизаций.ПериодЗавершения &lt;= ДатыПоследнихДоговоров.ПериодРегистрации
				ТОГДА ИСТИНА
			КОГДА РаботникиОрганизаций.ПричинаИзмененияСостоянияЗавершения ЕСТЬ NULL 
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ
{ГДЕ
	ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник.*,
	ДоговорНаВыполнениеРаботСФизЛицом.Организация.*,
	ДоговорНаВыполнениеРаботСФизЛицом.ФизЛицо.*,
	ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации.*}

СГРУППИРОВАТЬ ПО
	ДатыПоследнихДоговоров.Физлицо,
	ДатыПоследнихДоговоров.Организация,
	ДатыПоследнихДоговоров.ПериодРегистрации,
	ВЫБОР
		КОГДА ДоговорНаВыполнениеРаботСФизЛицом.Организация.ГоловнаяОрганизация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
			ТОГДА ДоговорНаВыполнениеРаботСФизЛицом.Организация
		ИНАЧЕ ДоговорНаВыполнениеРаботСФизЛицом.Организация.ГоловнаяОрганизация
	КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ПоследниеДаты.ПериодРегистрации КАК ПериодРегистрации,
	РаботникиОрганизаций.Сотрудник КАК Сотрудник,
	ВЫБОР
		КОГДА РаботникиОрганизаций.ПериодЗавершения &lt;= КОНЕЦПЕРИОДА(ПоследниеДаты.ПериодРегистрации, МЕСЯЦ)
				И РаботникиОрганизаций.ПериодЗавершения &lt;&gt; ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			ТОГДА РаботникиОрганизаций.ОбособленноеПодразделениеЗавершения
		ИНАЧЕ РаботникиОрганизаций.ОбособленноеПодразделение
	КОНЕЦ КАК Организация,
	РаботникиОрганизаций.Сотрудник.Физлицо КАК Физлицо,
	ВЫБОР
		КОГДА РаботникиОрганизаций.ПериодЗавершения &lt;= КОНЕЦПЕРИОДА(ПоследниеДаты.ПериодРегистрации, МЕСЯЦ)
				И РаботникиОрганизаций.ПериодЗавершения &lt;&gt; ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			ТОГДА РаботникиОрганизаций.ПодразделениеОрганизацииЗавершения
		ИНАЧЕ РаботникиОрганизаций.ПодразделениеОрганизации
	КОНЕЦ КАК ПодразделениеОрганизации,
	ВЫБОР
		КОГДА РаботникиОрганизаций.ПериодЗавершения &lt;= КОНЕЦПЕРИОДА(ПоследниеДаты.ПериодРегистрации, МЕСЯЦ)
				И РаботникиОрганизаций.ПериодЗавершения &lt;&gt; ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
			ТОГДА РаботникиОрганизаций.ДолжностьЗавершения
		ИНАЧЕ РаботникиОрганизаций.Должность
	КОНЕЦ КАК Должность,
	РаботникиОрганизаций.Организация КАК ГоловнаяОрганизация
ПОМЕСТИТЬ Сотрудники
ИЗ
	(ВЫБРАТЬ
		ДатыПоследнихДвижений.ПериодРегистрации КАК ПериодРегистрации,
		ДатыПоследнихДвижений.Период КАК Период,
		РаботникиОрганизаций.Сотрудник.Физлицо КАК Физлицо,
		РаботникиОрганизаций.Организация КАК Организация,
		ДатыПоследнихДвижений.ДатаНачала КАК ДатаНачала,
		КОЛИЧЕСТВО(РаботникиОрганизаций.Период) КАК КолВоДвижений
	ИЗ
		(ВЫБРАТЬ
			Периоды.ПериодРегистрации КАК ПериодРегистрации,
			МАКСИМУМ(РаботникиОрганизаций.Период) КАК Период,
			РаботникиОрганизаций.Сотрудник.Физлицо КАК Физлицо,
			РаботникиОрганизаций.Организация КАК Организация,
			МАКСИМУМ(Договора.ДатаНачала) КАК ДатаНачала
		ИЗ
			Периоды КАК Периоды
				ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
				ПО (РаботникиОрганизаций.Период &lt;= КОНЕЦПЕРИОДА(Периоды.ПериодРегистрации, МЕСЯЦ))
				ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
					ДоговорНаВыполнениеРаботСФизЛицом.ФизЛицо КАК Физлицо,
					ДоговорНаВыполнениеРаботСФизЛицом.Организация КАК Организация,
					ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала КАК ДатаНачала,
					ДоговорНаВыполнениеРаботСФизЛицом.ДатаОкончания КАК ДатаОкончания
				ИЗ
					Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
				ГДЕ
					ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала &lt;= &amp;КонецПериода
					И ДоговорНаВыполнениеРаботСФизЛицом.Проведен
				{ГДЕ
					ДоговорНаВыполнениеРаботСФизЛицом.ФизЛицо.*,
					ДоговорНаВыполнениеРаботСФизЛицом.Организация.*}) КАК Договора
				ПО (КОНЕЦПЕРИОДА(Периоды.ПериодРегистрации, МЕСЯЦ) &gt;= Договора.ДатаНачала)
					И (ВЫБОР
						КОГДА Договора.Организация.ГоловнаяОрганизация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
							ТОГДА Договора.Организация
						ИНАЧЕ Договора.Организация.ГоловнаяОрганизация
					КОНЕЦ = РаботникиОрганизаций.Организация)
					И (Договора.Физлицо = РаботникиОрганизаций.Сотрудник.Физлицо)
		ГДЕ
			РаботникиОрганизаций.Сотрудник.ВидЗанятости &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
		{ГДЕ
			РаботникиОрганизаций.Сотрудник.Физлицо.* КАК Физлицо}
		
		СГРУППИРОВАТЬ ПО
			Периоды.ПериодРегистрации,
			РаботникиОрганизаций.Сотрудник.Физлицо,
			РаботникиОрганизаций.Организация) КАК ДатыПоследнихДвижений
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
			ПО ДатыПоследнихДвижений.Организация = РаботникиОрганизаций.Организация
				И ДатыПоследнихДвижений.Физлицо = РаботникиОрганизаций.Сотрудник.Физлицо
				И ДатыПоследнихДвижений.Период = РаботникиОрганизаций.Период
	ГДЕ
		РаботникиОрганизаций.Сотрудник.ВидЗанятости &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
	{ГДЕ
		РаботникиОрганизаций.Сотрудник.Физлицо.* КАК Физлицо}
	
	СГРУППИРОВАТЬ ПО
		ДатыПоследнихДвижений.ПериодРегистрации,
		РаботникиОрганизаций.Сотрудник.Физлицо,
		РаботникиОрганизаций.Организация,
		ДатыПоследнихДвижений.ДатаНачала,
		ДатыПоследнихДвижений.Период) КАК ПоследниеДаты
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
		ПО ПоследниеДаты.Физлицо = РаботникиОрганизаций.Сотрудник.Физлицо
			И ПоследниеДаты.Организация = РаботникиОрганизаций.Организация
			И ПоследниеДаты.Период = РаботникиОрганизаций.Период
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
		ПО ПоследниеДаты.ДатаНачала = ДоговорНаВыполнениеРаботСФизЛицом.ДатаНачала
			И ПоследниеДаты.Физлицо = ДоговорНаВыполнениеРаботСФизЛицом.ФизЛицо
			И (ПоследниеДаты.Организация = ВЫБОР
				КОГДА ДоговорНаВыполнениеРаботСФизЛицом.Организация.ГоловнаяОрганизация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
					ТОГДА ДоговорНаВыполнениеРаботСФизЛицом.Организация
				ИНАЧЕ ДоговорНаВыполнениеРаботСФизЛицом.Организация.ГоловнаяОрганизация
			КОНЕЦ)
ГДЕ
	РаботникиОрганизаций.Сотрудник.ВидЗанятости &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
	И (ПоследниеДаты.КолВоДвижений = 2
				И РаботникиОрганизаций.ПричинаИзмененияСостояния &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
			ИЛИ ПоследниеДаты.КолВоДвижений = 1)
	И ВЫБОР
			КОГДА РаботникиОрганизаций.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
					И РаботникиОрганизаций.Период &lt;= ПоследниеДаты.ПериодРегистрации
					И (НЕ ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник ЕСТЬ NULL )
				ТОГДА ЛОЖЬ
			КОГДА РаботникиОрганизаций.ПричинаИзмененияСостоянияЗавершения = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
					И РаботникиОрганизаций.ПериодЗавершения &lt;= ПоследниеДаты.ПериодРегистрации
					И (НЕ ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник ЕСТЬ NULL )
				ТОГДА ЛОЖЬ
			ИНАЧЕ ИСТИНА
		КОНЕЦ

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	Договорники.ПериодРегистрации,
	МАКСИМУМ(ДоговорНаВыполнениеРаботСФизЛицом.Сотрудник),
	Договорники.Организация,
	Договорники.Физлицо,
	МАКСИМУМ(ДоговорНаВыполнениеРаботСФизЛицом.ПодразделениеОрганизации),
	Договорники.Должность,
	Договорники.ГоловнаяОрганизация
ИЗ
	Договорники КАК Договорники
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ДоговорНаВыполнениеРаботСФизЛицом КАК ДоговорНаВыполнениеРаботСФизЛицом
		ПО Договорники.Ссылка = ДоговорНаВыполнениеРаботСФизЛицом.Ссылка

СГРУППИРОВАТЬ ПО
	Договорники.ПериодРегистрации,
	Договорники.Организация,
	Договорники.Физлицо,
	Договорники.Должность,
	Договорники.ГоловнаяОрганизация

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	НеСотрудники.ПериодРегистрации,
	НеСотрудники.Сотрудник,
	НеСотрудники.Организация,
	НеСотрудники.ФизЛицо,
	НеСотрудники.ПодразделениеОрганизации,
	НеСотрудники.Должность,
	НеСотрудники.ГоловнаяОрганизация
ИЗ
	НеСотрудники КАК НеСотрудники
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Сотрудники.ПериодРегистрации КАК ПериодРегистрации,
	Сотрудники.Сотрудник КАК Сотрудник,
	Сотрудники.Организация КАК Организация,
	Сотрудники.Физлицо КАК Физлицо,
	Сотрудники.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
	Сотрудники.Должность КАК Должность,
	Сотрудники.ГоловнаяОрганизация КАК ГоловнаяОрганизация
{ВЫБРАТЬ
	ПериодРегистрации,
	Сотрудник.*,
	Организация.*,
	Физлицо.*,
	ПодразделениеОрганизации.*,
	Должность.*,
	ГоловнаяОрганизация.*}
ИЗ
	Сотрудники КАК Сотрудники
{ГДЕ
	Сотрудники.ПериодРегистрации,
	Сотрудники.Сотрудник.*,
	Сотрудники.Организация.*,
	Сотрудники.Физлицо.*,
	Сотрудники.ПодразделениеОрганизации.*,
	Сотрудники.Должность.*,
	Сотрудники.ГоловнаяОрганизация.*}
{ХАРАКТЕРИСТИКИ
	ТИП(Справочник.ДолжностиОрганизаций)
	СПИСОК (ВЫБРАТЬ
			СвойстваОбъектов.Ссылка,
			" Дополнительное свойство: " + СвойстваОбъектов.Наименование КАК Наименование,
			СвойстваОбъектов.ТипЗначения
		ИЗ
			ПланВидовХарактеристик.СвойстваОбъектов КАК СвойстваОбъектов
		ГДЕ
			СвойстваОбъектов.НазначениеСвойства = ЗНАЧЕНИЕ(ПланВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Справочник_ДолжностиОрганизаций)
			И (НЕ СвойстваОбъектов.ПометкаУдаления))
	ИДЕНТИФИКАТОР Ссылка
	ИМЯ Наименование
	ТИПЗНАЧЕНИЯ ТипЗначения
	ЗНАЧЕНИЯ РегистрСведений.ЗначенияСвойствОбъектов
	ОБЪЕКТ Объект
	ХАРАКТЕРИСТИКА Свойство
	ЗНАЧЕНИЕ Значение }
{ХАРАКТЕРИСТИКИ
	ТИП(Справочник.ДолжностиОрганизаций)
	СПИСОК (ВЫБРАТЬ
			КатегорииОбъектов.Ссылка,
			" Дополнительная категория: " + КатегорииОбъектов.Наименование КАК Наименование
		ИЗ
			Справочник.КатегорииОбъектов КАК КатегорииОбъектов
		ГДЕ
			КатегорииОбъектов.НазначениеКатегории = ЗНАЧЕНИЕ(ПланВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Справочник_ДолжностиОрганизаций)
			И (НЕ КатегорииОбъектов.ПометкаУдаления))
	ИДЕНТИФИКАТОР Ссылка
	ИМЯ Наименование
	ЗНАЧЕНИЯ РегистрСведений.КатегорииОбъектов
	ОБЪЕКТ Объект
	ХАРАКТЕРИСТИКА Категория }
{ХАРАКТЕРИСТИКИ
	ТИП(Справочник.ПодразделенияОрганизаций)
	СПИСОК (ВЫБРАТЬ
			СвойстваОбъектов.Ссылка,
			" Дополнительное свойство: " + СвойстваОбъектов.Наименование КАК Наименование,
			СвойстваОбъектов.ТипЗначения
		ИЗ
			ПланВидовХарактеристик.СвойстваОбъектов КАК СвойстваОбъектов
		ГДЕ
			СвойстваОбъектов.НазначениеСвойства = ЗНАЧЕНИЕ(ПланВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Справочник_ПодразделенияОрганизаций)
			И (НЕ СвойстваОбъектов.ПометкаУдаления))
	ИДЕНТИФИКАТОР Ссылка
	ИМЯ Наименование
	ТИПЗНАЧЕНИЯ ТипЗначения
	ЗНАЧЕНИЯ РегистрСведений.ЗначенияСвойствОбъектов
	ОБЪЕКТ Объект
	ХАРАКТЕРИСТИКА Свойство
	ЗНАЧЕНИЕ Значение }
{ХАРАКТЕРИСТИКИ
	ТИП(Справочник.СотрудникиОрганизаций)
	СПИСОК (ВЫБРАТЬ
			СвойстваОбъектов.Ссылка,
			" Дополнительное свойство: " + СвойстваОбъектов.Наименование КАК Наименование,
			СвойстваОбъектов.ТипЗначения
		ИЗ
			ПланВидовХарактеристик.СвойстваОбъектов КАК СвойстваОбъектов
		ГДЕ
			СвойстваОбъектов.НазначениеСвойства = ЗНАЧЕНИЕ(ПланВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Справочник_СотрудникиОрганизаций)
			И (НЕ СвойстваОбъектов.ПометкаУдаления))
	ИДЕНТИФИКАТОР Ссылка
	ИМЯ Наименование
	ТИПЗНАЧЕНИЯ ТипЗначения
	ЗНАЧЕНИЯ РегистрСведений.ЗначенияСвойствОбъектов
	ОБЪЕКТ Объект
	ХАРАКТЕРИСТИКА Свойство
	ЗНАЧЕНИЕ Значение }
{ХАРАКТЕРИСТИКИ
	ТИП(Справочник.ПодразделенияОрганизаций)
	СПИСОК (ВЫБРАТЬ
			КатегорииОбъектов.Ссылка,
			" Дополнительная категория: " + КатегорииОбъектов.Наименование КАК Наименование
		ИЗ
			Справочник.КатегорииОбъектов КАК КатегорииОбъектов
		ГДЕ
			КатегорииОбъектов.НазначениеКатегории = ЗНАЧЕНИЕ(ПланВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Справочник_ПодразделенияОрганизаций)
			И (НЕ КатегорииОбъектов.ПометкаУдаления))
	ИДЕНТИФИКАТОР Ссылка
	ИМЯ Наименование
	ЗНАЧЕНИЯ РегистрСведений.КатегорииОбъектов
	ОБЪЕКТ Объект
	ХАРАКТЕРИСТИКА Категория }
{ХАРАКТЕРИСТИКИ
	ТИП(Справочник.СотрудникиОрганизаций)
	СПИСОК (ВЫБРАТЬ
			КатегорииОбъектов.Ссылка,
			" Дополнительная категория: " + КатегорииОбъектов.Наименование КАК Наименование
		ИЗ
			Справочник.КатегорииОбъектов КАК КатегорииОбъектов
		ГДЕ
			КатегорииОбъектов.НазначениеКатегории = ЗНАЧЕНИЕ(ПланВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Справочник_СотрудникиОрганизаций)
			И (НЕ КатегорииОбъектов.ПометкаУдаления))
	ИДЕНТИФИКАТОР Ссылка
	ИМЯ Наименование
	ЗНАЧЕНИЯ РегистрСведений.КатегорииОбъектов
	ОБЪЕКТ Объект
	ХАРАКТЕРИСТИКА Категория }
{ХАРАКТЕРИСТИКИ
	ТИП(Справочник.ФизическиеЛица)
	СПИСОК (ВЫБРАТЬ
			СвойстваОбъектов.Ссылка,
			" Дополнительное свойство: " + СвойстваОбъектов.Наименование КАК Наименование,
			СвойстваОбъектов.ТипЗначения
		ИЗ
			ПланВидовХарактеристик.СвойстваОбъектов КАК СвойстваОбъектов
		ГДЕ
			СвойстваОбъектов.НазначениеСвойства = ЗНАЧЕНИЕ(ПланВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Справочник_ФизическиеЛица)
			И (НЕ СвойстваОбъектов.ПометкаУдаления))
	ИДЕНТИФИКАТОР Ссылка
	ИМЯ Наименование
	ТИПЗНАЧЕНИЯ ТипЗначения
	ЗНАЧЕНИЯ РегистрСведений.ЗначенияСвойствОбъектов
	ОБЪЕКТ Объект
	ХАРАКТЕРИСТИКА Свойство
	ЗНАЧЕНИЕ Значение }
{ХАРАКТЕРИСТИКИ
	ТИП(Справочник.ПодразделенияОрганизаций)
	СПИСОК (ВЫБРАТЬ
			"Ответственное лицо" КАК Идентификатор,
			"Ответственное лицо" КАК ИмяХарактеристики)
	ИДЕНТИФИКАТОР Идентификатор
	ИМЯ ИмяХарактеристики
	ЗНАЧЕНИЯ (ВЫБРАТЬ
			ОтветственныеЛицаСрезПоследних.СтруктурнаяЕдиница КАК Объект,
			"Ответственное лицо" КАК Идентификатор,
			ОтветственныеЛицаСрезПоследних.ФизическоеЛицо КАК Значение
		ИЗ
			РегистрСведений.ОтветственныеЛицаОрганизаций.СрезПоследних КАК ОтветственныеЛицаСрезПоследних
		ГДЕ
			ОтветственныеЛицаСрезПоследних.СтруктурнаяЕдиница ССЫЛКА Справочник.ПодразделенияОрганизаций
			И ОтветственныеЛицаСрезПоследних.ОтветственноеЛицо = ЗНАЧЕНИЕ(Перечисление.ОтветственныеЛицаОрганизаций.Руководитель))
	ОБЪЕКТ Объект
	ХАРАКТЕРИСТИКА Идентификатор
	ЗНАЧЕНИЕ Значение }</query>
	</dataSet>
	<parameter>
		<name>КонецПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Конец периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>Date</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>НачалоПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Начало периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>Date</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<settingsVariant>
		<dcsset:name>Основной</dcsset:name>
		<dcsset:presentation xsi:type="xs:string">Основной</dcsset:presentation>
		<dcsset:settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows"/>
	</settingsVariant>
</DataCompositionSchema>