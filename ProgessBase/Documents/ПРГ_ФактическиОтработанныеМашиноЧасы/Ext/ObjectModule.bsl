Процедура ОбработкаПроведения(Отказ, Режим)
	
	// сделаем проверку на 1 документ
	
	Запрос = Новый Запрос("ВЫБРАТЬ
	                      |	ПРГ_ФактическиОтработанныеМашиноЧасы.Ссылка
	                      |ИЗ
	                      |	Документ.ПРГ_ФактическиОтработанныеМашиноЧасы КАК ПРГ_ФактическиОтработанныеМашиноЧасы
	                      |ГДЕ
	                      |	ПРГ_ФактическиОтработанныеМашиноЧасы.Организация = &Организация
	                      |	И ПРГ_ФактическиОтработанныеМашиноЧасы.Ссылка <> &Ссылка
	                      |	И ПРГ_ФактическиОтработанныеМашиноЧасы.Проведен
	                      |	И ПРГ_ФактическиОтработанныеМашиноЧасы.Дата МЕЖДУ &Дата1 И &Дата2");
						  
	Запрос.УстановитьПараметр("Дата1",НачалоМесяца(Дата));
	Запрос.УстановитьПараметр("Дата2",КонецМесяца(Дата));
	Запрос.УстановитьПараметр("Ссылка",Ссылка);
	Запрос.УстановитьПараметр("Организация",Организация);
	
	Выборка = Запрос.Выполнить().Выбрать();
	Если Выборка.Следующий() Тогда
		ОбщегоНазначения.СообщитьОбОшибке("В одном месяце допускается ввод однового документа по воде",Отказ);
	КонеЦесли;	
	
	//проверим потреблено не может меньше всего
	Для Каждого Текстрока Из  МашиноЧасы Цикл
		Если Текстрока.МашиноЧасы = 0  Тогда
			 Сообщить("В строке не заполнена информация по машиночасам !!!");
			 //ОбщегоНазначения.СообщитьОбОшибке("В строке № "+Текстрока.НомерСтроки+" не заполнены машино часы !!!",Отказ);
	    КонецЕсли;		
	КонецЦикла;	
	
КонецПроцедуры

