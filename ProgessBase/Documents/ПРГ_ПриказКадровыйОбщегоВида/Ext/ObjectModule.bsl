
Процедура Печать() Экспорт
	//{{_КОНСТРУКТОР_ПЕЧАТИ_ЭЛЕМЕНТ(Печать)
	// Данный фрагмент построен конструктором.
	// При повторном использовании конструктора, внесенные вручную изменения будут утеряны!!!
	//Blik 230616 н
	Организация=Организация;
	СведенияООрганизации= УправлениеКонтактнойИнформацией.СведенияОЮрФизЛице(Организация,Дата); 
	Организация_Шапка = СокрЛП(Строка(СведенияООрганизации.НаименованиеСокращенное));
	ОрганизацияПолн_Шапка = СокрЛП(Строка(СведенияООрганизации.ПолноеНаименование));
	//Blik 230616 к

	ТабДок = Новый ТабличныйДокумент;
	Макет = Документы.ПРГ_ПриказКадровыйОбщегоВида.ПолучитьМакет("Печать");
	// Заголовок
	//Область = Макет.ПолучитьОбласть("Заголовок");
	//ТабДок.Вывести(Область);
	// Шапка
	Запрос = Новый Запрос;
	//Запрос.Текст =
	//"ВЫБРАТЬ разрешенные
	//|	ВЫРАЗИТЬ(НастройкиПользователей.Значение КАК СТРОКА(300)) КАК Город
	//|ИЗ
	//|	РегистрСведений.НастройкиПользователей КАК НастройкиПользователей
	//|ГДЕ
	//|	НастройкиПользователей.Пользователь = &Пользователь
	//|	И НастройкиПользователей.Настройка = ЗНАЧЕНИЕ(ПланВидовХарактеристик.НастройкиПользователей.AVT_Город)";
	//Запрос.УстановитьПараметр("Пользователь", Ответственный);
	//
	//Результат = Запрос.Выполнить();
	//Выборка = Результат.Выбрать();
	//Выборка.Следующий();
	//

	
	Шапка = Макет.ПолучитьОбласть("Шапка");

	Шапка.Параметры.Заполнить(ЭтотОбъект);
	Шапка.Параметры.Дата=Формат(ЭтотОбъект.Дата,"ДЛФ=ДД");
	Шапка.Параметры.номер=общегоНазначения.ПолучитьНомерНаПечать(ЭтотОбъект);
	Шапка.Параметры.город=УправлениеПользователями.ПолучитьЗначениеПоУмолчанию(глЗначениеПеременной("глТекущийПользователь"), "AVT_Город");
	//Blik 230616 н
	Шапка.Параметры.ОрганизацияПолн_Шапка = ОрганизацияПолн_Шапка;
	//Blik 230616 к

	ТабДок.Вывести(Шапка);
	// СтрокиДокумента
	Для Каждого ТекСтрокаСтрокиДокумента Из СтрокиДокумента Цикл
		Если (СокрЛП(ТекСтрокаСтрокиДокумента.ЗАГОЛОВОК)<>"") и (СокрЛП(ТекСтрокаСтрокиДокумента.ЗАГОЛОВОК<>Неопределено)) тогда
			ОбластьСтрокиДокумента = Макет.ПолучитьОбласть("СтрокиДокументаШапка");
			ОбластьСтрокиДокумента.Параметры.ЗАГОЛОВОКСТРОКИ=""+ТекСтрокаСтрокиДокумента.ЗАГОЛОВОК;
			
			ТабДок.Вывести(ОбластьСтрокиДокумента);
		КонецЕсли;
		ОбластьСтрокиДокумента = Макет.ПолучитьОбласть("СтрокиДокумента");
		
		ОбластьСтрокиДокумента.Параметры.СтрокаДокумента=""+ТекСтрокаСтрокиДокумента.НаименованиеСтроки+" "+ТекСтрокаСтрокиДокумента.ШаблонСтроки;
		ТабДок.Вывести(ОбластьСтрокиДокумента);
	КонецЦикла;
	// Сотрудники
	

	Запрос = Новый Запрос;
	Запрос.Текст =
	"ВЫБРАТЬ ПЕРВЫЕ 1
	|	ОтветственныеЛицаОрганизацийСрезПоследних.ФизическоеЛицо,
	|	ОтветственныеЛицаОрганизацийСрезПоследних.Должность
	|ИЗ
	|	РегистрСведений.ОтветственныеЛицаОрганизаций.СрезПоследних(&Дата, ) КАК ОтветственныеЛицаОрганизацийСрезПоследних
	|ГДЕ
	|	ОтветственныеЛицаОрганизацийСрезПоследних.ОтветственноеЛицо.Ссылка = &Руководитель";
	Запрос.УстановитьПараметр("Дата", Дата);
	Запрос.УстановитьПараметр("Руководитель", Перечисления.ОтветственныеЛицаОрганизаций.Руководитель);
	
	Выборка = Запрос.Выполнить().Выбрать();
	Выборка.Следующий(); 

	
    Если ВидДокумента.ВыводитьПодвал=Истина тогда
		Область = Макет.ПолучитьОбласть("Подвал"); 	
		область.Параметры.фиоРуководителя=Выборка.ФизическоеЛицо;
		область.Параметры.ДолжностьРуководителя=Выборка.Должность;
		//Blik 230616 н
		область.Параметры.Организация_Шапка = Организация_Шапка;
		//Blik 230616 к
		ТабДок.Вывести(Область);
	КонецЕсли;
	


	ТабДок.ОтображатьСетку = Ложь;
	ТабДок.Защита = Истина;
	ТабДок.ТолькоПросмотр = Истина;
	ТабДок.ОтображатьЗаголовки = Истина;
	ТабДок.Показать();
	//}}_КОНСТРУКТОР_ПЕЧАТИ_ЭЛЕМЕНТ
КонецПроцедуры

